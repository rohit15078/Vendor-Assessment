
// Copyright 2018 Morningstar Inc. All rights reserved.
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
//   http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

{
  "version": 2,
  "namespace": "[ORGANIZATION_NAME]",
  "questionnaire": [
    {
      "type": "block",
      "text": "[QUESTIONNAIRE_TITLE_AND_VERSION]",
      "items": [
        {
          "type": "block",
          "text": "Introduction",
          "id": "block_introduction",
          "items": [
            {
              "type": "info",
              "id": "intro_1",
              "text": "This questionnaire facilitates the identification of security requirements for a JUBILANT information technology project, application or system.  The questionnaire is intended for those JUBILANT projects, applications and systems that involve Non-Public Information or that acquire/use vendor IT services (e.g., application software development/hosting, hardware/software infrastructure, data storage facilities, staffing, etc.) You may use the \"Save\" button to save answers before submission. You can find previously saved questionnaires by pressing the \"GoASQ TOC\" button. When completed, please click the \"Submit\" button. This will trigger an email to the Information Security Team to start review and the person submitting the questionnaire should also be cc:ed on this email. You should receive a response within a few days. Please send an email to Information Security Office (information.security@jubl.com) if you need help, have any quesetions or if you do not receive a timely response."
            },
            {
              "type": "info",
              "id": "intro_2",
              "text": "Note that the \"Export\" button <b>does not work</b> with the IE (Internet Explorer) browser, so please use a modern browser like Chrome, Firefox or Edge."
            },
            {
              "type": "info",
              "id": "intro_5",
              "text": "Note that each section of the questionnaire has an associated number.  Some sections of the questionnaire only display based on answers provided, so it is common for completed questionnaires to skip some sections or subsections.  Comments about questions will typically reference these section numbers. Fields with a red border are mandatory application metadata that you must fill out."
            }
          ]
        },
        {
          "type": "block",
          "text": "Scenario",
          "id": "block_scenario",
          "items": [
            {
              "type": "info",
              "id": "infoSec_questionnaire_intro",
              "text": "Identifying information security requirements in the earliest planning stages of a technology project is important to reduce the risk of introducing new security issues into the environment.  Involving Jubilant Information Security early on also minimizes potential project schedule delays when security requirements are retrofitted into systems. \n Below are the scenarios where one must involve information security office."
            },
            {
                "type": "radiogroup",
                "text": "Select on scenario from below list",
                "id": "infoSec_questionnaire_scenarios",
                "choices": [
                    {"scenario_new_application": "New Application Development/Implementation"},
                    {"scenario_datacenter": "New Datacenter Physical/Cloud"},
                    {"scenario_infrastructure": "Infrastructure Modification"},
                    {"scenario_webapp": "On boarding Web Application"}
                ]
            },
            {
              "type": "info",
              "id": "infoSec_questionnaire_post_script",
              "text": "Kindly note that this is not the exhaustive list, one must involve Information Security team if any changes/new initiative in anyway impacts any of CIA (confidentiality, Integrity & Availability)."
            },  
            ] 
            }
        {
          "type": "block",
          "id": "block_application",
          "text": "New Application Development/Implementation",
          "cond": "scenario_new_application",
          //Break 1
          "items": [
            { 
              "type": "block",
              "text": "1: Application Metadata",
              "id": "block_app_metadata",
              "items": [
                {
                  "type": "line",
                  "text": "Application name:",
                  "id": "app_name",
                  "required": true,
                  "maxlength": "[MAXLENGTH_LINE_ITEM]"
                },
                {
                  "type": "line",
                  "text": "Name of person filling this questionnaire:",
                  "id": "app_champion",
                  "required": true,
                  "maxlength": "[MAXLENGTH_LINE_ITEM]"
                },
                {
                  "type": "radiogroup",
                  "text": "Is the person filling out this questionnaire the Project Leader?",
                  "id": "app_questionnaire_security_champion",
                  "choices": [
                    {"app_questionnaire_security_champion_yes": "Yes"},
                    {"app_questionnaire_security_champion_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Please ensure that the Project Leader is involved with the process. Your Project Leader should be cc:ed when you submit the questionnaire.",
                  "name": "Security Champion Tip",
                  "id": "warn_app_questionnaire_security_champion",
                  "cond": "app_questionnaire_security_champion_no"
                },
                {
                  "type": "line",
                  "text": "Name of Project Leader:",
                  "id": "app_author",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_questionnaire_security_champion_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Confirm the person filling out the form and the Project Leader have read and understand the Organization security policy.",
                  "id": "app_champion_confirm",
                  "choices": [
                    {"app_champion_confirmed": "Confirmed"},
                    {"app_champion_not_confirmed": "Not Confirmed"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Please work to make sure that the development and testing teams are familiarized with relevant security resources highlighted in this questionnaire.",
                  "name": "Security Champion",
                  "id": "warn_app_champion_confirmed",
                  "cond": "app_champion_confirmed"
                },
                {
                  "type": "tip",
                  "text": "It is a requirement that all project teams and team leaders are familiar with security expectations. Work with the InfoSec team to help determine and understand the organization security policy.",
                  "warn": "yes",
                  "why": "Please explain what is preventing from being familiar with such security expectations:",
                  "name": "Security Champion",
                  "severity": "high",
                  "id": "warn_app_champion_not_confirmed",
                  "cond": "app_champion_not_confirmed"
                },
                {
                  "type": "line",
                  "text": "Project team contact email address:",
                  "required": true,
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_team_email"
                },
                {
                  "type": "radiogroup",
                  "text": "Does this project have SOC2 compliance requirements?",
                  "id": "app_soc",
                  "choices": [
                    {"app_soc_yes": "Yes"},
                    {"app_soc_no": "No"}
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "2: Application Summary",
              "id": "block_app_summary",
              "items": [
                {
                  "type": "checkgroup",
                  "text": "Where is this application deployed?",
                  "defaultChoice": false,
                  "choices": [
                    {"app_deploy_aws": "<a href=\"https://aws.amazon.com\">AWS (Amazon Web Services)</a>"},
                    {"app_deploy_onpremises": "On Premises"},
                    {"app_deploy_other": "Other"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Additional deployments:",
                  "cond": "app_deploy_other",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_deploy_other_detail"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>AWS</b> security concerns.  Please review <a href=\"https://aws.amazon.com/security/security-resources/\">Amazon Security Resources</a> and other [ORGANIZATION_AWS_RESOURCES_HREF].  Work with developers on the project team to ensure such standards are understood and followed.",
                  "name": "AWS Coding Standards",
                  "cond": "app_deploy_aws",
                  "id": "warn_app_deploy"
                },
                {
                  "type": "checkgroup",
                  "text": "Describe the application type:",
                  "defaultChoice": false,
                  "choices": [
                    {"app_project_type_WebApp": "Web application (this is accessed through a web browser)"},
                    {"app_project_type_WebServices": "Web services (this is a SOAP or REST web services application)"},
                    {"app_project_type_server_generic": "Server side of a generic client-server application (a server side app, where the client is not a web browser)"},
                    {"app_project_type_mobile_app": "Mobile (phone/tablet) application (a mobile application that relies on a remote server/services for its operations)"},
                    {"app_project_type_standalone": "Stand-alone project (a stand-alone client or desktop application)"},
                    {"app_project_type_not_defined": "None of the above"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Please describe the application type:",
                  "cond": "app_project_type_not_defined",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_project_type_not_defined_details"
                },
                {
                  "type": "checkgroup",
                  "text": "Describe this project:",
                  "defaultChoice": false,
                  "choices": [
                    {"app_project_new": "This is a new project."},
                    {"app_project_significant_change": "This is an existing project that is introducing significant change."},
                    {"app_project_security_change": "This is an existing project that is adding or changing security features or where the [ORGANIZATION_SECURITY_LANDSCAPE_REFERENCE_HREF].  Note that a project moving to a public cloud (e.g. AWS) would be considered a significant change in the security landscape."}
                  ]
                },
                {
                  "type": "box",
                  "text": "Briefly describe the significant changes.",
                  "cond": "app_project_significant_change",
                  "id": "app_project_significant_change_detail",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]"
                },
                {
                  "type": "box",
                  "text": "Please describe what security features changed and how the security landscape has changed.",
                  "cond": "app_project_security_change",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "id": "app_project_security_change_detail"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project use <a href=\"https://en.wikipedia.org/wiki/Network_interface\">Network interfaces</a>?  For example, does it use an internet protocol like HTTPS, provide an API, or access files across a network?",
                  "id": "app_network_interfaces",
                  "choices": [
                    {"app_network_interfaces_yes": "Yes"},
                    {"app_network_interfaces_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>internet interface</b> security concerns.  Please review the <a href=\"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project\">OWASP Top 10</a> and the <a href=\"https://wiki.mozilla.org/WebAppSec/Secure_Coding_Guidelines\">Mozilla WebAppSec Secure Coding Guidelines</a> and the <a href=\"https://google.github.io/styleguide/htmlcssguide.html\">Google HTML/CSS Style Guide</a>.  Work with developers on the project team developing network interfaces to ensure such standards are understood and followed.",
                  "name": "Web Coding Standards",
                  "cond": "app_network_interfaces_yes",
                  "id": "warn_app_coding_standards_web"
                },
                {
                  "type": "box",
                  "text": "Please describe how network interfaces are used and provide some description of data flow:",
                  "cond": "app_network_interfaces_yes",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "id": "app_network_interfaces_detail"
                },
                {
                  "type": "radiogroup",
                  "text": "Is the project <a href=\"https://www.owasp.org/index.php/Attack_Surface_Analysis_Cheat_Sheet\">internet-facing</a> (e.g. on the public internet)?",
                  "id": "app_internet_facing",
                  "cond": "app_network_interfaces_yes",
                  "choices": [
                    {"app_internet_facing_yes": "Yes"},
                    {"app_internet_facing_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does this project have any [PROJECT_UNRESOLVED_BUGS_HREF]</a>?",
                  "id": "app_high_or_critical_issues",
                  "choices": [
                    {"app_high_or_critical_issues_yes": "Yes"},
                    {"app_high_or_critical_issues_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "It is particularly an important requirement that projects must have no critical or high severity issues when applications are on an internet-facing network.",
                  "warn": "yes",
                  "name": "No high or critical issues in an internet-facing application",
                  "severity": "high",
                  "id": "warn_app_issues_and_internet_facing",
                  "cond": "app_high_or_critical_issues_yes && app_internet_facing_yes"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project provide content that is intended to be viewed directly in a web browser.  For example, does your project control HTML/CSS content, headers, cookies, or client-side browser code like Javascript?",
                  "id": "app_web_browser",
                  "cond": "app_network_interfaces_yes",
                  "choices": [
                    {"app_web_browser_yes": "Yes"},
                    {"app_web_browser_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project provide any API interfaces?",
                  "cond": "app_network_interfaces_yes",
                  "id": "app_api",
                  "choices": [
                    {"app_api_yes": "Yes"},
                    {"app_api_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Are any API interfaces public or internet-facing?",
                  "cond": "app_api_yes && app_internet_facing_yes",
                  "id": "app_public_api",
                  "choices": [
                    {"app_public_api_yes": "Yes"},
                    {"app_public_api_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Do the project's API's follow <a href=\"https://en.wikipedia.org/wiki/Representational_state_transfer\">REST</a> principles?",
                  "cond": "app_api_yes",
                  "id": "app_rest_api",
                  "choices": [
                    {"app_rest_api_yes": "Yes"},
                    {"app_rest_api_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>REST</b> security concerns.  Please review the <a href=\"https://www.owasp.org/index.php/REST_Security_Cheat_Sheet\">OWASP Rest Security Cheat Sheet</a>.  Work with developers on the project team to ensure such standards are understood and followed.",
                  "name": "REST Coding Standards",
                  "cond": "app_rest_api_yes",
                  "id": "warn_app_rest_api"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project make use of disk storage?",
                  "id": "app_disk",
                  "choices": [
                    {"app_disk_yes": "Yes"},
                    {"app_disk_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project make use of a database?",
                  "id": "app_db",
                  "choices": [
                    {"app_db_yes": "Yes"},
                    {"app_db_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>database</b> security concerns.  Please review <a href=\"https://en.wikipedia.org/wiki/Database_security\">Wikipedia Database Security</a>.  Work with developers on the project team to ensure such standards are understood and followed.",
                  "name": "Database Security concerns",
                  "cond": "app_db_yes",
                  "id": "warn_db"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project require a new user to register?",
                  "id": "app_auth_reg",
                  "cond": "!app_project_type_standalone",
                  "choices": [
                    {"app_auth_reg_yes": "Yes"},
                    {"app_auth_reg_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project use authentication or authorization?",
                  "id": "app_auth",
                  "choices": [
                    {"app_auth_yes": "Yes"},
                    {"app_auth_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project interact with files that are uploaded to [ORGANIZATION_NAME] from external sources or support a file upload feature?",
                  "id": "app_upload",
                  "choices": [
                    {"app_upload_yes": "Yes"},
                    {"app_upload_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project distribute (or provide interfaces for distributing) media or other service files (either static or dynamically generated)?  For example, Office documents, Adobe documets, video, audio, or other kinds of media or service files?",
                  "id": "app_media",
                  "choices": [
                    {"app_media_yes": "Yes"},
                    {"app_media_no": "No"}
                  ]
                },
                {
                  "type": "box",
                  "text": "Describe the type(s) of kinds of media the project distributes or provides access to.  Is the media static or dynamic?",
                  "cond": "app_media_yes",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "id": "app_media_detail"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project allow sending an email by an API or web interface?",
                  "id": "app_support_email",
                  "choices": [
                    {"app_support_email_yes": "Yes"},
                    {"app_support_email_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project use CAPTCHA for validation before allowing to send any email?",
                  "id": "app_support_email_captcha",
                  "cond": "app_support_email_yes",
                  "choices": [
                    {"app_support_email_captcha_yes": "Yes"},
                    {"app_support_email_captcha_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>SPAM</b> security concerns. The project is expected to have proper validation in place before emails are sent to [ORGANIZATION_NAME]. We recommend using <a href=\"https://www.google.com/recaptcha/intro/\">Google reCAPTCHA</a>.",
                  "warn": "yes",
                  "name": "Application support feedback/email",
                  "cond": "app_support_email_captcha_no",
                  "id": "warn_app_support_email",
                  "why": "Please explain your plans to address this:",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project contain code?",
                  "id": "app_code",
                  "choices": [
                    {"app_code_yes": "Yes"},
                    {"app_code_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Is a front-end framework used?",
                  "id": "app_fw",
                  "cond": "app_code_yes",
                  "choices": [
                    {"app_fw_yes": "Yes"},
                    {"app_fw_no": "No"}
                  ]
                },
                {
                  "type": "checkgroup",
                  "text": "What front-end framework(s) are used?",
                  "defaultChoice": false,
                  "cond": "app_fw_yes",
                  "choices": [
                    {"app_fw_javascript": "Pure JavaScript"},
                    {"app_fw_angularjs": "AngularJS"},
                    {"app_fw_backbonejs": "BackboneJS"},
                    {"app_fw_dojo": "Dojo"},
                    {"app_fw_emberjs": "EmberJS"},
                    {"app_fw_jquery": "jQuery"},
                    {"app_fw_knockoutjs": "KnockoutJS"},
                    {"app_fw_reactjs": "ReactJS"},
                    {"app_fw_vuejs": "VueJS"},
                    {"app_fw_other": "Other"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Additional front-end frameworks used:",
                  "cond": "app_fw_other",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_fw_other_detail"
                },
                {
                  "type": "checkgroup",
                  "text": "What languages are used?",
                  "defaultChoice": false,
                  "cond": "app_code_yes",
                  "choices": [
                    {"app_lang_c": "C"},
                    {"app_lang_c_plus_plus": "C++"},
                    {"app_lang_javascript": "JavaScript/NodeJS"},
                    {"app_lang_java": "Java"},
                    {"app_lang_net": ".NET"},
                    {"app_lang_perl": "Perl"},
                    {"app_lang_php": "PHP"},
                    {"app_lang_python": "Python"},
                    {"app_lang_ruby": "Ruby"},
                    {"app_lang_sql": "SQL"},
                    {"app_lang_other": "Other"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Additional languages used:",
                  "cond": "app_lang_other",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_lang_other_detail"
                },
                {
                  "type": "tip",
                  "text": "Work with developers on the project team to ensure the standards mentioned in the following Tips are understood and followed:",
                  "name": "Coding Standards",
                  "cond": "app_fw_javascript || app_fw_angularjs || app_fw_dojo || app_fw_emberjs || app_fw_jquery || app_fw_knockoutjs || app_fw_reactjs || app_fw_vuejs || app_lang_c || app_lang_c_plus_plus || app_lang_java || app_lang_javascript || app_lang_net || app_lang_perl || app_lang_php || app_lang_python || app_lang_ruby",
                  "id": "warn_app_coding_standards_preface"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>AngularJS</b> coding concerns.  Please review the <a href=\"https://docs.angularjs.org/guide\">AngularJS Developer Guide</a>, the <a href=\"https://docs.angularjs.org/guide/security\">Angular Security Guide</a> and the <a href=\"https://google.github.io/styleguide/angularjs-google-style.html\">Google AngularJS Style Guide</a>.  Note the Developer Guide has a Security section.",
                  "name": "AngularJS Coding Standards",
                  "cond": "app_fw_angularjs",
                  "id": "warn_app_coding_standards_angularjs"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>BackboneJS</b> coding concerns.  Please review the <a href=\"https://github.com/jashkenas/backbone/wiki/Backbone,-The-Primer\">Backbone Documentation</a>.",
                  "name": "BackboneJS Coding Standards",
                  "cond": "app_fw_backbonejs",
                  "id": "warn_app_coding_standards_backbonejs"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>Dojo</b> coding concerns.  Please review the <a href=\"https://dojotoolkit.org/documentation/\">Dojo Documentation</a>.",
                  "name": "Dojo Coding Standards",
                  "cond": "app_fw_dojo",
                  "id": "warn_app_coding_standards_dojo"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>EmberJS</b> coding concerns.  Please review the <a href=\"https://emberjs.com/learn/\">EmberJS Documentation</a>.",
                  "name": "EmberJS Coding Standards",
                  "cond": "app_fw_emberjs",
                  "id": "warn_app_coding_standards_emberjs"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>jQuery</b> coding concerns.  Please review the <a href=\"http://learn.jquery.com/\">JQuery Documentation</a> and the <a href=\"https://www.virtuesecurity.com/blog/jquery-security-model/\">The jQuery Security Model Explained</a>.",
                  "name": "jQuery Coding Standards",
                  "cond": "app_fw_jquery",
                  "id": "warn_app_coding_standards_jquery"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>KnockoutJS</b> coding concerns.  Please review the <a href=\"http://knockoutjs.com/documentation/introduction.html\">KnockoutJS Documentation</a>.",
                  "name": "KnockoutJS Coding Standards",
                  "cond": "app_fw_knockoutjs",
                  "id": "warn_app_coding_standards_knockoutjs"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>ReactJS</b> coding concerns.  Please review the <a href=\"https://facebook.github.io/react/docs/hello-world.html\">ReactJS Documentation</a>.",
                  "name": "ReactJS Coding Standards",
                  "cond": "app_fw_reactjs",
                  "id": "warn_app_coding_standards_reactjs"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>VueJS</b> coding concerns.  Please review the <a href=\"https://vuejs.org/v2/guide/\">Vue.js Guide</a>.",
                  "name": "VueJS Coding Standards",
                  "cond": "app_fw_vuejs",
                  "id": "warn_app_coding_standards_vuejs"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>C</b> coding concerns.  Please review the <a href=\"https://www.securecoding.cert.org/confluence/display/seccode/SEI+CERT+Coding+Standards\">CERT Secure Coding Standards for C</a> and the <a href=\"http://cwe.mitre.org/data\">Mitre Common Weakness Enumeration</a>.",
                  "name": "C Coding Standards",
                  "cond": "app_lang_c",
                  "id": "warn_app_coding_standards_c"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>C++</b> coding concerns.  Please review the <a href=\"https://www.securecoding.cert.org/confluence/display/seccode/SEI+CERT+Coding+Standards\">CERT Secure Coding Standards for C++</a>, the <a href=\"http://cwe.mitre.org/data\">Mitre Common Weakness Enumeration</a> and the <a href=\"https://google.github.io/styleguide/cppguide.html\">Google C++ Style Guide</a>.",
                  "name": "C++ Coding Standards",
                  "cond": "app_lang_c_plus_plus",
                  "id": "warn_app_coding_standards_c_plus_plus"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>JavaScript</b> coding concerns.  Please review the <a href=\"https://www.w3.org/wiki/JavaScript_best_practices\">W3C JavaScript Best Practices</a> and the <a href=\"https://google.github.io/styleguide/jsguide.html\">Google JavaScript Style Guide</a>.",
                  "name": "JavaScript Coding Standards",
                  "cond": "app_fw_javascript || app_fw_angularjs || app_fw_reactjs || app_fw_vuejs || app_fw_backbonejs || app_fw_jquery || app_fw_emberjs || app_fw_knockoutjs || app_lang_javascript",
                  "id": "warn_app_coding_standards_javascript"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>Java</b> coding concerns.  Please review the <a href=\"http://www.oracle.com/technetwork/java/seccodeguide-139067.html\">Java SE Secure Coding Guidelines</a>, the <a href=\"https://www.securecoding.cert.org/confluence/display/seccode/SEI+CERT+Coding+Standards\">CERT Secure Coding Standards for Java</a>, the <a href=\"http://cwe.mitre.org/data\">Mitre Common Weakness Enumeration</a>, the <a href=\"https://www.owasp.org/index.php/Category:Java\">OWASP Java Project</a> and the <a href=\"https://google.github.io/styleguide/javaguide.html\">Google Java Style Guide</a>.",
                  "name": "Java Coding Standards",
                  "cond": "app_lang_java",
                  "id": "warn_app_coding_standards_java"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>.Net</b> coding concerns.  Please review the <a href=\"https://msdn.microsoft.com/en-us/library/d55zzx87(v=vs.90).aspx\">MSDN Secure Coding Guidelines</a>, the <a href=\"https://www.owasp.org/index.php/Category:OWASP_.NET_Project\">OWASP .NET Project</a> and the <a href=\"https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet\">OWASP .NET Security Cheat Sheet</a>.",
                  "name": ".NET Coding Standards",
                  "cond": "app_lang_net",
                  "id": "warn_app_coding_standards_net"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>Perl</b> coding concerns.  Please review the information at <a href=\"http://perldoc.perl.org/perlsec.html\">PerlSec</a> and the <a href=\"https://www.securecoding.cert.org/confluence/display/seccode/SEI+CERT+Coding+Standards\">CERT Secure Coding Standards for Perl</a>.",
                  "name": "Perl Coding Standards",
                  "cond": "app_lang_perl",
                  "id": "warn_app_coding_standards_perl"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>PHP</b> coding concerns.  Please review the information at <a href=\"http://phpsec.org/projects/guide/\">PHP Security Guide</a>, the <a href=\"https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet\">OWASP PHP Cheat Sheet</a> and the <a href=\"http://cwe.mitre.org/data\">Mitre Common Weakness Enumeration</a>.",
                  "name": "PHP Coding Standards",
                  "cond": "app_lang_php",
                  "id": "warn_app_coding_standards_php"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>Python</b> coding concerns.  Please review the information at <a href=\"http://www.pythonsecurity.org/\">OWASP Python Security Project</a>, <a href=\"https://www.python.org/dev/peps/pep-0008/\">PEP8 Style Guide</a> and the <a href=\"https://google.github.io/styleguide/pyguide.html\">Google Python Style Guide</a>.",
                  "name": "Python Coding Standards",
                  "cond": "app_lang_python",
                  "id": "warn_app_coding_standards_python"
                },
                {
                  "type": "tip",
                  "text": "Be familiar with <b>Ruby</b> coding concerns.  Please review the <a href=\"http://guides.rubyonrails.org/security.html\">Ruby On Rails Security Guide</a>, the <a href=\"http://guides.rubygems.org/security/\">RubyGems Security Practices</a> and the <a href=\"https://www.owasp.org/index.php/Ruby_on_Rails_Cheatsheet\">OWASP Ruby on Rails Cheatsheet</a>.",
                  "name": "Ruby Coding Standards",
                  "cond": "app_lang_ruby",
                  "id": "warn_app_coding_standards_ruby"
                },
                {
                  "type": "box",
                  "text": "<b>Overview Description</b>: provide a few sentences giving an overview description of the project.  Highlight significant subcomponents and interactions with other projects.  Describe any particular security considerations in this project's design.  Include links to any supporting design, architecture and security documentation that exists for this project.",
                  "required": true,
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "id": "app_documentation"
                }
              ]
            },
            {
              "type": "block",
              "text": "3: Testing and Scanning",
              "cond": "app_code_yes || app_api_yes",
              "id": "block_scanning",
              "items": [
                {
                  "type": "radiogroup",
                  "text": "Have the project's code repositories been registered with the AppSec team to perform <a href=\"https://www.owasp.org/index.php/Static_Code_Analysis\">static code analysis</a>?",
                  "id": "app_static_code",
                  "cond": "app_code_yes",
                  "choices": [
                    {"app_static_code_yes": "Yes"},
                    {"app_static_code_no": "No"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Please share the repository URL:",
                  "cond": "app_static_code_yes",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_static_code_repo_url"
                },
                {
                  "type": "tip",
                  "text": "Please send an email to [ORGANIZATION_APPSEC_EMAIL_HREF] with a pointer to your Bitbucket or other source code repository for static analysis.  Your project must get separate confirmation that there are no critical security issues before this project can go to production.",
                  "warn": "yes",
                  "name": "Static code analysis",
                  "why": "Please explain your plans to address this:",
                  "severity": "high",
                  "id": "warn_app_static_code",
                  "cond": "app_static_code_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Have the project's web interfaces been registered with the AppSec team to perform <a href=\"https://en.wikipedia.org/wiki/Penetration_test\">pen-testing</a>?",
                  "id": "app_pen_test",
                  "cond": "app_internet_facing_yes && (app_project_type_WebApp || app_project_type_mobile_app)",
                  "choices": [
                    {"app_pen_test_yes": "Yes"},
                    {"app_pen_test_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Please send an email to [ORGANIZATION_APPSEC_EMAIL_HREF] with a pointer to your website in the QA environment.  Your project must get separate confirmation that there are no critical security issues before this project can go to production.",
                  "warn": "yes",
                  "name": "Dynamic code analysis",
                  "why": "Please explain your plans to address this:",
                  "severity": "high",
                  "id": "warn_app_pen_test",
                  "cond": "app_pen_test_no"
                },
                {
                  "type": "info",
                  "text": "Note: since this project has an API that is not facing the public internet, dynamic testing of REST interfaces is optional.",
                  "cond": "app_public_api_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Have the project's REST (or other public-facing interfaces) been registered with the AppSec team to perform dynamic code analysis (e.g. <a href=\"https://en.wikipedia.org/wiki/Penetration_test\">pen-testing</a>)?",
                  "id": "app_dynamic_code",
                  "cond": "app_api_yes",
                  "choices": [
                    {"app_dynamic_code_yes": "Yes"},
                    {"app_dynamic_code_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Please send an email to [ORGANIZATION_APPSEC_EMAIL_HREF] with a pointer to your REST or other public-facing interfaces for dynamic analysis.  Your project must get separate confirmation that there are no critical security issues before this project can go to production",
                  "warn": "yes",
                  "name": "Dynamic code analysis",
                  "why": "Please explain your plans to address this:",
                  "severity": "high",
                  "id": "warn_app_dynamic_code",
                  "cond": "app_dynamic_code_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the project team follow a process that ensures third-party manual ethical hack assessments are done at least once a year?",
                  "id": "app_manual",
                  "cond": "app_internet_facing_yes && (app_project_type_WebApp || app_project_type_mobile_app)",
                  "choices": [
                    {"app_manual_yes": "Yes"},
                    {"app_manual_no": "No"}
                  ]
                },
                {
                  "type": "line",
                  "text": "What was the date of your last ethical hack assessment?",
                  "cond": "app_manual_yes",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_manual_date"
                },
                {
                  "type": "box",
                  "text": "Explain any issues that were identified during the assessment and whether they were resolved.",
                  "cond": "app_manual_yes",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "id": "app_manual_details"
                },
                {
                  "type": "tip",
                  "text": "It is a requirement that manual ethical hack assessments must be conducted on internet-facing applications by an approved internal or external third party once per year.  Please send an email to [ORGANIZATION_APPSEC_EMAIL_HREF] with a pointer to your REST or other public-facing interfaces for a manual ethical hack assessment.",
                  "warn": "yes",
                  "name": "Ethical Hack",
                  "why": "Please explain your plans to address this:",
                  "severity": "high",
                  "id": "warn_app_manual",
                  "cond": "app_manual_no"
                }
              ]
            },
            {
              "type": "block",
              "text": "4: Information Classification and Encryption",
              "id": "block_info_classification",
              "items": [
                {
                  "type": "block",
                  "text": "4.1: Restricted Information",
                  "id": "block_info_restricted",
                  "items": [
                    {
                      "type": "info",
                      "text": "<p><b>Restricted Information</b> is information that is intended only for internal use by individuals with a defined need-to-know and must never be distributed externally.  This includes:</p><p><b>Business:</b></p><ul><li>Financial results</li><li>Merger and acquisition information</li><li>Security and/or fraud investigation information</li><li>Information on legal or regulatory proceedings</li></ul><p><b>Sensitive PII:</b></p><ul><li>Racial or ethnic origin</li><li>Political opinions</li><li>Religious or other similar beliefs</li><li>Membership of trade unions</li><li>Physical or mental health condition or characteristic</li><li>Sexual life</li><li>Convictions, proceedings and criminal acts</li><li>Country identification number (e.g. Social Security numbers)</li><li>State identification (e.g. driver's license numbers)</li><li>Passport information</li><li>Healthcare related information</li><li>Medical insurance information</li><li>Student information</li><li>Student information</li><li>Credit and debit card numbers (including any PINs)</li><li>Bank account numbers (including any PINs)</li></ul><p><b>Information Technology:</b></p><ul><li>Encryption keys, passwords and/or PINs</li><li>Administrative/privileged account passwords</li><li>Answers to Account or Password Reset challenge questions</li></ul>"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the information processed by this project include Restricted Information?",
                      "choices": [
                        {"app_info_restricted_yes": "Yes"},
                        {"app_info_restricted_no": "No"}
                      ],
                      "id": "app_info_restricted"
                    },
                    {
                      "type": "box",
                      "text": "Explain what Restricted Information is associated with this project:",
                      "cond": "app_info_restricted_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_restricted_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted information stored digitally?",
                      "cond": "app_info_restricted_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_restricted_stored_yes": "Yes"},
                        {"app_info_restricted_stored_no": "No"}
                      ],
                      "id": "app_info_restricted_stored"
                    },
                    {
                      "type": "box",
                      "text": "Explain how the data is encrypted at rest and how encryption keys are protected for securing Restricted data when it is stored at rest:",
                      "cond": "app_info_restricted_stored_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_restricted_stored_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted information encrypted using an approved algorithm when stored at rest?",
                      "cond": "app_info_restricted_stored_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_restricted_encrypted_yes": "Yes"},
                        {"app_info_restricted_encrypted_no": "No"}
                      ],
                      "id": "app_info_restricted_encrypted"
                    },
                    {
                      "type": "tip",
                      "text": "Restricted Information must be encrypted when it is stored digitally.",
                      "warn": "yes",
                      "why": "Explain why Restricted information is not being encrypted:",
                      "name": "Restricted Information Encryption Requirement",
                      "severity": "high",
                      "cond": "app_info_restricted_encrypted_no",
                      "id": "warn_app_info_restricted_encrypted"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does Restricted information include passwords?",
                      "cond": "app_info_restricted_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_passwords_yes": "Yes"},
                        {"app_info_passwords_no": "No"}
                      ],
                      "id": "app_info_passwords"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are password hashes stored using bCrypt or sCrypt?",
                      "cond": "app_info_passwords_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_passwords_crypt_yes": "Yes"},
                        {"app_info_passwords_crypt_no": "No"}
                      ],
                      "id": "app_info_passwords_crypt"
                    },
                    {
                      "type": "tip",
                      "text": "Passwords should be stored using bCrypt or sCrypt, the only algorithms that [ORGANIZATION_NAME] Security policy considers acceptable for passwords.",
                      "warn": "yes",
                      "why": "Explain how you are storing passwords securely, provide detail about what hash or encryption algorithms are used, and explain why you are not using bCrypt or sCrypt.",
                      "severity": "high",
                      "name": "Information Password Requirements",
                      "cond": "app_info_passwords_crypt_no",
                      "id": "warn_app_info_passwords_crypt_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does Restricted information include numbers like a credit card number, financial account ID, or social security number?",
                      "cond": "app_info_restricted_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_numbers_yes": "Yes"},
                        {"app_info_numbers_no": "No"}
                      ],
                      "id": "app_info_numbers"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are numbers like a credit card number, financial account ID, or social security number masked?",
                      "cond": "app_info_numbers_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_numbers_masked_yes": "Yes"},
                        {"app_info_numbers_masked_no": "No"}
                      ],
                      "id": "app_info_numbers_masked"
                    },
                    {
                      "type": "tip",
                      "text": "Such information must be masked when displayed such that only individuals with legitimate need can see full numbers.",
                      "warn": "yes",
                      "severity": "high",
                      "name": "Information Restricted Requirements",
                      "cond": "app_info_numbers_masked_no",
                      "id": "warn_app_info_number_masked"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does Restricted information include credit card numbers?",
                      "defaultChoice": false,
                      "cond": "app_info_numbers_yes",
                      "choices": [
                        {"app_info_cc_yes": "Yes"},
                        {"app_info_cc_no": "No"}
                      ],
                      "id": "app_info_cc"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are credit card transactions processed?",
                      "defaultChoice": false,
                      "cond": "app_info_cc_yes",
                      "choices": [
                        {"app_info_cc_processed_yes": "Yes"},
                        {"app_info_cc_processed_no": "No"}
                      ],
                      "id": "app_info_cc_processed"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain how credit card transactions are managed to meet PCI compliance:",
                      "name": "Credit card transaction detail",
                      "cond": "app_info_cc_processed_yes",
                      "id": "warn_app_info_cc_processed"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are credit card numbers stored digitally?",
                      "cond": "app_info_cc_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_cc_stored_yes": "Yes"},
                        {"app_info_cc_stored_no": "No"}
                      ],
                      "id": "app_info_cc_stored"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are credit card numbers stored only in tokenized form?",
                      "cond": "app_info_cc_stored_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_cc_tokenized_yes": "Yes"},
                        {"app_info_cc_tokenized_no": "No"}
                      ],
                      "id": "app_info_cc_tokenized"
                    },
                    {
                      "type": "tip",
                      "text": "Credit card information must only be stored in tokenized form.",
                      "warn": "yes",
                      "name": "Credit card Storage not tokenized",
                      "severity": "high",
                      "cond": "app_info_cc_tokenized_no",
                      "id": "warn_app_info_cc_tokenized"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "4.2: Confidential Information",
                  "id": "block_info_confidential",
                  "items": [
                    {
                      "type": "info",
                      "text": "<p><b>Confidential Information</b> is considered to be sensitive and/or privileged information that does not necessarily rise to the level of Restricted Information.  This includes:</p><p><b>Business (non-public):</b></p><ul><li>Business Plans/Contracts</li><li>Human Resource Information/Employee Data (e.g. PII from employment applications, personnel files, pay stubs, benefits information, employee performance reports) other than Sensitive PII</li><li>Customer information other than Sensitive PII (e.g. name, address, phone numbers, email)</li><li>Proprietary Formulas/Algorithms</li><li>Product Designs/Drawings</li><li>Finance Data (other than associated with Restricted)</li><li>Procedures/Operational Work Routines</li><li>Information Derived from Credit Reports</li><li>Marketing Plans</li><li>Audit Reports</li><li>Security Assessments</li><li>Business Continuity Plans (BCP/DR)</li><li>Internal Control Procedures</li></ul><p><b>Information Technology (non-public):</b></p><ul><li>Transactional Data that contains customer or employee information (other than Sensitive PII)</li><li>Application Source Code</li></ul>"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the information processed by this project include Confidential Information?",
                      "choices": [
                        {"app_info_confidential_yes": "Yes"},
                        {"app_info_confidential_no": "No"}
                      ],
                      "id": "app_info_confidential"
                    },
                    {
                      "type": "box",
                      "text": "Explain what Confidential Information is associated with this project:",
                      "cond": "app_info_confidential_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_confidential_detail"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "4.3: Encrypting Restricted And Confidential Information",
                  "id": "block_info_restricted_confidential",
                  "cond": "app_info_restricted_yes || app_info_confidential_yes",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted and Confidential information only distributed to individuals with a defined need to know?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_need_to_know_yes": "Yes"},
                        {"app_info_need_to_know_no": "No"}
                      ],
                      "id": "app_info_need_to_know"
                    },
                    {
                      "type": "tip",
                      "text": "Restricted and Confidential information should only be made available to those who need to know.",
                      "warn": "yes",
                      "why": "Explain why this security requirement is not met:",
                      "name": "Restricted and Confidential information available to those without a need to know",
                      "severity": "high",
                      "cond": "app_info_need_to_know_no",
                      "id": "warn_app_info_need_to_know"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted or Confidential information sent by email?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_email_yes": "Yes"},
                        {"app_info_email_no": "No"}
                      ],
                      "id": "app_info_email"
                    },
                    {
                      "type": "box",
                      "text": "Explain how encryption is used when sending Restricted and Confidential information by email:",
                      "cond": "app_info_email_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_email__detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted or Confidential information (aside from the email address itself) sent by email using <a href=\"https://en.wikipedia.org/wiki/Email_encryption\">message level encryption</a>?",
                      "cond": "app_info_email_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_email_encrypted_yes": "Yes"},
                        {"app_info_email_encrypted_no": "No"}
                      ],
                      "id": "app_info_email_encrypted"
                    },
                    {
                      "type": "tip",
                      "text": "Restricted and Confidential information sent by email must use message level encryption using an approved encryption algorithm.",
                      "warn": "yes",
                      "severity": "high",
                      "name": "Information Email Encryption Requirements",
                      "cond": "app_info_email_encrypted_no",
                      "why": "Explain why Restricted or Confidential emails are not using message level encryption:",
                      "id": "warn_app_info_email_encrypted"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are files containing Restricted or Confidential information shared externally?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_shared_yes": "Yes"},
                        {"app_info_shared_no": "No"}
                      ],
                      "id": "app_info_shared"
                    },
                    {
                      "type": "box",
                      "text": "Explain how the data is encrypted at rest and how encryption keys are protected for securing Restricted and Confidential data when it is shared externally:",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_shared_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are files containing Restricted or Confidential information shared externally only in encrypted form using an approved method before being transmitted to an external network?",
                      "cond": "app_info_shared_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_shared_file_encrypted_yes": "Yes"},
                        {"app_info_shared_file_encrypted_no": "No"}
                      ],
                      "id": "app_info_shared_file_encrypted"
                    },
                    {
                      "type": "tip",
                      "text": "Files containing Restricted or Confidential information must be encrypted using an approved method before being transmitted to an external network, system or authorized third party.",
                      "warn": "yes",
                      "severity": "high",
                      "name": "Information Encryption Requirements",
                      "why": "Explain why Restricted or Confidential information is not being encrypted:",
                      "cond": "app_info_shared_file_encrypted_no",
                      "id": "warn_app_info_shared_file_encrypted"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted or Confidential information transmitted only using <a href=\"https://en.wikipedia.org/wiki/Cryptographic_protocol\">secure data transport protocols</a> (e.g. HTTPS, IPsec, TLS) between source and destination?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_protocol_secure_yes": "Yes"},
                        {"app_info_protocol_secure_no": "No"}
                      ],
                      "id": "app_info_protocol_secure"
                    },
                    {
                      "type": "box",
                      "text": "Explain how encryption is used when sending Restricted and Confidential information over an protocol:",
                      "cond": "app_info_protocol_secure_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_protocol_detail"
                    },
                    {
                      "type": "box",
                      "text": "It is a requirement to use a secure protocol when transmitting Restricted or Confidential data externally and recommended when on premesis.  Note that in AWS all transmission (even in private subnets) should use secure protocols.  Please explain why secure protocols are not being used?",
                      "cond": "app_info_protocol_secure_no",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_protocol_not_used_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted or Confidential information shared externally over an internet protocol or is such data transmitted within AWS?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_protocol_yes": "Yes"},
                        {"app_info_protocol_no": "No"}
                      ],
                      "id": "app_info_protocol"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted or Confidential information shared externally or within AWS only using secure protocols?",
                      "defaultChoice": false,
                      "cond": "app_info_protocol_yes",
                      "choices": [
                        {"app_info_protocol_external_yes": "Yes"},
                        {"app_info_protocol_external_no": "No"}
                      ],
                      "id": "app_info_protocol_external"
                    },
                    {
                      "type": "tip",
                      "text": "Transmission of Restricted or Confidential information over public networks must use secure data transport protocols (e.g. IPsec, TLS) between source and destination.",
                      "name": "Information Protocol Encryption Requirements",
                      "warn": "yes",
                      "severity": "high",
                      "cond": "app_info_protocol_external_no",
                      "why": "Explain why secure data transport protocols are not being used:",
                      "id": "warn_app_info_protocol_secure"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted or Confidential information distributed externally via any other means?",
                      "cond": "app_info_internal_yes",
                      "choices": [
                        {"app_info_dist_yes": "Yes"},
                        {"app_info_dist_no": "No"}
                      ],
                      "id": "app_info_dist"
                    },
                    {
                      "type": "box",
                      "text": "Please explainwhat other ways Restricted or Confidential information is shared externally",
                      "cond": "app_info_dist_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_dist_detail"
                    },
                    {
                      "type": "box",
                      "text": "Provide details on any additional controls that are used to ensure that Restricted and Confidential information is provided only to those who need to know:",
                      "id": "app_info_additional_controls",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "4.4: Internal Information",
                  "id": "block_info_internal",
                  "items": [
                    {
                      "type": "info",
                      "text": "<p><b>Internal Information</b> is business and/or operational information that [ORGANIZATION_NAME] employees may gather, generate and/or use in relation to normal business operations.  It is to be used within [ORGANIZATION_NAME] only and is not approved for external circulation.  This includes:</p><p><b>Business (non-public):</b></p><ul><li>Internal Memos and/or Emails</li><li>Meeting Minutes</li><li>Internal Project Reports</li><li>Organizational Charts</li><li>Internal Phone Directories</li><li>Internal Policies, Standards and/or Processing Methods</li></ul><p><b>Information Technology (non-public):</b></p><ul><li>Development or test data that does <b>not</b> contain personally identifiable information (PII), SSN's, Tax IDs or credit card information</li><li>Internal IP Address Information</li></ul>"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the information processed by this project include Internal Information?",
                      "choices": [
                        {"app_info_internal_yes": "Yes"},
                        {"app_info_internal_no": "No"}
                      ],
                      "id": "app_info_internal"
                    },
                    {
                      "type": "box",
                      "text": "Explain what Internal Information is associated with this project:",
                      "cond": "app_info_internal_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_internal_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Internal information stored digitally?",
                      "cond": "app_info_internal_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_internal_stored_yes": "Yes"},
                        {"app_info_internal_stored_no": "No"}
                      ],
                      "id": "app_info_internal_stored"
                    },
                    {
                      "type": "box",
                      "text": "Explain how the data is encrypted at rest and how encryption keys are protected for securing Internal data when it is stored at rest:",
                      "cond": "app_info_internal_stored_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_internal_stored_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Internal information transmitted only using <a href=\"https://en.wikipedia.org/wiki/Cryptographic_protocol\">secure data transport protocols</a> (e.g. HTTPS, IPsec, TLS) between source and destination?",
                      "defaultChoice": false,
                      "cond": "app_info_internal_yes",
                      "choices": [
                        {"app_info_internal_dist_secure_yes": "Yes"},
                        {"app_info_internal_dist_secure_no": "No"}
                      ],
                      "id": "app_info_internal_protocol_secure"
                    },
                    {
                      "type": "box",
                      "text": "Explain how encryption is used when sending Internal information over an protocol:",
                      "cond": "app_info_internal_dist_secure_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_internal_protocols"
                    },
                    {
                      "type": "box",
                      "text": "It is a requirement to use a secure protocol when transmitting Internal data externally and recommended when on premesis.  Note that in AWS all transmission (even in private subnets) should use secure protocols.  Please explain why secure protocols are not being used?",
                      "cond": "app_info_internal_dist_secure_no",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_internal_protocol_not_used_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Internal information shared externally over an internet protocol or is such data transmitted within AWS?",
                      "cond": "app_info_internal_yes",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_internal_protocol_yes": "Yes"},
                        {"app_info_internal_protocol_no": "No"}
                      ],
                      "id": "app_info_internal_protocol"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Internal information shared externally or within AWS only using secure protocols?",
                      "defaultChoice": false,
                      "cond": "app_info_internal_protocol_yes",
                      "choices": [
                        {"app_info_internal_protocol_external_yes": "Yes"},
                        {"app_info_internal_protocol_external_no": "No"}
                      ],
                      "id": "app_info_internal_protocol_external"
                    },
                    {
                      "type": "tip",
                      "text": "Transmission of Intenral information over public networks must use secure data transport protocols (e.g. IPsec, TLS) between source and destination.",
                      "name": "Information Protocol Encryption Requirements",
                      "warn": "yes",
                      "severity": "high",
                      "cond": "app_info_internal_protocol_external_no",
                      "why": "Explain why secure data transport protocols are not being used:",
                      "id": "warn_app_info_internal_dist_secure"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Internal information distributed externally via any other means?",
                      "cond": "app_info_internal_yes",
                      "choices": [
                        {"app_info_internal_dist_yes": "Yes"},
                        {"app_info_internal_dist_no": "No"}
                      ],
                      "id": "app_info_internal_dist"
                    },
                    {
                      "type": "box",
                      "text": "Please explainwhat other ways Internal information is shared externally",
                      "cond": "app_info_internal_dist_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_info_internal_dist_detail"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "4.5: Information Overview",
                  "id": "block_info_overview",
                  "items": [
                    {
                      "type": "box",
                      "text": "Please provide an overview description of the types of data that this project processes, stores or transmits",
                      "id": "app_info_overview",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]"
                    }
                  ]
                },
                {
                  "type": "tip",
                  "text": "This project makes use of information that is <b>Restricted</b>, <b>Confidential</b>, or <b>Internal</b>.  Such information has the following additional requirements:<ul><li>May only be distributed to individuals with a defined need-to-know.</li><li>May only be sent externally with the explicit prior permission of the [ORGANIZATION_NAME] Information Owner.</li><li>Non-[ORGANIZATION_NAME] or personal email services (Google, Yahoo Mail) may not be used for transmitting or receiving such information.</li><li>May not be stored on non-[ORGANIZATION_NAME] owned equipment unless explicitly approved by the Information Security Department and the [ORGANIZATION_NAME] Information Owner.</li><li>Third party processing or storage services (e.g. Dropbox, Google Drive) are no appropriate for sharing or storing such information unless explicitly approved by the Information Security Department and the [ORGANIZATION_NAME] Information Owner.</li></ul>",
                  "name": "Restricted and Confidential Information Requirements",
                  "cond": "app_info_restricted_yes || app_info_confidential_yes",
                  "id": "warn_app_info_restricted_confidential"
                },
                {
                  "type": "tip",
                  "text": "This project makes use of information that is <b>Internal</b>.  For Internal information, it is recommended, but not required, that:<ul><li>Message level encryption is used with an approved encryption algorithm for external distribution.</li><li>Stored internal information be encrypted.</li></ul>",
                  "name": "Information Protocol Encryption Requirements",
                  "cond": "app_info_internal_yes",
                  "id": "warn_app_info_internal"
                }
              ]
            },
            {
              "type": "block",
              "text": "5: AWS (Amazon Web Services) Cloud Security",
              "id": "block_app_aws_security",
              "cond": "app_deploy_aws",
              "items": [
                {
                  "type": "radiogroup",
                  "text": "Have you worked with external clients using this product to ensure they are agreeable with the project running in Amazon?",
                  "id": "app_aws_client_approval",
                  "choices": [
                    {"app_aws_client_approval_yes": "Yes"},
                    {"app_aws_client_approval_no": "No"},
                    {"app_aws_client_approval_na": "This project has no external clients"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Using services in Amazon has risks if we are not sure that external clients approve.  Contact [ORGANIZATION_APPSEC_EMAIL_HREF] to discuss this concern.",
                  "id": "warn_app_aws_client_approval",
                  "why": "Please explain if you think this concern does not apply in this case.",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_client_approval_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Are you using a Standard [ORGANIZATION_NAME]-provided AWS team account, ensuring that you are following secure IAM, Security Group, ACL and VPC (Virtual Private Cloud) policies?",
                  "id": "app_aws_ms_account",
                  "choices": [
                    {"app_aws_ms_account_yes": "Yes"},
                    {"app_aws_ms_account_no": "No"}
                  ]
                },
                {
                  "type": "info",
                  "text": "The AWS account root access key must be protected.  Refer to the <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#lock-away-credentials\">AWS Identify and Access Best Practices</a>.",
                  "cond": "app_aws_ms_account_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Is the AWS root account associated with this project protected?",
                  "id": "app_aws_root",
                  "cond": "app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_root_yes": "Yes"},
                    {"app_aws_root_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Are IAM policies and roles the only mechanism used to provide access to AWS services?",
                  "id": "app_aws_iam_only",
                  "cond": "app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_iam_only_yes": "Yes"},
                    {"app_aws_iam_only_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Do IAM policies and roles provide the principle of least privilege?",
                  "id": "app_aws_iam_least_privilege",
                  "cond": "app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_iam_least_privilege_yes": "Yes"},
                    {"app_aws_iam_least_privilege_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "AWS IAM policies and roles are the preferred mechanisms to provide access to AWS services and roles should meet the principle of least privilege.  Refer to the <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access.html\">AWS Identity and Access Management User Guide</a>.",
                  "id": "warn_app_aws_iam_only",
                  "why": "Explain why this project does not use IAM policies and roles to meet the principle of least privilege and describe what other controls may be used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_iam_only_no || app_aws_iam_least_privilege_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Is MFA (Multi Factor Authentication) enabled for AWS users with privileges associated with this project?",
                  "id": "app_aws_mfa",
                  "cond": "app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_mfa_yes": "Yes"},
                    {"app_aws_mfa_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "AWS privileged accounts should have MFA enabled.",
                  "id": "warn_app_aws_mfa",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_mfa_no"
                },
                {
                  "type": "box",
                  "text": "Highlight any security configurations or features implemented by the project team.  If this project makes use of any project-specific Amazon IAM policies, Security Groups, Access Control Lists (ACL), other Amazon configuration that affects security, please provide detail:",
                  "id": "app_aws_iam_detail",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]"
                },
                {
                  "type": "checkgroup",
                  "text": "What AWS services are used?",
                  "defaultChoice": false,
                  "choices": [
                    {"app_aws_certificate_manager": "AWS <a href=\"https://aws.amazon.com/certificate-manager\">Certificate Manager</a>"},
                    {"app_aws_cloudfront": "AWS <a href=\"https://aws.amazon.com/cloudfront\">CloudFront</a> CDN (Content Delivery Network)"},
                    {"app_aws_cognito": "AWS <a href=\"https://aws.amazon.com/cognito\">Cognito</a>"},
                    {"app_aws_db": "AWS Databases (<a href=\"https://aws.amazon.com/RDS\">RDS</a>, <a href=\"https://aws.amazon.com/dynamodb\">DynamoDB</a>, <a href=\"https://aws.amazon.com/redshift\">Redshift</a>)"},
                    {"app_aws_ec2": "AWS <a href=\"https://aws.amazon.com/ec2\">EC2</a>"},
                    {"app_aws_ebs": "AWS <a href=\"https://aws.amazon.com/ebs\">Elastic Block Store</a> (EBS)"},
                    {"app_aws_ecs": "AWS <a href=\"https://aws.amazon.com/ecs\">Elastic Container Service</a> (ECS)"},
                    {"app_aws_elb": "AWS <a href=\"https://aws.amazon.com/elasticloadbalancing\">Elastic Load Balancing</a> (ELB/ALB)"},
                    {"app_aws_elasticache": "AWS <a href=\"https://aws.amazon.com/elasticache\">ElastiCache</a>"},
                    {"app_aws_glacier": "AWS <a href=\"https://aws.amazon.com/glacier\">Glacier</a>"},
                    {"app_aws_lambda": "AWS <a href=\"https://aws.amazon.com/lambda\">Lambda</a>"},
                    {"app_aws_opsworks": "AWS <a href=\"https://aws.amazon.com/opsworks\">OpsWorks</a>"},
                    {"app_aws_r53": "AWS <a href=\"https://aws.amazon.com/route53\">Route 53</a>"},
                    {"app_aws_s3": "AWS <a href=\"https://aws.amazon.com/s3\">S3</a>"},
                    {"app_aws_sts": "AWS <a href=\"http://docs.aws.amazon.com/STS/latest/APIReference/Welcome.html\">Security Token Service</a> (STS)"},
                    {"app_aws_other": "Other"}
                  ]
                },
                {
                  "type": "line",
                  "text": "What other AWS services are used?  Note that AWS services associated with Deployment, Logging, and Cryptography (Certificates, Keys, Passwords and Other Secrets) are discussed in separate parts of the form and do not need to be mentioned in this section.",
                  "id": "app_aws_other_detail",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_aws_other"
                },
                {
                  "type": "tip",
                  "text": "The CloudFront Content Delivery Network (CDN) should be used to accelerate content to end users.",
                  "id": "warn_app_aws_cloudfront",
                  "why": "Explain why CloudFront is not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_web_browser_yes && !app_aws_cloudfront"
                },
                {
                  "type": "radiogroup",
                  "text": "Is CloudFront or ALB (Application Load Balancer) <a href=\"https://aws.amazon.com/waf\">WAF</a> (Web Application Firewall) enabled?",
                  "id": "app_aws_cloudfront_waf",
                  "cond": "app_aws_cloudfront || app_aws_elb",
                  "choices": [
                    {"app_aws_cloudfront_waf_yes": "Yes"},
                    {"app_aws_cloudfront_waf_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "The CloudFront Content Delivery Network (CDN) or Application Load Balancer (ALB) Web Application Firewall (WAF) should be enabled to help protect from common web exploits such as SQL injection and cross-site scripting.",
                  "id": "warn_app_aws_cloudfront_waf",
                  "why": "Explain why CloudFront or ALB WAF is not used:",
                  "cond": "(app_aws_cloudfront || app_aws_elb) && app_aws_cloudfront_waf_no",
                  "warn": "yes",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "text": "Regarding EC2, are you only using [ORGANIZATION_NAME]-approved and managed AMI's (Amazon Machine Image)?",
                  "id": "app_aws_ami",
                  "cond": "app_aws_ec2",
                  "choices": [
                    {"app_aws_ami_yes": "Yes"},
                    {"app_aws_ami_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Using [ORGANIZATION_NAME]-approved and managed AMI is recommended, so please answer the following questions",
                  "id": "warn_app_aws_ami",
                  "warn": "yes",
                  "cond": "app_aws_ami_no"
                },
                {
                  "type": "line",
                  "text": "Describe the source of the AMI's that are not [ORGANIZATION_NAME]-approved and managed?  Is this a trusted source?",
                  "id": "app_aws_ami_source",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_aws_ami_no"
                },
                {
                  "type": "box",
                  "text": "Please explain how machines not using a [ORGANIZATION_NAME]-approved and managed AMI are being maintained, managed and patched.",
                  "id": "app_aws_ami_maintained",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "cond": "app_aws_ami_no"
                },
                {
                  "type": "checkgroup",
                  "text": "Which machines are not using a [ORGANIZATION_NAME]-approved and managed AMI (check all that apply)?",
                  "defaultChoice": false,
                  "cond": "app_aws_ami_no",
                  "choices": [
                    {"app_aws_ami_linux": "Linux"},
                    {"app_aws_ami_windows": "Windows"},
                    {"app_aws_ami_ec2": "EC2 Instances"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Is SELinux being used on all Linux servers that are not using a [ORGANIZATION_NAME]-approved and managed AMI?",
                  "id": "app_aws_ami_selinux",
                  "cond": "app_aws_ami_linux",
                  "choices": [
                    {"app_aws_ami_selinux_yes": "Yes"},
                    {"app_aws_ami_selinux_no": "No"}
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Is antivirus enabled for all EC2 instances that are not using a [ORGANIZATION_NAME]-approved and managed AMI?",
                  "id": "app_aws_ami_antivirus",
                  "cond": "app_aws_ami_ec2",
                  "choices": [
                    {"app_aws_ami_ec2_antivirus_yes": "Yes"},
                    {"app_aws_ami_ec2_antivirus_no": "No"}
                  ]
                },
                {
                  "type": "box",
                  "text": "Please explain how you are authenticating with systems not using a [ORGANIZATION_NAME]-approved and managed AMI:",
                  "id": "app_aws_ami_authz",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "cond": "app_aws_ami_no"
                },
                {
                  "type": "box",
                  "text": "Please explain how passwords and keys are rotated with systems not using a [ORGANIZATION_NAME]-approved and managed AMI",
                  "id": "app_aws_ami_secret_rotation",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "cond": "app_aws_ami_no"
                },
                {
                  "type": "box",
                  "text": "Please explain how machines not using a [ORGANIZATION_NAME]-approved and managed AMI are hardened to meet CIS standards",
                  "id": "app_aws_ami_hardened",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "cond": "app_aws_ami_no"
                },
                {
                  "type": "checkgroup",
                  "text": "What AWS databases are used (Amazon RDS PostgreSQL is recommended unless specific feature/performance requirements)?",
                  "cond": "app_aws_db",
                  "defaultChoice": false,
                  "choices": [
                    {"app_aws_db_dynamodb": "AWS <a href=\"https://aws.amazon.com/dynamodb\">DynamoDB</a>"},
                    {"app_aws_db_redshift": "AWS <a href=\"https://aws.amazon.com/redshift\">Redshift</a>"},
                    {"app_aws_db_rds_aurora": "AWS RDS <a href=\"https://aws.amazon.com/rds/aurora\">Aurora</a>"},
                    {"app_aws_db_rds_mariadb": "AWS RDS <a href=\"https://aws.amazon.com/rds/mariadb\">MariaDB</a>"},
                    {"app_aws_db_rds_mssql": "AWS RDS <a href=\"https://aws.amazon.com/rds/sqlserver\">Microsoft SQL Server</a>"},
                    {"app_aws_db_rds_mysql": "AWS RDS <a href=\"https://aws.amazon.com/rds/mysql\">MySQL</a>"},
                    {"app_aws_db_rds_postgresql": "AWS RDS <a href=\"https://aws.amazon.com/rds/postgresql\">PostgreSQL</a>"},
                    {"app_aws_db_other": "Other options, like running a database in EC2"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Detail which other databases are being used in AWS?",
                  "id": "app_auth_db_other_detail",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_aws_db_other"
                },
                {
                  "type": "radiogroup",
                  "text": "Do applications running on EC2 only use roles to access other AWS services?",
                  "id": "app_aws_ec2_roles",
                  "cond": "app_aws_ec2",
                  "choices": [
                    {"app_aws_ec2_roles_yes": "Yes"},
                    {"app_aws_ec2_roles_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "EC2 should only access AWS services via IAM policies and roles.  Refer to the <a href=\"http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html\">AWS Identify and Access Management Best Practices</a>.",
                  "id": "warn_app_aws_ec2_roles",
                  "why": "Explain why roles are not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_ec2_roles_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Is inbound and outbound traffic to EC2 instances controlled with clearly structured Security Groups?",
                  "id": "app_aws_ec2_security_groups",
                  "cond": "app_aws_ec2",
                  "choices": [
                    {"app_aws_ec2_security_groups_yes": "Yes"},
                    {"app_aws_ec2_security_groups_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Security Groups should be used to control EC2 inbound and outbound traffic.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_SecurityGroups.html\">AWS VPC User Guide</a>.",
                  "id": "warn_app_aws_ec2_security_groups",
                  "why": "Explain why Security Groups are not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_ec2_security_groups_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Are any S3 buckets configured to be readable by anyone on the internet?  By default, S3 bucket ACLs only allow the account owner to read contents from the bucket.",
                  "id": "app_aws_s3_world_readable",
                  "cond": "app_aws_s3",
                  "choices": [
                    {"app_aws_s3_world_readable_yes": "Yes"},
                    {"app_aws_s3_world_readable_no": "No"}
                  ]
                },
                {
                  "type": "box",
                  "text": "Please describe the data that has world read access:",
                  "id": "app_aws_s3_world_readable_detail",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "cond": "app_aws_s3_world_readable_yes"
                },
                {
                  "type": "radiogroup",
                  "text": "Is all data in S3 buckets with world read access classified as public data?",
                  "id": "app_aws_s3_world_readable_public",
                  "cond": "app_aws_s3_world_readable_yes",
                  "choices": [
                    {"app_aws_s3_world_readable_public_yes": "Yes"},
                    {"app_aws_s3_world_readable_public_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "It is not acceptable for a S3 bucket to be world readable if it contains anything but data classified as public.",
                  "id": "warn_app_aws_s3_world_readable_public",
                  "why": "Explain why this best practice is not beig followed:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_s3_world_readable_public_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Are IAM policies and roles used to manage access permissions to S3 resources?",
                  "id": "app_aws_s3_policies",
                  "cond": "app_aws_s3",
                  "choices": [
                    {"app_aws_s3_policies_yes": "Yes"},
                    {"app_aws_s3_policies_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "S3 access should be done via IAM policies and roles.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/intro-managing-access-s3-resources.html\">S3 Developer Guide</a>.",
                  "id": "warn_app_aws_s3_resources",
                  "why": "Explain why policies are not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_s3_policies_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Is Server Side Encryption used with S3?",
                  "id": "app_aws_s3_ss_encryption",
                  "cond": "app_aws_s3",
                  "choices": [
                    {"app_aws_s3_ss_encryption_yes": "Yes"},
                    {"app_aws_s3_ss_encryption_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "S3 should use server side encryption.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html/\">Amazon Simple Storage Service Developer Guide</a>.",
                  "id": "warn_app_aws_s3_ss_encryption",
                  "why": "Explain why S3 server side encryption is not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_s3_ss_encryption_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Is S3 inbound and outbound data traffic encrypted (e.g. with S3 SSL or HTTPS)?",
                  "id": "app_aws_s3_encryption",
                  "cond": "app_aws_s3",
                  "choices": [
                    {"app_aws_s3_encryption_yes": "Yes"},
                    {"app_aws_s3_encryption_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "S3 should use encryption for inbound and outbound data traffic.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html/\">Amazon Simple Storage Service Developer Guide</a>.",
                  "id": "warn_app_aws_s3_encryption",
                  "why": "Explain why S3 encryption is not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_s3_encryption_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Are only encrypted EBS volumes used?",
                  "id": "app_aws_ebs_encryption",
                  "cond": "app_aws_ebs",
                  "choices": [
                    {"app_aws_ebs_encryption_yes": "Yes"},
                    {"app_aws_ebs_encryption_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "EBS should only use encrypted EBS volumes.  Refer to the <a href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS Encryption User Guide</a>.",
                  "id": "warn_app_aws_ebs_encryption",
                  "why": "Explain why encrypted EBS volumes are not used:",
                  "warn": "yes",
                  "severity": "high",
                  "cond": "app_aws_ebs_encryption_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Is AWS VPC (Virtual Private Cloud) used?  Note that VPC is automatically used if using a standard provided [ORGANIZATION_NAME] AWS account.",
                  "id": "app_aws_vpc",
                  "cond": "app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_vpc_yes": "Yes"},
                    {"app_aws_vpc_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "VPC should always be used to leverage multiple layers of security, including security groups and Access Control Lists.",
                  "id": "warn_app_aws_vpc",
                  "why": "Explain why VPC is not used:",
                  "warn": "yes",
                  "cond": "app_aws_vpc_no",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "text": "Is VPC configured to use Security Groups?",
                  "id": "app_aws_vpc_security_groups",
                  "cond": "app_aws_vpc_yes && app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_vpc_security_groups_yes": "Yes"},
                    {"app_aws_vpc_security_groups_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "VPC should be configured to work with Security Groups to control inbound and outbound traffic at the instance level.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_SecurityGroups.html\">AWS VPC User Guide</a>.",
                  "id": "warn_app_aws_vpc_security_groups",
                  "why": "Explain why VPC is not used with Security Groups:",
                  "warn": "yes",
                  "cond": "app_aws_vpc_security_groups_no",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "text": "Is VPC using ACLs (Access Control Lists)?",
                  "id": "app_aws_vpc_acl",
                  "cond": "app_aws_vpc_yes && app_aws_ms_account_no",
                  "choices": [
                    {"app_aws_vpc_acl_yes": "Yes"},
                    {"app_aws_vpc_acl_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "VPC should be configured to use ACLs to act as a firewall for controlling traffic.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_ACLs.html\">AWS VPC User Guide</a>.",
                  "id": "warn_app_aws_vpc_acl",
                  "why": "Explain why VPC is not used with ACLs:",
                  "warn": "yes",
                  "cond": "app_aws_vpc_acl_no",
                  "severity": "high"
                }
              ]
            },
            {
              "type": "block",
              "text": "6: Users, Registration, Authentication and Authorization",
              "id": "block_authn_authz",
              "cond": "app_auth_yes || app_public_api_yes || app_rest_api_yes || app_auth_reg_yes",
              "items": [
                {
                  "type": "block",
                  "text": "6.1: Registration, Basic Authorization and Authentication Information",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "To get started, tell us a little about your application so we can ask you the right questions.",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_reg_requires_email": "The project requires a new user to register using ones email."},
                        {"app_auth_requires_login": "The project requires regular users to log in. Most features are not available without logging in."},
                        {"app_auth_admin_interface": "In addition to an interface for regular users to log in, our application provides an administration interface."},
                        {"app_auth_roles": "The project features complex user management like roles.  Various roles can be assigned to user accounts."},
                        {"app_auth_api": "The project provides an API that requires authentication."},
                        {"app_auth_api_none": "The project provides an API with no authentication."},
                        {"app_auth_api_database": "The project requires authentication with a database."}
                      ]
                    },
                    {
                      "type": "checkgroup",
                      "text": "Tell us how the email registration works.",
                      "id": "app_auth_reg_requires_email_details",
                      "cond": "app_auth_reg_requires_email",
                      "defaultChoice": false,
                      "choices": [
                      	{"app_auth_reg_requires_email_captcha": "User registration requires CAPTCHA verification."},
                      	{"app_auth_reg_requires_email_verification": "Email used for user registration is verified by sending a confirmation email and requiring the users to confirm their email."},
                      	{"app_auth_reg_requires_email_for_appuse": "The user is not allowed to use the services until email used for user registration is verified."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Any user registration feature must always have associated CAPTCHA verification. Any email used for registration MUST always be confirmed.",
                      "id": "warn_app_auth_reg_no_verification",
                      "why": "Explain why CAPTCHA verification or email confirmation is not required?",
                      "warn": "yes",
                      "cond": "app_auth_reg_requires_email && (!app_auth_reg_requires_email_captcha || !app_auth_reg_requires_email_verification)",
                      "severity": "high"
                    },
                    {
                      "type": "tip",
                      "text": "API's should provide API authentication unless the data provided by the API is classified as Public.",
                      "id": "warn_app_auth_api_none",
                      "why": "Explain why API authentication is not needed.  Is the data all classified as Public?",
                      "warn": "yes",
                      "cond": "app_auth_api_none",
                      "severity": "medium"
                    },
                    {
                      "type": "box",
                      "text": "Briefly describe the different roles associated with your application. Do not simply enumerate roles, but explain the purpose of them.  Describe any special permissions associated with different roles and explain any custom role definitions.",
                      "id": "app_auth_roles_detail",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "app_auth_roles"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are you using the [ORGANIZATION_NAME] [ORGANIZATION_RECOMMENDED_AUTH_SOLUTION_NAME] solution for authentication?",
                      "cond": "app_auth_requires_login || app_auth_admin_interface",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_uim_yes": "Yes"},
                        {"app_auth_uim_no": "No"}
                      ],
                      "id": "app_authentication_uim"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Aside from standard usage of [ORGANIZATION_RECOMMENDED_AUTH_SOLUTION_NAME] does the project employ any other username/password-based authentication?  If [ORGANIZATION_RECOMMENDED_AUTH_SOLUTION_NAME] is used in a non-standard way, answer \"Yes\".",
                      "defaultChoice": false,
                      "choices": [
                        {"app_custom_auth_yes": "Yes"},
                        {"app_custom_auth_no": "No"}
                      ],
                      "cond": "app_auth_uim_yes",
                      "id": "app_custom_auth"
                    },
                    {
                      "type": "checkgroup",
                      "text": "Is your application integrated with any of the following single sign-on (SSO) mechanisms?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_sso_saml": "SAML 2.0"},
                        {"app_auth_sso_oauth": "OpenID Connect / OAuth2 Login"},
                        {"app_auth_sso_openid": "OpenID 2.0"},
                        {"app_auth_sso_ldap": "LDAP / Active Directory"},
                        {"app_auth_sso_other": "Other"},
                        {"app_auth_sso_none": "None of the above"}
                      ],
                      "cond": "(app_auth_uim_no || app_custom_auth_yes) && (app_auth_requires_login || app_auth_admin_interface)"
                    },
                    {
                      "type": "box",
                      "text": "What other SSO mechanisms does the application support?",
                      "id": "app_auth_sso_other_detail",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "app_auth_sso_other"
                    },
                    {
                      "type": "box",
                      "text": "Please explain why authentication is not needed.",
                      "id": "app_auth_sso_none_detail",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "app_auth_sso_none"
                    },
                    {
                      "type": "tip",
                      "text": "Integrating with LDAP and/or Active Directory has a significant downside: any application that integrates with it has to receive the user's SSO password. As a result, a vulnerability in any integrated application puts the password at risk for all other applications. We recommend using an SSO mechanism that does not require the password to be sent anywhere other than a central authentication system.",
                      "warn": "yes",
                      "name": "LDAP/AD integration sends password to application",
                      "severity": "high",
                      "id": "warn_app_auth_ldap_password",
                      "cond": "app_auth_sso_ldap"
                    },
                    {
                      "type": "tip",
                      "text": "OpenID 2.0 has been replaced by OpenID Connect (also called OAuth2 Login). We recommend updating your application's SSO integration to support OpenID Connect.",
                      "warn": "yes",
                      "name": "OpenID is deprecated",
                      "severity": "high",
                      "id": "warn_app_auth_openid_deprecated",
                      "cond": "app_auth_sso_openid && !app_auth_sso_oauth"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "6.2: OAuth2 Login",
                  "id": "block_oauth2",
                  "cond": "app_auth_sso_oauth",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Implementing OAuth2 Login / OpenID Connect from scratch is fairly complex and error-prone, and mistakes can result in security vulnerabilities. Select the option that best describes your implementation:",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth2_library": "Very secure: We are using a standard OAuth2 library, and we update it when security fixes are released."},
                        {"app_auth2_self_secure": "Secure: We implemented OAuth2 on our own, but our employees are experts and we are convinced that it is implemented securely."},
                        {"app_auth2_self": "Not sure: We implemented OAuth2 on our own, and it seemed simple at the time. I am not sure about the security of our implementation."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "If your employees really are OAuth2 experts, you are probably fine. But note that even standard libraries have had vulnerabilities due to the intricacies of the standard. Be sure to ask your penetration testing provider to take a look at the OAuth2 implementation.",
                      "id": "tip_app_auth2_self_secure"
                    },
                    {
                      "type": "tip",
                      "text": "Implementing OAuth2 on your own is extremely dangerous. Even the experts on the OAuth2 standards panel concluded that the only way to securely implement it is through a well-known and well-tested library. Some of these libraries are very easy to use (e.g., the <a href='https://developers.google.com/identity/toolkit/'>Google Identity Toolkit</a>), so replacing your custom implementation should be feasible.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                      "warn": "yes",
                      "name": "Homebrewed OAuth2 implementation",
                      "severity": "high",
                      "id": "warn_app_auth2_self"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "6.3: Username/Password Authentication",
                  "cond": "app_custom_auth_yes",
                  "id": "block_custom_auth",
                  "items": [
                    {
                      "type": "box",
                      "text": "What username/password-based logins does the application use? For example, if there is a separate administrator authentication, mention that.",
                      "id": "app_custom_auth_explain",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does your application allow users to change their passwords?",
                      "defaultChoice": false,
                      "id": "app_custom_auth_chpasswd",
                      "choices": [
                        {"app_custom_auth_chpasswd_yes": "Yes"},
                        {"app_custom_auth_chpasswd_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Allowing users to change their passwords is important. A user might be recovering from a compromise, or might have accidentally typed the password elsewhere.",
                      "warn": "yes",
                      "name": "Application does not support changing the password",
                      "severity": "high",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_custom_auth_chpasswd",
                      "cond": "app_custom_auth_chpasswd_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application enforce the minimum password security requirements defined in the [ORGANIZATION_NAME] Security Policies and Standards?",
                      "defaultChoice": false,
                      "id": "app_custom_auth_pwdreq",
                      "choices": [
                        {"app_custom_auth_pwdreq_yes": "Yes"},
                        {"app_custom_auth_pwdreq_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Please help protect users from themselves by enforcing certain minimum password requirements. It is up to you to determine the details of these requirements, but they should account for the sensitivity of the information and should conform to industry standards.",
                      "warn": "yes",
                      "name": "Application should enforce minimum password requirements",
                      "severity": "medium",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_custom_auth_pwdreq",
                      "cond": "app_custom_auth_pwdreq_no"
                    },
                    {
                      "type": "block",
                      "text": "6.3.1: Setting an Initial Password",
                      "id": "block_initial_password",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "How do users get their initial passwords?",
                          "defaultChoice": false,
                          "choices": [
                            {"app_custom_auth_initpwd_selfset": "Users self-register and set their passwords online directly within the application."},
                            {"app_custom_auth_initpwd_email": "The initial password or a link to set the initial password is sent to users by email."},
                            {"app_custom_auth_initpwd_snail": "The initial password is provided in a (physical) letter sent to a verified address."},
                            {"app_custom_auth_initpwd_other": "None of the above."}
                          ]
                        },
                        {
                          "type": "box",
                          "text": "Explain how users get their initial passwords:",
                          "id": "app_custom_auth_initpwd_other_what",
                          "maxlength": "[MAXLENGTH_BOX_ITEM]",
                          "cond": "app_custom_auth_initpwd_other"
                        },
                        {
                          "type": "radiogroup",
                          "text": "When the user gets their initial password, will their account be prepopulated with any confidential information? For example, in an online payroll portal, a user can typically access previous pay statements even when the account is brand new.",
                          "defaultChoice": false,
                          "id": "app_custom_auth_initpwd_prepopulated",
                          "choices": [
                            {"app_custom_auth_initpwd_prepopulated_yes": "Yes, when users log in for the first time, confidential information will already be present."},
                            {"app_custom_auth_initpwd_prepopulated_no": "No, at the initial login, no confidential information will be available to the user."}
                          ]
                        },
                        {
                          "type": "tip",
                          "warn": "yes",
                          "text": "When users self-register for prepopulated accounts, some initial authentication of the user should be performed. Otherwise, arbitrary users could gain access to the prepopulated information. The type of authentication depends on the sensitivity of the prepopulated information. Commonly requested information - like the last four digits of the social security number, a home address, or an employee ID - is rarely secret enough to be used for authentication",
                          "name": "Self-registration to prepopulated accounts",
                          "severity": "high",
                          "why": "Explain how users are identified and authenticated when they self-register in the application:",
                          "id": "warn_app_custom_auth_initpwd_selfset",
                          "cond": "app_custom_auth_initpwd_selfset && app_custom_auth_initpwd_prepopulated_yes"
                        },
                        {
                          "type": "tip",
                          "text": "If passwords are sent by email, make sure users are required to change their initial passwords when they first log in.",
                          "id": "tip_app_custom_auth_initpwd_email",
                          "cond": "app_custom_auth_initpwd_email"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "6.3.2: Account Recovery",
                      "id": "block_account_recovery",
                      "items": [
                        {
                          "type": "checkgroup",
                          "text": "Sometimes, passwords are simply forgotten - it happens to the best of us. How does your application deal with users who can no longer access their accounts?",
                          "defaultChoice": false,
                          "choices": [
                            {"app_custom_auth_recovery_questions": "The user is asked questions that were set up when the account was created."},
                            {"app_custom_auth_recovery_resetlink": "A password reset link is sent via email to the user's registered email address."},
                            {"app_custom_auth_recovery_newpwd": "A new password is sent via email to the user's registered email address."},
                            {"app_custom_auth_recovery_other": "None of the above."}
                          ]
                        },
                        {
                          "type": "box",
                          "text": "Describe your password recovery mechanism:",
                          "id": "app_custom_auth_recovery_other_what",
                          "maxlength": "[MAXLENGTH_BOX_ITEM]",
                          "cond": "app_custom_auth_recovery_other"
                        },
                        {
                          "type": "tip",
                          "warn": "yes",
                          "text": "Recovery questions alone should not be sufficient for resetting a password. The answers to these questions are often not as secret as they might seem; in particular, friends and family can often easily guess the answers.",
                          "name": "Recovery questions should not be sufficient to reset password",
                          "severity": "high",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                          "id": "warn_app_custom_auth_recovery_questions",
                          "cond": "app_custom_auth_recovery_questions && !(app_custom_auth_recovery_resetlink || app_custom_auth_recovery_newpwd)"
                        },
                        {
                          "type": "tip",
                          "warn": "yes",
                          "text": "Sending passwords by email is rarely a good idea. Email is generally unencrypted, so it should not be used for sensitive information. Instead, we recommend sending a token that can be used to set the actual password. Although an attacker with the token could still reset the password, the user would at least become aware of the reset when they later attempted to log in.",
                          "name": "Application sends passwords via email for account recovery",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                          "id": "warn_app_custom_auth_recovery_email",
                          "cond": "app_custom_auth_recovery_newpwd"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "6.4: Authentication Cookies and Sessions",
                  "id": "block_auth_cookies",
                  "cond": "app_auth_requires_login || app_auth_admin_interface",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Cookies can be decorated with a special keyword, <code>HttpOnly</code>. If this keyword is set, the browser will not allow JavaScript to access the cookie. Even if the application has a cross-site scripting vulnerability, this keyword makes it much harder for an attacker to steal the session cookie.",
                      "defaultChoice": false,
                      "id": "app_auth_cookies_httponly",
                      "cond": "app_web_browser_yes || app_project_type_WebApp || app_project_type_WebServices",
                      "choices": [
                        {"app_auth_cookies_httponly_yes": "The <code>HttpOnly</code> keyword is set for all our authentication cookies."},
                        {"app_auth_cookies_httponly_no": "The project does not make use of this defense-in-depth mechanism."},
                        {"app_auth_cookies_httponly_na": "This project does not make use of cookies."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Setting the <code>HttpOnly</code> attribute is a very simple defense-in-depth mechanism. We highly recommended making use of it.",
                      "warn": "yes",
                      "name": "Cookie without HttpOnly flag",
                      "severity": "medium",
                      "id": "warn_app_auth_cookies_httponly_no",
                      "why": "If there are specific reasons why this is not possible in your case please explain below:",
                      "cond": "app_auth_cookies_httponly_no"
                    },
                    {
                      "type": "checkgroup",
                      "text": "Session IDs can be constructed in many ways. Select the methods used in your application:",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_cookies_framework": "The application framework we use has a built-in session ID mechanism."},
                        {"app_auth_cookies_random": "Session IDs are randomly generated strings or numbers."},
                        {"app_auth_cookies_sig": "Signed token are stored as a cookie to indicate that the user is successfully logged in."},
                        {"app_auth_cookies_other": "The project uses some other mechanism."}
                      ]
                    },
                    {
                      "type": "box",
                      "text": "Describe the mechanism you are using:",
                      "id": "app_auth_cookies_other_explain",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "app_auth_cookies_other"
                    },
                    {
                      "type": "line",
                      "text": "What is the name of the framework that generates your session IDs?",
                      "id": "app_auth_cookies_framework_which",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "app_auth_cookies_framework"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do sessions automatically time out after a specified period of inactivity?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_cookies_timeout_yes": "Yes"},
                        {"app_auth_cookies_timeout_no": "No"}
                      ],
                      "cond": "app_auth_cookies_sig || app_auth_cookies_random",
                      "id": "app_auth_cookies_timeout"
                    },
                    {
                      "type": "tip",
                      "text": "If you do not specify a session timeout, an attacker who has stolen a session ID once will have a permanent back door to the application. Be sure to implement a timeout - even if it is fairly long, it is still better than no timeout at all).",
                      "warn": "yes",
                      "name": "No automatic session timeout",
                      "severity": "medium",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_auth_cookies_timeout",
                      "cond": "app_auth_cookies_timeout_no"
                    },
                    {
                      "type": "line",
                      "text": "How long is the session timeout?",
                      "id": "app_auth_cookies_timeout_length",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "app_auth_cookies_timeout_yes || app_auth_cookies_framework"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application use a secure <a href='https://en.wikipedia.org/wiki/Pseudorandom_number_generator#Cryptographically_secure_pseudorandom_number_generators'>cryptographic pseudo random number generator</a> (PRNG) to generate session IDs? The PRNG should not allow the state of the generator to be recalculated from its output, and the entropy of the session ID should be sufficient to make brute-forcing infeasible.",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_cookies_prng_yes": "Yes, we use a PRNG that meets these criteria."},
                        {"app_auth_cookies_prng_no": "No, we do not use a PRNG, or our PRNG doesn't meet these criteria."}
                      ],
                      "cond": "app_auth_cookies_random",
                      "id": "app_auth_cookies_prng"
                    },
                    {
                      "type": "tip",
                      "text": "If you are not using a cryptographic PRNG, an attacker can recalculate the state of the generator in order to guess subsequent session IDs and steal those users' sessions. Many programming languages already have a secure PRNG built in (e.g., Java has <code>java.security.SecureRandom</code>; C# has <code>System.Security.Cryptography.RNGCryptoServiceProvider</code>; Python has <code>os.urandom</code>), and in most cases it is as easy to use as a less secure option.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_auth_cookies_no_prng",
                      "warn": "yes",
                      "name": "Inappropriate PRNG in use",
                      "severity": "high",
                      "cond": "app_auth_cookies_prng_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does your application offer a \"log out\" button or link that, when clicked, not only terminates the session (deletes cookies from the client) but also invalidates the entire session ID?",
                      "defaultChoice": false,
                      "id": "app_auth_cookies_invalidation",
                      "choices": [
                        {"app_auth_cookies_invalidation_yes": "Yes"},
                        {"app_auth_cookies_invalidation_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Unless sessions are invalidated on logout, an attacker who has stolen a session ID will have access to the user's data until the session expires. Make sure all logout actions invalidate the session ID.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_auth_cookies_no_invalidation",
                      "warn": "yes",
                      "name": "No logout button",
                      "severity": "medium",
                      "cond": "app_auth_cookies_invalidation_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "6.5: Authorization",
                  "id": "block_authz",
                  "cond": "app_auth_requires_login || app_auth_admin_interface",
                  "items": [
                    {
                      "type": "info",
                      "text": "In most applications, certain information should only be accessible to certain users. For example, in most applications that require authentication, only the currently logged-in user should be able to change master data (such as the username, the associated email address, or the account password). When an application has data that should not be available to other users or should be restricted to certain roles, authorization must be enforced on the server side."
                    },
                    {
                      "type": "radiogroup",
                      "text": "<strong>Horizontal Access Control</strong>: Horizontal access control refers to isolation between users of the same role. For example, consider an application that allows users to access their payroll statements. The application must ensure that a user cannot access another user's statements; i.e., if the user's statement for the month of May is found at <code>statement.html?id=837<b>2</b>&month=5</code>, it shouldn't be possible to see someone else's pay stub simply by loading <code>statement.html?id=837<b>3</b>&month=5</code>.",
                      "defaultChoice": false,
                      "id": "app_authz_horizontal",
                      "choices": [
                        {"app_authz_horizontal_yes": "The project enforces these restrictions on the server side. We have processes in place to make sure nothing slips through the cracks."},
                        {"app_authz_horizontal_no": "It is possible that we missed checks like this in a few places."}
                      ]
                    },
                    {
                      "type": "box",
                      "text": "Describe the restrictions used on the server side to provide horizontal access control:",
                      "cond": "app_authz_horizontal_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_authz_horizontal_detail"
                    },
                    {
                      "type": "tip",
                      "text": "Applications must have controls in place that help protect all data from unauthorized access. We recommend that you thoroughly audit your code for vulnerabilities resulting from inadequate access control.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_authz_no_horizontal",
                      "warn": "yes",
                      "name": "Lack of horizontal access control",
                      "severity": "high",
                      "cond": "app_authz_horizontal_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "<strong>Vertical Access Control</strong>: When an application supports multiple roles, users should not be able to gain privileges or perform unauthorized actions by loading pages or features that should only be available to users in a different role. Throughout the project, have you ensured that users can perform only those actions that are appropriate for their roles?",
                      "defaultChoice": false,
                      "id": "app_authz_vertical",
                      "cond": "app_auth_roles",
                      "choices": [
                        {"app_authz_vertical_yes": "The project enforces these restrictions on the server side. We have processes in place to make sure nothing slips through the cracks."},
                        {"app_authz_vertical_no": "It is possible that we missed checks like this in a few places."}
                      ]
                    },
                    {
                      "type": "box",
                      "text": "Describe the techniques and restrictions used on the server side to provide vertical access control:",
                      "cond": "app_authz_vertical_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_authz_vertical_detail"
                    },
                    {
                      "type": "tip",
                      "text": "Applications must have controls in place that protect all functionality from unauthorized access. We recommend that you thoroughly audit your code for vulnerabilities resulting from inadequate access control.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "warn": "yes",
                      "name": "Lack of vertical access control",
                      "severity": "high",
                      "id": "warn_app_authz_no_vertical",
                      "cond": "app_authz_vertical_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "6.6: Authorization-Related Web Vulnerabilities",
                  "id": "block_authz_vulns",
                  "cond": "app_auth_requires_login || app_auth_admin_interface",
                  "items": [
                    {
                      "type": "block",
                      "text": "6.6.1: Cross Site Request Forgery",
                      "items": [
                        {
                          "type": "info",
                          "text": "<p>Applications must protect all state-changing actions against <a href='https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)'>cross-site request forgery</a> (XSRF). In this kind of attack, a malicious user forces the victim to send a request to the application, for example by luring the user to a page under the attacker's control. Because the browser automatically attaches available authentication cookies, the request will appear to be authorized if the user is logged in to the application.</p><p>For example, consider an online banking application that allows users to transfer money to another account. The URL for transfers might look something like this:</p><p><code>https://www.example.com/bank-transfer.html?dest_account=123456&amount=99.90&submit=true</code></p><p>If an attacker manages to lure the victim to a malicious site, the site could include HTML that causes such a request to be sent:</p><p><code>&lt;img src=\"https://www.example.com/bank-transfer.html?dest_account=666&amount=99.90& submit=true\"&gt;</code></p><p>If the user is logged in to the online banking portal, the application will receive that request and check for authentication cookies - which will be present, since the request was sent from the authorized user's browser.</p>"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Does the project protect all state-changing actions against XSRF?",
                          "defaultChoice": false,
                          "id": "app_authz_xsrf",
                          "choices": [
                            {"app_authz_xsrf_yes": "Yes, all state-changing actions are protected. We have a way to ensure that no actions are missed (such as enforcing XSRF-token checks in a central place)."},
                            {"app_authz_xsrf_no": "Some actions might not be protected against XSRF."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Web applications used to process private or confidential information should protect against XSRF. We recommend that you thoroughly audit your code for XSRF vulnerabilities, and put procedures in place so that future code is also protected.",
                          "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                          "id": "warn_app_authz_no_xsrf",
                          "warn": "yes",
                          "name": "Lack of CSRF protection",
                          "severity": "high",
                          "cond": "app_authz_xsrf_no"
                        },
                        {
                          "type": "radiogroup",
                          "text": "What strategy do you use to protect against XSRF?",
                          "defaultChoice": false,
                          "choices": [
                            {"app_authz_xsrf_token": "We protect requests that change the state with tokens that are bound to the user they were generated for, and that expire after a certain amount of time."},
                            {"app_authz_xsrf_header": "We use a custom fixed header that we add to requests."},
                            {"app_authz_xsrf_post": "The application does one of the following: verifies the referrer header; requires all state-changing actions to be POST requests; employs another mechanism to protect against XSRF."}
                          ],
                          "cond": "app_authz_xsrf_yes"
                        },
                        {
                          "type": "tip",
                          "text": "Various browser plugins (such as Flash and Java) have had security vulnerabilities that allowed an attacker to set arbitrary custom headers on cross-domain requests. We highly recommend the use of tokens instead of headers.",
                          "id": "tip_app_authz_xsrf_header",
                          "cond": "app_authz_xsrf_header"
                        },
                        {
                          "type": "tip",
                          "text": "Unfortunately, using POST requests does not protect against XSRF. Attackers can perform cross-domain POST requests by submitting a form with the appropriate <code>action</code> parameter, via JavaScript. Referrer checks are similarly ineffective because attackers can get around them through open redirects.",
                          "id": "warn_app_authz_xsrf_post",
                          "warn": "yes",
                          "name": "Inappropriate CSRF protection",
                          "severity": "high",
                          "why": "If you are using an alternative, effective method to protect against XSRF, describe it:",
                          "cond": "app_authz_xsrf_post"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "6.6.2: Cross-Site Script Inclusion",
                      "id": "block_xssi",
                      "items": [
                        {
                          "type": "checkgroup",
                          "text": "<p>Many web applications use AJAX to exchange data in the background, using a syntax that can be automatically interpreted as JavaScript by the user's browser. Unfortunately, this leads to <a href='http://capec.mitre.org/data/definitions/111.html'>cross-site script inclusion</a> (XSSI) vulnerabilities: the JavaScript can be included from a different origin, and any variables set at the other origin can be read.</p><p>For example, consider a contact management application that transmits the user's contacts in a JSON file (contacts.js):</p><p><code>var contacts = {\"name\": \"John Doe\", \"address\": \"jdoe%40example.com\", ... }</code></p><p>An attacker can include the following script from their own site, so that when the user visits the attacker's site while logged in to the contact management application, the attacker can read the variable <code>contacts</code> and get access to all of the victim's contact information.</p><p><code>&lt;script src=\"http://www.example.com/contacts.js\"&gt;&lt;/script&gt;</code></p><p>Do either of the following statements describe the project?</p>",
                          "defaultChoice": false,
                          "choices": [
                            {"app_authz_xssi_jsonp": "The project makes use of <a href='http://en.wikipedia.org/wiki/JSONP'>JSONP</a>."},
                            {"app_authz_xssi_other": "The project uses another format that sets variables or calls functions with non-public information."}
                          ]
                        },
                        {
                          "type": "radiogroup",
                          "text": "The project may be affected by XSSI, unless you specifically protect against this kind of attack.",
                          "defaultChoice": false,
                          "choices": [
                            {"app_authz_xssi_protections_yes": "We use one of the following mechanisms to protect against this kind of attack:<ul><li>Protect transmission of such data with an unguessable, unpredictable token (this token must fulfill the same requirements as those described for XSRF tokens above).</li><li>Require POST requests, so the data cannot be included in &lt;script&gt tags.</li></ul>"},
                            {"app_authz_xssi_protections_no": "It is possible that part of our web application is vulnerable to XSSI."}
                          ],
                          "cond": "app_authz_xssi_jsonp || app_authz_xssi_other",
                          "id": "app_authz_xssi_protections"
                        },
                        {
                          "type": "tip",
                          "text": "Web applications that transmit private information must be protected against XSSI, to prevent attackers from stealing the private data.",
                          "why": "If you are using an alternative, effective method to protect against XSSI, describe it:",
                          "id": "warn_app_authz_xssi_no_protection",
                          "warn": "yes",
                          "name": "Lack of XSSI protection",
                          "severity": "high",
                          "cond": "app_authz_xssi_protections_no"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "6.6.3: Clickjacking",
                      "id": "block_clickjacking",
                      "cond": "app_web_browser_yes || app_project_type_WebApp",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "<p>Depending on the nature of your application and the actions that can be taken in it, you may need to protect against <a href='https://www.owasp.org/index.php/Clickjacking'>clickjacking</a>.</p><p>If you do not typically need to frame web pages, your application should use the <a href='https://developer.mozilla.org/en/the_x-frame-options_response_header'>X-Frame-Options response header</a> to tell the browser not to render any page that is framed from a different origin:</p><p><code>X-Frame-Options: SAMEORIGIN</code></p>",
                          "defaultChoice": false,
                          "choices": [
                            {"app_authz_clickjacking_protected": "The project employs protections against clickjacking (such as using the <code>X-Frame-Options</code> header)."},
                            {"app_authz_clickjacking_notprotected": "The project does not have such protections."},
                            {"app_authz_clickjacking_na": "Not applicable, product does not provide browser content."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Clickjacking is difficult to address. But in high-risk applications, clickjacking protection is essential.",
                          "why": "Explain why you consider clickjacking protection unnecessary:",
                          "id": "tip_app_authz_clickjacking_notprotected",
                          "cond": "app_authz_clickjacking_notprotected"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "6.7: API Authorization",
                  "cond": "app_auth_api",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "What service is used for providing APIs?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_auth_api_aws": "Amazon Web Services (AWS)"},
                        {"app_auth_api_cognito": "AWS Cognito"},
                        {"app_auth_api_apigee": "Apigee"},
                        {"app_auth_api_other": "Other"}
                      ]
                    },
                    {
                      "type": "checkgroup",
                      "text": "What AWS services are used for providing API authentication?",
                      "defaultChoice": false,
                      "cond": "app_auth_api_aws",
                      "choices": [
                        {"app_auth_api_aws_api_gateway": "AWS API Gateway with Lambda functions"},
                        {"app_auth_api_aws_access_key": "AWS Access Key ID"},
                        {"app_auth_api_aws_header": "Authorization Header"},
                        {"app_auth_api_aws_query": "Query Parameter"},
                        {"app_auth_api_aws_cognito": "Cognito"},
                        {"app_auth_api_aws_other": "Other"}
                      ]
                    },
                    {
                      "type": "box",
                      "text": "What other mechanisms are used for providing API authentication?  Explain what services are used.  Describe mechanisms used for authentication, like whether tokens are used.",
                      "id": "app_auth_api_other_detail",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "app_auth_api_other || app_auth_api_aws_other"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Briefly explain how API authorization works.  For example, if tokens are used explain how the tokens are generated and how the client gets the token.",
                      "id": "app_auth_api_detail"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain what kind of users authenticate to the system.  Are they associated with individuals or clients?",
                      "id": "app_auth_api_users"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Do all users have the same access?  If different users have different access (e.g. via roles), please provide details and explain how role assignment happens and where roles are stored (e.g. Active Directory, in a project controled data store like a database or somewhere else):",
                      "id": "app_auth_api_user_access"
                    },
                    {
                      "type": "tip",
                      "text": "When using Amazon, it is recommended to use the API Gateway with Lambda functions.  Refer to the <a href=\"http://docs.aws.amazon.com/apigateway/latest/developerguide/use-custom-authorizer.html\">Amazon API Gateway Developer Guide</a>.",
                      "id": "warn_app_auth_api_aws_api_gateway",
                      "name": "Not using API Gateway",
                      "cond": "app_auth_api_aws && !app_auth_api_aws_api_gateway && !app_auth_api_aws_cognito",
                      "why": "Explain why the API Gateway with Lambda functions design is not being used:",
                      "warn": "yes",
                      "severity": "high"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "7: Privileged User Accounts",
              "cond": "app_auth_yes",
              "items": [
                {
                  "type": "radiogroup",
                  "text": "Privileged user accounts are accounts that have elevated access compared to a normal user.  For example, a \"root\" user or a user that has access to a resource like a database.  Does the project make use of any privileged user accounts?",
                  "defaultChoice": false,
                  "id": "app_privileged_user",
                  "choices": [
                    {"app_privileged_user_yes": "Yes"},
                    {"app_privileged_user_no": "No"}
                  ]
                },
                {
                  "type": "box",
                  "text": "List privileged accounts and their purpose:",
                  "id": "app_privileged_user_explain",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "cond": "app_privileged_user_yes"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Explain how privileged user accounts make use of the principle of least privilege and need-to-know:",
                  "id": "app_privileged_user_least_privilege",
                  "cond": "app_privileged_user_yes"
                },
                {
                  "type": "radiogroup",
                  "text": "A generic account is an account that can be used by more than one person.  Does the project make use of any generic accounts?",
                  "defaultChoice": false,
                  "id": "app_generic_accounts",
                  "choices": [
                    {"app_generic_accounts_yes": "Yes"},
                    {"app_generic_accounts_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Generic accounts must have a clearly defined owner that is responsible for all operations that occur when using the accounts.  Passwords for generic accounts must be protected in accordance with [ORGANIZATION_NAME]'s password use policy and must not be used by any individuals, only by application or system processes.",
                  "id": "warn_app_generic_accounts_apps_only",
                  "why": "Explain the purpose of the generic account and why it is needed?  Explain why a firecall ID should not be used instead:",
                  "severity": "medium",
                  "name": "Generic passwords for applications only",
                  "cond": "app_generic_accounts_yes"
                },
                {
                  "type": "radiogroup",
                  "text": "Are passwords of generic accounts rotated once per year and when an employee knowing the password leaves [ORGANIZATION_NAME] or changes roles?",
                  "defaultChoice": false,
                  "cond": "app_generic_accounts_yes",
                  "id": "app_generic_accounts_rotated",
                  "choices": [
                    {"app_generic_accounts_rotated_yes": "Yes"},
                    {"app_generic_accounts_rotated_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Passwords for generic accounts must be rotated at least once per year or when an employee knowing the password leaves [ORGANIZATION_NAME] or changes roles.",
                  "id": "warn_app_generic_accounts_not_rotated",
                  "warn": "yes",
                  "name": "Not rotating generic passwords",
                  "severity": "high",
                  "cond": "app_generic_accounts_rotated_no"
                }
              ]
            },
            {
              "type": "block",
              "text": "8: Cryptography, Certificates, Keys, Passwords and Other Secrets",
              "id": "block_secrets",
              "items": [
                {
                  "type": "block",
                  "text": "8.1: Introduction",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Does the project make use of secrets like certificates, passwords, or keys?",
                      "id": "app_secret",
                      "choices": [
                        {"app_secret_yes": "Yes"},
                        {"app_secret_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the project use a service for storing secrets?",
                      "id": "app_secret_service",
                      "cond": "app_secret_yes",
                      "choices": [
                        {"app_secret_service_yes": "Yes"},
                        {"app_secret_service_no": "No"}
                      ]
                    },
                    {
                      "type": "checkgroup",
                      "text": "What services are used for storing secrets?",
                      "defaultChoice": false,
                      "cond": "app_secret_service_yes",
                      "choices": [
                        {"app_secret_aws": "AWS services"},
                        {"app_secret_secret_server": "Secret Server ([ORGANIZATION_VAULT_LABEL])"},
                        {"app_secret_wcm": "Windows Credential Manager"},
                        {"app_secret_other": "Other"},
                        {"app_secret_none": "Not using a secure storage service"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "What other mechanisms are used for storing secrets?",
                      "id": "app_secret_other_detail",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "app_secret_other"
                    },
                    {
                      "type": "tip",
                      "text": "A secure service should be used for storing secrets.",
                      "id": "warn_app_secret_service",
                      "why": "Explain why you are not using a secure service to store secrets.  What mechanisms provide such security?",
                      "warn": "yes",
                      "name": "A secure service for storing secrets is not used",
                      "severity": "high",
                      "cond": "app_secret_service_no"
                    },
                    {
                      "type": "box",
                      "text": "List and explain the purpose of each certificate, key, password or other secret.  Explain how these are protected:",
                      "cond": "app_secret_yes",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "id": "app_secret_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are any secrets stored in the source code?",
                      "id": "app_secret_in_source",
                      "cond": "app_secret_yes",
                      "choices": [
                        {"app_secret_in_source_yes": "Yes"},
                        {"app_secret_in_source_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "It is not acceptable for secrets to be stored in the source code.  A secure service should be used instead",
                      "id": "warn_app_secret_in_source",
                      "why": "Explain why you are storing secrets in source code:",
                      "warn": "yes",
                      "name": "Secrets in Source Code",
                      "severity": "high",
                      "cond": "app_secret_in_source_yes"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are any passwords or secrets stored on file storage systems?",
                      "id": "app_secret_disk",
                      "cond": "app_secret_yes",
                      "choices": [
                        {"app_secret_disk_yes": "Yes"},
                        {"app_secret_disk_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are passwords and secrets stored using approved encryption?",
                      "id": "app_secret_disk_encryption",
                      "cond": "app_secret_disk_yes",
                      "choices": [
                        {"app_secret_disk_encryption_yes": "Yes"},
                        {"app_secret_disk_encryption_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Passwords and secrets stored on disk must be encrypted.",
                      "id": "warn_app_secret_disk_encryption",
                      "why": "Explain why you are storing passwords and secrets without using encryption:",
                      "warn": "yes",
                      "name": "Secrets without Encryption",
                      "severity": "high",
                      "cond": "app_secret_disk_encryption_no"
                    },
                    {
                      "type": "box",
                      "text": "Please explain how secrets are rotated",
                      "id": "app_secret_aws_rotation",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "app_secret_yes"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "8.2: AWS Services",
                  "cond": "app_secret_aws",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "What AWS services are used for storing secrets?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_secret_aws_kms": "AWS <a href=\"https://aws.amazon.com/kms\">KMS</a>"},
                        {"app_secret_aws_cloudhsm": "AWS <a href=\"https://aws.amazon.com/cloudhsm/\">CloudHSM</a>"},
                        {"app_secret_aws_parameter_store": "AWS <a href=\"https://aws.amazon.com/ec2/systems-manager/parameter-store/\">Parameter Store</a>"},
                        {"app_secret_aws_other": "Other AWS services"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "What other AWS mechanisms are used for storing secrets?",
                      "id": "app_secret_aws_other_detail",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "app_secret_aws_other"
                    },
                    {
                      "type": "checkgroup",
                      "text": "What types of keys are stored in KMS?",
                      "cond": "app_secret_aws_kms",
                      "defaultChoice": false,
                      "choices": [
                        {"app_secret_aws_kms_default": "Default master keys that are automatically rotated"},
                        {"app_secret_aws_kms_import": "Keys imported into KMS"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "It is not advisable to import keys into KMS since they must be rotated manually.",
                      "id": "warn_app_secret_aws_kms_import",
                      "why": "Explain why you are import keys into KMS:",
                      "warn": "yes",
                      "name": "Importing keys into KMS",
                      "severity": "high",
                      "cond": "app_secret_aws_kms_import"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Parameter Store making use of KMS?",
                      "id": "app_secret_aws_parameter_store_kms",
                      "cond": "app_secret_aws_parameter_store",
                      "choices": [
                        {"app_secret_aws_parameter_store_kms_yes": "Yes"},
                        {"app_secret_aws_parameter_store_kms_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Parameter Store should be integrated with KMS for encryption support.  Refer to the <a href=\"http://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-paramstore-access.html\">Amazon EC2 Systems Manager User Guide</a>.",
                      "id": "warn_app_secret_aws_parameter_store_kms",
                      "why": "Explain why you are using Parameter Store without KMS integration:",
                      "warn": "yes",
                      "name": "Secrets without Encryption",
                      "severity": "high",
                      "cond": "app_secret_aws_parameter_store_kms_no"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "9: Common Web Vulnerabilities",
              "id": "block_common_vulns",
              "cond": "app_web_browser_yes || app_project_type_WebApp || app_project_type_WebServices",
              "items": [
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Describe what security coding practices have been considered with this project and what has been done to address common concerns (e.g. OWASP Top 10).",
                  "id": "app_secure_coding_practices"
                },
                {
                  "type": "checkgroup",
                  "text": "Certain features can result in security issues, if used incorrectly. To help us identify potential issues, select the statements that describe your application:",
                  "defaultChoice": false,
                  "choices": [
                    {"app_webvuln_db": "The application uses a database back end, or any other persistence back end that can be queried with SQL or a related language (e.g., GQL, FQL, SOQL, etc.)."},
                    {"app_webvuln_plugin": "The application requires a plugin, such as Java, Flash, Silverlight, etc."},
                    {"app_webvuln_3rdpartycontent": "The application loads active content, such as scripts, applets, or style sheets, from third-party servers (i.e., any server that is not under your direct control)."},
                    {"app_webvuln_xml": "The application processes or manipulates user-provided XML."},
                    {"app_webvuln_not_defined": "None of the above"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "<p>Loading content from other sites is dangerous under certain circumstances; security issues in the other sites might also affect the security of your application. Scripts, for example, have full access to the DOM of the site on which they are included - so if one of the servers that hosts your third-party JavaScript gets compromised, the attacker also gains access to all of your users' data, simply by injecting a bit of code.</p><p>Unless you trust the third party completely (not only to not do something malicious, but also to be secure enough to adequately protect their infrastructure against attackers), it is best not to load scripts or style sheets (e.g., via <code>&lt;script src=...&gt;</code> or <code>&lt;style src=...&gt;</code>) from third-party sites.</p><p>Similarly (although to a lesser extent), directly embedding videos, frames, or images (including advertisements, tracking pixels, etc.) from third-party sources can be dangerous. Loading such a resource can leak information to the site it is loaded from (e.g., through the referrer). This can be a privacy issue as well as a security issue.</p>",
                  "why": "If your application loads third-party content, describe your threat model:",
                  "id": "warn_app_3rdparty_content",
                  "warn": "yes",
                  "name": "Application includes active 3rd party content",
                  "severity": "medium",
                  "cond": "app_webvuln_3rdpartycontent"
                },
                {
                  "type": "tip",
                  "text": "Dealing with user-provided and untrusted XML may make your application vulnerable to attacks. For example, the expat XML parser (written in C) has been found vulnerable to buffer overflow attacks. Even if you use a secure parser (or run it in a sandbox), things that can go wrong.<p>Various attacks rely on the attacker's ability to specify XML entities. Entities are \"codes\" (such as <code>&amp;quot;</code>) that are translated into defined strings by the parser. HTML has a predefined set of entities, but in XML, entities can be specified arbitrarily. An entity specification usually looks like this:<p><code>&lt;!ENTITY ent \"Hello!\"&gt;</code><p>With this definition, whenever the parser comes across <code>&amp;ent;</code>, it will replace it with <code>Hello!</code>. Entities are usually defined in the document type, which can be provided in a separate file or in the <code>&lt;!DOCTYPE&gt;</code> section at the beginning of an XML document.Entities are used in a variety of XML-related attacks. For example, they can be used for something called the <a href='http://www.ibm.com/developerworks/xml/library/x-tipcfsx/index.html'>billion laughs attack</a>, where an entity resolves to other entities, which resolve to other entities, etc., causing high memory usage and essentially resulting in a denial-of-service attack.<p>Even more serious is an attack using <a href='http://www.securiteam.com/securitynews/6D0100A5PU.html'>external entities</a>. Definitions of external entities look similar to regular entity definitions, but they reference local files or URLs. Unless the XML parser has been specifically instructed not to expand external entities, a definition like <code>&lt;!ENTITY etc SYSTEM \"file:///etc/passwd\"&gt;</code> would include the /etc/passwd file where the entity &amp;etc; occurs in the XML document, leading to the disclosure of files as well as internal URLs.It is very important to restrict entity specification in user-provided or untrusted XML. Make sure your parser is adequately configured.",
                  "warn": "yes",
                  "name": "User provided XML processed/manipulated",
                  "severity": "medium",
                  "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                  "id": "warn_app_webvuln_xml_entities",
                  "cond": "app_webvuln_xml"
                },
                {
                  "type": "line",
                  "text": "Please explain how the application loads content and UI elements:",
                  "id": "info_app_webvuln_not_defined",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_webvuln_not_defined"
                },
                {
                  "type": "block",
                  "text": "9.1: Cross-Site Scripting",
                  "id": "block_xss",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "<a href='https://www.owasp.org/index.php/XSS'>Cross-site scripting</a> (or XSS for short) occurs when an application redisplays insufficiently sanitized user input in the context of the application's origin (as defined by the <a href='http://code.google.com/p/browsersec/wiki/Part2#Same-origin_policy'>same-origin policy</a>). If the user input contains certain kinds of scripting code, it may read or alter the DOM of the current page when redisplayed. In many cases, XSS is used to steal users' cookies or other application-related data, but it may also be used for phishing attacks, or even to deface the web page. Unfortunately, XSS is one of the most common security issues in web applications, and due to browser quirks and other factors, quite hard to protect against. Select the statements that describe your strategy:",
                      "defaultChoice": false,
                      "choices": [
                        {"app_xss_templating": "We use a templating system that automatically escapes all user input before redisplaying it."},
                        {"app_xss_chokepoint": "The project has a central choke point where all user input is validated and escaped, depending on the context in which it will be interpreted."},
                        {"app_xss_perpage": "Some of the pages (or all of them) escape user input."},
                        {"app_xss_other": "We are using some other technique to protect against XSS."},
                        {"app_xss_sanitization": "Part of the application deals with user-provided HTML that is sanitized and re-displayed to the user."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "You didn't select a strategy for protecting against cross-site scripting.",
                      "why": "Explain why:",
                      "warn": "yes",
                      "id": "warn_app_no_xss_strategy",
                      "cond": "!app_xss_templating && !app_xss_chokepoint && !app_xss_perpage && !app_xss_other && !app_xss_sanitization"
                    },
                    {
                      "type": "tip",
                      "text": "Using a templating system to escape user input is a good way to protect against XSS. But be careful with directives that disable automatic escaping, and watch for the direct display of user input (for example, in error messages). Additionally, be aware of the context in which user input is used in templates. Not all templating systems automatically understand that different escaping may be required, depending on where in the application the user input is displayed. For example, many templating systems would not correctly escape a construct such as <code>&gt;a href=\"\"&lt;</code>, where a user could supply <code>javascript:alert(/xss/)</code> as user_input. We recommend using a context-sensitive templating system.",
                      "id": "tip_app_xss_templating",
                      "cond": "app_xss_templating"
                    },
                    {
                      "type": "tip",
                      "text": "A central choke point for validating and escaping user input is generally a good way to protect against XSS. But make sure your application identifies the context in which the user input is being used; otherwise, it might still be possible to smuggle in JavaScript through user input. You might also want to consider using a context-sensitive templating system, to address this issue automatically.",
                      "id": "tip_app_xss_chokepoint",
                      "cond": "app_xss_chokepoint"
                    },
                    {
                      "type": "tip",
                      "text": "<p>Escaping user input on each page individually is a fairly dangerous strategy: it is very easy to miss something. We recommend using a templating system that automatically escapes user input, ideally in a context-sensitive fashion. Some examples are listed below. Note that not all of these are context-sensitive, so you may still need to do manual escaping (or explicitly tag a variable in the template) when the context is something other than HTML.</p><ul><li><a href='https://www.djangoproject.com/'>Django</a> (Python)</li><li><a href='http://code.google.com/p/ctemplate/?redir=1'>Google CTemplates</a> (C++)</li><li><a href='http://code.google.com/p/jsilver/'>Jsilver</a> (Java)</li><li><a href='https://developers.google.com/closure/templates/'>Closure/Soy</a> (JavaScript, Java)</li><li><a href='http://jquery.com/'>JQuery</a> (JavaScript)</li><li><a href='http://www.smarty.net/'>Smarty</a> (PHP)</li>",
                      "warn": "yes",
                      "name": "Inappropriate XSS protection",
                      "severity": "medium",
                      "id": "warn_app_xss_perpage",
                      "cond": "!app_xss_templating && !app_xss_chokepoint && app_xss_perpage"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Describe your strategy for protecting against XSS vulnerabilities:",
                      "id": "app_xss_other_explanation",
                      "cond": "app_xss_other"
                    },
                    {
                      "type": "tip",
                      "text": "Unfortunately, due to error-correcting behavior and browser quirks, getting HTML sanitization right is very difficult. The sanitization code has to build an in-memory representation of the DOM, and then serialize that to a known-safe format. Some libraries do this correctly, so we highly recommended using a well-tested library.",
                      "why": "Describe how your application deals with HTML sanitization:",
                      "warn": "yes",
                      "name": "Dangerous HTML sanitization",
                      "severity": "medium",
                      "id": "warn_app_xss_sanitization",
                      "cond": "app_xss_sanitization"
                    },
                    {
                      "type": "radiogroup",
                      "text": "In addition to applying the strategies you have identified, does the application set a valid and appropriate content type and character set for each page (in the <code>Content-Type</code> HTTP header)?",
                      "defaultChoice": false,
                      "id": "app_xss_content_type",
                      "choices": [
                        {"app_xss_content_type_yes": "Yes, we take great care to set this, knowing that otherwise we might be introducing XSS vulnerabilities."},
                        {"app_xss_content_type_no": "I am not sure all pages set an appropriate content type."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Not setting both a content type and a character set often leads to cross-site scripting vulnerabilities. For example, if the application outputs JSON but sets the content type to text/html, this might result in XSS because JavaScript/JSON escaping is different from HTML escaping. We recommend that you thoroughly audit your code for pages that do not set the content type correctly.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "warn": "yes",
                      "name": "Inappropriate content type/character set",
                      "severity": "medium",
                      "id": "warn_app_xss_content_type",
                      "cond": "app_xss_content_type_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Earlier, you noted that the application has a file upload feature. Does the application allow other users (or administrators) to access the files that are uploaded?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_xss_fileupload_yes": "Yes, this is a feature of the project."},
                        {"app_xss_fileupload_no": "No; uploaded files are processed but can't be downloaded again."}
                      ],
                      "cond": "app_upload_yes",
                      "id": "app_xss_fileupload"
                    },
                    {
                      "type": "tip",
                      "text": "Hosting and serving user-provided content is almost guaranteed to introduce XSS vulnerabilities. Because of various browser quirks, countermeasures (such as setting a <code>Content-Disposition: attachment</code> header) do not provide full protection. We recommend serving user-provided content on a domain separate from all domains that have authentication cookies. However, this approach introduces another problem, if access to the content is intended to be authenticated. You can solve this by using short-lived random tokens, or by serving each document from a separate domain. If you use the latter approach, each domain should have a unique set of authentication cookies, valid only for the one document that is served from the domain.",
                      "why": "Describe your strategy for protecting against XSS vulnerabilities introduced by serving user-provided content:",
                      "warn": "yes",
                      "name": "Potential XSS via uploaded file access",
                      "severity": "medium",
                      "id": "warn_app_xss_fileupload",
                      "cond": "app_xss_fileupload_yes"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Some XSS vulnerabilities work exclusively on the client side, in an application's scripting code. This kind of XSS is commonly referred to as <a href='https://www.owasp.org/index.php/DOM_Based_XSS'>DOM-based XSS</a>. Because server-side escaping of user input does not protect against DOM-based XSS, you need a strategy for dealing with client-side scripting code that handles user input, as well as parts of the DOM that may contain user input (such as document.location).",
                      "defaultChoice": false,
                      "id": "app_xss_dombased",
                      "choices": [
                        {"app_xss_dombased_yes": "We know about DOM-based XSS, and we take specific steps to protect against this kind of vulnerability."},
                        {"app_xss_dombased_no": "It may be possible that something slipped through the cracks and the project has DOM-based XSS vulnerabilities."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "We recommend that you thoroughly audit your code for DOM-based XSS vulnerabilities, and put procedures in place so that future code is also protected.",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "warn": "yes",
                      "name": "Lack of protection against DOM-based XSS",
                      "severity": "medium",
                      "id": "warn_app_xss_dombased",
                      "cond": "app_xss_dombased_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "9.2: Persistence Back Ends and Querying",
                  "cond": "app_webvuln_db",
                  "id": "block_app_db",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "<p>Because your application uses a database or a similar back end to persist data, we need to make sure it is not vulnerable to injection attacks, such as <a href='http://en.wikipedia.org/wiki/SQL_injection'>SQL injection</a>.</p><p>An application is vulnerable to SQL injection when some portion of user input is interpreted by the database as part of a query. When this occurs, an attacker may be able to read or even write data directly from or to the database.</p>",
                      "defaultChoice": false,
                      "choices": [
                        {"app_sqli_orm": "The project uses an object-relational mapping (ORM) framework. When we need to manually construct queries or conditions, we use one of the mechanisms selected below:"},
                        {"app_sqli_prepared": "We use prepared statements and let the framework take care of correctly escaping the user input."},
                        {"app_sqli_stored": "We pass user input to the database via stored procedures."},
                        {"app_sqli_manual": "We manually escape user input whenever we need to use it in a database query."},
                        {"app_sqli_other": "We do something else."}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Describe the other mechanism you are using to protect against SQL injection:",
                      "id": "app_sqli_other_details",
                      "cond": "app_sqli_other"
                    },
                    {
                      "type": "tip",
                      "text": "Using an ORM layer is generally a good way to protect against SQL injection. However, in most ORM frameworks, it is possible to directly specify parts of the SQL query. Some ORM frameworks also have a special querying language that makes it possible to set the <code>WHERE</code> part of the statement. In these cases, you still need to be sure to guard against injection vulnerabilities.",
                      "id": "tip_app_sqli_orm",
                      "cond": "app_sqli_orm"
                    },
                    {
                      "type": "line",
                      "text": "What ORM framework are you using?",
                      "id": "app_sqli_orm_which",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "app_sqli_orm"
                    },
                    {
                      "type": "tip",
                      "text": "Using stored procedures is generally a good way to protect against SQL injection. But this strategy must be used consistently. Make sure neither the stored procedures themselves nor the calls of the stored procedures are vulnerable to injection attacks.",
                      "id": "tip_app_sqli_stored",
                      "cond": "app_sqli_stored"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do you take special steps (policies, code reviews, audits, etc.) to ensure that prepared statements are used consistently, and that string concatenation is never used to construct database queries?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_sqli_prepared_consistent_yes": "Yes, we have all or most of these measures in place, and we are very confident that there are no SQL injection vulnerabilities in our code."},
                        {"app_sqli_prepared_consistent_no": "We try to make our developers use prepared statements, but it may be possible for some string concatenation to slip through."}
                      ],
                      "cond": "app_sqli_prepared && !app_sqli_manual",
                      "id": "app_sqli_prepared_consistent"
                    },
                    {
                      "type": "tip",
                      "text": "<p>Manually escaping SQL (or related) queries is error-prone and very difficult to do consistently. Here are a couple of examples:</p><ul><li>PHP provides the function <code>mysql_escape_string</code> for escaping user input that will be used in a database query. Unfortunately, that function does not take into account the character set of the connection, so it may still be possible to smuggle in user input that will be interpreted as part of the SQL query. Applications should use <code>mysql_real_escape_string</code> instead.</li><li>In SQL, numbers do not need to be surrounded with quotation marks when used in a statement. For example, <code>SELECT username WHERE id=123</code> is perfectly valid. But if user-provided input that will be used as a number is not confirmed to be actually numeric, the resulting code will be vulnerable to SQL injection (even if the input is escaped).</li></ul><p>We highly recommend using something like prepared statements, or using an ORM layer consistently throughout the application. Make sure you have procedures in place to enforce your approach (such as static tests when code is checked into the repository).</p>",
                      "warn": "yes",
                      "name": "Inadequate SQL injection protection",
                      "severity": "medium",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_sqli_manual",
                      "cond": "app_sqli_prepared_consistent_no || app_sqli_manual"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "9.3: Browser Plugins",
                  "cond": "app_webvuln_plugin",
                  "id": "block_plugins",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "You mentioned that your application requires certain browser plugins to work correctly. Which of the following plugins are required?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_plugin_java": "Java"},
                        {"app_plugin_flash": "Flash"},
                        {"app_plugin_silverlight": "Silverlight"},
                        {"app_plugin_other": "Other"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "What other plugins are required by your application?",
                      "id": "app_plugin_other_which",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "app_plugin_other"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain what the plugin is used for, what technology it uses (e.g., ActiveX, NPAPI, Chrome plugin, etc.), how it is usually deployed to your users, and what privileges it requires:",
                      "id": "app_plugin_other_desc",
                      "cond": "app_plugin_other"
                    },
                    {
                      "type": "tip",
                      "text": "Enabling Java in the browser exposes users to a variety of security issues. We strongly discourage requiring Java.",
                      "warn": "yes",
                      "name": "Java plugin required by application",
                      "severity": "medium",
                      "why": "Is Java absolutely necessary for your application to function correctly? Are there any workarounds?",
                      "id": "warn_app_plugin_java",
                      "cond": "app_plugin_java"
                    },
                    {
                      "type": "tip",
                      "text": "In most cases, custom plugins are considered a security risk. Plugins can operate outside of the usual constraints (such as a same-origin policy, sandboxing, etc.) and can introduce security vulnerabilities that affect the entire browser. It is also often difficult to deploy and centrally manage them. We strongly discourage using custom plugins.",
                      "warn": "yes",
                      "name": "Custom plugin required by application",
                      "severity": "high",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                      "id": "warn_app_plugin_other",
                      "cond": "app_plugin_other"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "10: File Uploads",
              "cond": "app_upload_yes",
              "id": "block_uploads",
              "items": [
                {
                  "type": "checkgroup",
                  "text": "Where does the application store uploaded files?",
                  "defaultChoice": false,
                  "choices": [
                    {"app_upload_storage_fs": "On the file system"},
                    {"app_upload_storage_db": "In a database"},
                    {"app_upload_storage_memory": "Not stored anywhere, processed only in memory"},
                    {"app_upload_storage_other": "Somewhere else"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Explain where the uploaded files are stored:",
                  "id": "app_upload_storage_other_expl",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_upload_storage_other"
                },
                {
                  "type": "tip",
                  "text": "Storing uploaded files on the file system can be dangerous. Here are a few issues that can occur:<p><ul><li><b>Path traversal</b>: The names of uploaded files must be carefully sanitized to prevent attackers from uploading files with paths in the name, such as <code>../../../../some_existing_file.html</code>. Files like these can end up in the wrong directory.</li><li><b>Null bytes</b>: The names of uploaded files must be examined for null bytes, which can cause file names to be truncated (e.g., a file called <code>evilfile.exe[0x00].gif</code> might become <code>evilfile.exe</code> when stored on disk).</li><li><b>Interpretation</b>: Files on the file system are much more likely to end up being interpreted. For example, if an attacker manages to store an uploaded file somewhere underneath the web root and names it <code>evilfile.php</code>, it might be executed as PHP code by the web server.</li></ul><p>To prevent issues like these, store user-uploaded content in a database instead. If your application stores files on the file system, be sure to implement careful handling, validation, and sanitization of uploaded files.",
                  "warn": "yes",
                  "name": "Dangerous way of storing uploaded files",
                  "severity": "medium",
                  "id": "warn_app_upload_fs",
                  "cond": "app_upload_storage_fs"
                },
                {
                  "type": "line",
                  "text": "What file types are expected?",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_upload_file_types"
                },
                {
                  "type": "radiogroup",
                  "text": "Are file types supported that support running user-provided code?  For example, macros in Microsoft Office documents?",
                  "defaultChoice": false,
                  "choices": [
                    {"app_upload_macros_yes": "Yes"},
                    {"app_upload_macros_no": "No"}
                  ],
                  "id": "app_upload_macros"
                },
                {
                  "type": "radiogroup",
                  "text": "Do we disallow or remove user-provided code like macros from files?",
                  "defaultChoice": false,
                  "choices": [
                    {"app_upload_macro_protection_yes": "Yes"},
                    {"app_upload_macro_protection_no": "No"}
                  ],
                  "cond": "app_upload_macros_yes",
                  "id": "app_upload_macro_protection"
                },
                {
                  "type": "tip",
                  "text": "It is best to avoid supporting macros.  Please consider following <a href=\"https://www.owasp.org/index.php/Protect_FileUpload_Against_Malicious_File\">OWASP File Upload Best Practices</a> to identify and disable macros.",
                  "warn": "yes",
                  "name": "Custom plugin required by application",
                  "severity": "high",
                  "why": "Please explain why you support macros.  Is supporting them necessary?",
                  "id": "warn_app_macro_protection_detail",
                  "cond": "app_upload_macro_protection_no"
                },
                {
                  "type": "checkgroup",
                  "text": "How does the application enforce security controls?",
                  "defaultChoice": false,
                  "choices": [
                    {"app_upload_type_extension": "We verify the file type by checking the file extension on the server side."},
                    {"app_upload_type_contenttype": "We look at the file to confirm it is the expected file type."},
                    {"app_upload_type_reencoding": "We decode and re-encode the file, storing only the result."},
                    {"app_upload_type_whitelist": "We whitelist expected file types."},
                    {"app_upload_type_blacklist": "We blacklist file types that are not expected."},
                    {"app_upload_type_filesize": "We limit the maximum filesize to a reasonable amount."},
                    {"app_upload_type_other": "We employ other methods to provide security."}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Some web servers are configured by default to allow double file extensions. For example, if a user uploads a file called <code>malicious.php.gif</code>, it might actually be executed as PHP code upon retrieval. Because you store uploaded files on the file system, this issue may affect your application. Make sure your web server uses only the last extension (i.e., the part after the right-most dot in the file name) when determining how to process the file.",
                  "warn": "yes",
                  "name": "Inadequate method of file type verification",
                  "severity": "medium",
                  "id": "warn_app_upload_doubleextension",
                  "cond": "app_upload_type_extension && app_upload_storage_fs"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Explain other controls that are in place:",
                  "id": "app_upload_type_other_detail",
                  "cond": "app_upload_type_other"
                },
                {
                  "type": "line",
                  "text": "What filetypes are whitelisted?",
                  "id": "app_upload_type_whitelist_detail",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_upload_type_whitelist"
                },
                {
                  "type": "line",
                  "text": "What filetypes are blacklisted?",
                  "id": "app_upload_type_blacklist_detail",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "cond": "app_upload_type_blacklist"
                },
                {
                  "type": "tip",
                  "text": "Re-encoding files uploaded by users is usually a very good approach. However, note that because the decoding and re-encoding works on untrusted user input (and because parsing is difficult and error-prone), it is best to perform these operations in a sandbox. That way, even if an attacker successfully exploits a vulnerability in the parser, the effects would be constrained to the sandboxed environment. Various sandboxing APIs are available, such as the <a href='http://sourceforge.net/projects/libseccomp/'>Seccomp library</a> for Linux.<p>You could also run the decoder/encoder on an isolated virtual machine that is regularly reset to a predefined state. Note, however, that a successful attacker would still be able to observe all incoming and outgoing files, unless the reset happens after each individual file operation.<p>Even with a sandboxed encoder, some attacker-provided content may survive the re-encoding. For example, in images, the EXIF metadata may be left intact. If this occurs and the content type is incorrectly set (or browser content-sniffing behavior kicks in), cross-site scripting vulnerabilities can result.",
                  "warn": "yes",
                  "name": "Inadequate method of file type verification",
                  "severity": "medium",
                  "why": "Describe the steps you are taking to protect against vulnerabilities in the decoding and parsing code:",
                  "id": "warn_app_upload_reencoding",
                  "cond": "app_upload_type_reencoding"
                },
                {
                  "type": "tip",
                  "text": "Unfortunately, verifying the content type of uploaded files is generally not sufficient for enforcing a whitelist. Because the content type is a field in the HTTP request sent by the user, it can be arbitrarily set by an attacker (for example, by using an interception proxy). At a minimum, the application should also verify the extension at the very end of the file name and check it against the whitelist.",
                  "warn": "yes",
                  "name": "Inadequate method of file type verification",
                  "severity": "high",
                  "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                  "id": "warn_app_upload_contenttypeonly",
                  "cond": "app_upload_type_contenttype && !app_upload_type_reencoding && !app_upload_type_extension"
                },
                {
                  "type": "radiogroup",
                  "text": "Are uploads scanned for viruses?",
                  "defaultChoice": false,
                  "id": "app_upload_virus_protection",
                  "choices": [
                    {"app_upload_virus_protection_yes": "Yes"},
                    {"app_upload_virus_protection_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "All files uploaded and stored should be checked for viruses.",
                  "warn": "yes",
                  "name": "Lack of virus protection on uploads",
                  "severity": "high",
                  "why": "Explain why virus protection is not used and what other controls may be3 in place:",
                  "id": "warn_app_upload_virus_protection",
                  "cond": "app_upload_virus_protection_no"
                }
              ]
            },
            {
              "type": "block",
              "text": "11: Storage",
              "id": "block_storage",
              "cond": "app_db_yes || app_disk_yes || app_aws_db",
              "items": [
                {
                  "type": "block",
                  "text": "11.1: Disk Storage",
                  "id": "block_disk_storage",
                  "cond": "app_disk_yes",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "What types of storage is used by this project?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_info_storage_aws": "AWS Storage"},
                        {"app_info_storage_shared_disks": "Shared Disks or a Storage Area Network (SAN)"},
                        {"app_info_storage_other": "Other"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "Describe additional types of storage used:",
                      "cond": "app_info_storage_other",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "id": "app_lang_storage_other_detail"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain the storage access control used:",
                      "id": "app_info_storage_access_control"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain how permissions are setup to ensure that data access is limited to meet the principle of least privilege:",
                      "id": "app_info_storage_least_privilege"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "11.2: Database Storage",
                  "id": "block_storage_db",
                  "cond": "app_db_yes || app_aws_db",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Are only AWS databases used?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_aws_only_yes": "Yes"},
                        {"app_db_aws_only_no": "No"}
                      ],
                      "id": "app_db_aws_only",
                      "cond": "app_aws_db"
                    },
                    {
                      "type": "line",
                      "text": "What databases are being used (Oracle, MSQL, etc.)?",
                      "id": "app_db_database",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "cond": "(app_db_yes && !app_aws_db) || app_db_aws_only_no"
                    },
                    {
                      "type": "checkgroup",
                      "text": "How are database passwords protected?",
                      "defaultChoice": false,
                          "choices": [
                        {"app_db_pw_encrypted": "A Domain account is used, configured with Secret Server ([ORGANIZATION_VAULT_LABEL]) to protect the password"},
                        {"app_db_pw_secret_server": "Passwords are stored in Secret Server ([ORGANIZATION_VAULT_LABEL]) and accessed by the application directly."},
                        {"app_db_pw_service_kms": "Passwords are stored in an AWS store protected by KMS, like an encrypted database, an encrypted S3 file, or an encrypted Parameter Store."},
                        {"app_db_pw_service_other": "Some other mechanisms are used to encrypt the password"},
                        {"app_db_pw_none": "Passwords are stored in clear text, like in a configuration file or in the source code"},
                        {"app_db_pw_na": "Passwords are not needed because a different mechanism is being used to control access to the database."}
                      ],
                      "id": "app_db_pw_protected"
                    },
                    {
                      "type": "tip",
                      "text": "Database passwords should be encrypted.",
                      "warn": "yes",
                      "name": "Database passwords should be encrypted.",
                      "severity": "high",
                      "id": "warn_app_pw_encrypted",
                      "cond": "app_db_pw_none",
                      "why": "Explain why database passwords are not encrypted.  Are other protections used?"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain how the password is protected or details on what service is used.  If encryption is used, provide details about the encryption algorithm:",
                      "cond": "app_db_pw_service_other || app_db_pw_na",
                      "id": "app_db_pw_service_other_detail"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain how the password is protected for databases that are not in AWS:",
                      "cond": "app_db_aws_only_no",
                      "id": "app_db_pw_service_kms_detail"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Explain how the password is protected for AWS databases:",
                      "cond": "app_aws_db",
                      "id": "app_db_pw_service_not_aws_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are the permissions that allow access to the database (e.g. service accounts, IAM policy, etc.) shared with multiple services or products?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_accounts_shared_yes": "Yes"},
                        {"app_db_accounts_shared_no": "No"}
                      ],
                      "id": "app_db_accounts_shared"
                    },
                    {
                      "type": "tip",
                      "text": "Database permissions should not be shared across multiple services or products.",
                      "warn": "yes",
                      "name": "Sharing database permissions is not acceptable",
                      "severity": "high",
                      "id": "warn_app_db_accounts_shared",
                      "cond": "app_db_accounts_shared_yes",
                      "why": "Explain why permissions are shared across multiple services or products:"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are database permissions managed and granted using only database-specific roles and policy?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_roles_yes": "Yes"},
                        {"app_db_roles_no": "No"}
                      ],
                      "id": "app_db_roles"
                    },
                    {
                      "type": "tip",
                      "text": "Database permissions should only be managed and granted using database roles.",
                      "warn": "yes",
                      "name": "Database Roles should be used.",
                      "severity": "high",
                      "id": "warn_app_db_db_roles",
                      "cond": "app_db_roles_no",
                      "why": "Explain why database roles are not being used:"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is there separation for read-only versus read-write database operations?  For example, separate service accounts, IAM policy, etc.",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_separate_read_write_yes": "Yes"},
                        {"app_db_separate_read_write_no": "No"},
                        {"app_db_separate_read_write_na": "Not applicable since all programs require both read and write."},
                        {"app_db_separate_read_only": "Not applicable since all programs only read."},
                        {"app_db_separate_write_only": "Not applicable since all programs only write."}
                      ],
                      "id": "app_db_separate_read_write",
                      "cond": "(app_db_yes && !app_aws_db) || app_db_aws_only_no"
                    },
                    {
                      "type": "tip",
                      "text": "Separate accounts should be used for read-only versus read-write database operations.",
                      "warn": "yes",
                      "name": "Separation of read-only and read-write database accounts.",
                      "severity": "high",
                      "id": "warn_app_db_separate_read_write",
                      "cond": "app_db_separate_read_write_no",
                      "why": "Explain why separate accounts are not used for read-only versus read-write database operations:"
                    },
                    {
                      "type": "radiogroup",
                      "text": "This project makes use of Restricted information.  Is Restricted information stored in the database?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_restricted_yes": "Yes"},
                        {"app_db_restricted_no": "No"}
                      ],
                      "cond": "app_info_restricted_yes",
                      "id": "app_db_restricted"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is Restricted data encrypted in the database?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_restricted_encrypted_yes": "Yes"},
                        {"app_db_restricted_encrypted_no": "No"}
                      ],
                      "cond": "app_db_restricted_yes",
                      "id": "app_db_restricted_encrypted"
                    },
                    {
                      "type": "tip",
                      "text": "Restricted data in the database must be encrypted.",
                      "warn": "yes",
                      "name": "Restricted data in the database must be encrypted",
                      "severity": "high",
                      "id": "warn_app_db_restricted_encrypted",
                      "cond": "app_db_restricted_encrypted_no",
                      "why": "Explain why encryption is not being used:"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain how database passwords are rotated",
                      "id": "app_db_pw_rotated"
                    },
                    {
                      "type": "tip",
                      "text": "Database connection should be encrypted.",
                      "id": "warn_app_db_connection_encrypted",
                      "why": "Explain why database connection is not encrypted and what plans do you have to fix it:",
                      "warn": "yes",
                      "name": "Database connection not encrypted",
                      "severity": "high",
                      "cond": "app_db_connection_encrypted_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are database <b>connections</b> encrypted? [DB_CONNECTION_BEST_PRACTICE_HREF].",
                      "defaultChoice": false,
                      "choices": [
                        {"app_db_connection_encrypted_yes": "Yes"},
                        {"app_db_connection_encrypted_no": "No"}
                      ],
                      "id": "app_db_connection_encrypted"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "12: Logging",
              "id": "block_logging",
              "items": [
                {
                  "type": "info",
                  "text": "<p>For application logging, please refer to the [ORGANIZATION_LOGGING_STANDARDS_HREF].</p><p>All audit logs must include the following attributes:<ul><li>User IDs, session IDs, or unique system identifiers</li><li>Timestamps (the date/time the event occurred)</li><li>Details of the event or action performed</li><li>Host name, server name, and/or IP address of the clients and servers</li></ul></p>"
                },
                {
                  "type": "radiogroup",
                  "text": "Does this application log required attributes?",
                  "defaultChoice": false,
                  "id": "app_audit_log_attributes",
                  "choices": [
                    {"app_audit_log_attributes_yes": "Yes"},
                    {"app_audit_log_attributes_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Required attributes should be logged.",
                  "id": "warn_app_audit_log_attributes",
                  "why": "Explain why you required attributes are not being logged:",
                  "warn": "yes",
                  "name": "Required attributes not logged.",
                  "severity": "high",
                  "cond": "app_audit_log_attributes_no"
                },
                {
                  "type": "radiogroup",
                  "text": "Does the web server follow recommended [ORGANIZATION_WEB_SERVER_LOGGING_STANDARDS_HREF]?",
                  "defaultChoice": false,
                  "id": "app_audit_webserver_log_attributes",
                  "cond": "app_web_browser_yes || app_project_type_WebApp || app_project_type_WebServices",
                  "choices": [
                    {"app_audit_webserver_log_attributes_yes": "Yes"},
                    {"app_audit_webserver_log_attributes_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "text": "Webservers should be log required data to make it possible to associate clicks with users.",
                  "id": "warn_app_audit_webserver_log_attributes",
                  "why": "Explain why you required webserver logging is not enabled:",
                  "warn": "yes",
                  "name": "Required webserver logging is not logged.",
                  "severity": "high",
                  "cond": "app_audit_webserver_log_attributes_no"
                }
              ]
            },
            {
              "type": "block",
              "text": "13: Testing and QA",
              "id": "block_qa",
              "items": [
                {
                  "type": "info",
                  "text": "<p>Security testing can be part of standard application tests. Here are some examples:</p><ul><li><b>Simple unit tests:</b> Unit tests are typically used to confirm that the basic building blocks of the application work as expected. Unit tests are easy to repeat - they can run whenever new code is checked into the repository, to confirm that the code still behaves as expected. Unit tests can also check for security features. For example, they can be used to confirm that requests fail without XSRF tokens; that authentication is required to access user data; or that unexpected HTML tags can't get through input filters or escaping routines.</li><ul><li><b>Release testing:</b> Before a new version of a product is released, human testers typically go through the application, try the new features, and make sure previous features still work correctly (regression testing). Security testing should be included in this process as well. For example, release testing is a great time to verify that user A cannot access the data of user B.</li><ul><li><b>Monitoring:</b> Once the application is deployed, the focus usually shifts from testing to monitoring. Watch out for unexpected spikes in error rates, sandbox violations, and other flaky or inexplicable behavior (including intermittent test failures) - and before you dismiss an anomaly, check with your security team. Crashes and flakiness can indicate a race condition or a memory corruption bug.</li></ul><p>The next few questions assess the testing and monitoring of your application.</p>"
                },
                {
                  "type": "radiogroup",
                  "text": "Are you using unit tests or similar methods?",
                  "defaultChoice": false,
                  "id": "app_testing_unit",
                  "choices": [
                    {"app_testing_unit_yes": "Yes"},
                    {"app_testing_unit_no": "No"}
                  ]
                },
                {
                  "type": "block",
                  "text": "13.1: Unit Testing",
                  "cond": "app_testing_unit_yes",
                  "id": "block_unit_testing",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "How would you describe the code coverage of your unit tests?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_testing_unit_coverage_large": "<b>Robust:</b> The vast majority of our code is tested through unit tests; code coverage is at least &gt;80%."},
                        {"app_testing_unit_coverage_med": "<b>Weak:</b> We have some unit testing, but much of the code is not tested."},
                        {"app_testing_unit_coverage_small": "<b>Nonexistent:</b> We have no (or almost no) unit tests."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Unit tests have become quasi-standard for testing the functionality of software at a low level. Although this questionnaire focuses on security, the functional correctness of the application is also important. Particularly for web applications, where it is difficult (often impossible) to fall back to a previous version, functional bugs can cause problems with both integrity and availability. Consider implementing unit tests.",
                      "warn": "yes",
                      "name": "No unit tests",
                      "severity": "medium",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_testing_unit_coverage",
                      "cond": "app_testing_unit_coverage_med || app_testing_unit_coverage_small"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do you have special unit tests in place for testing the security of your code? For example, unit tests can be used to do the following:<p><ul><li>Verify that XSRF tokens are required for all state-changing actions</li><li>Confirm that user input is correctly escaped and/or sanitized</li><li>Check that the application enforces access control (e.g., user A doesn't have access to user B's data)</li>",
                      "defaultChoice": false,
                      "choices": [
                        {"app_testing_unit_security_yes": "Yes"},
                        {"app_testing_unit_security_no": "No"}
                      ],
                      "cond": "app_testing_unit_coverage_med || app_testing_unit_coverage_large",
                      "id": "app_testing_unit_security"
                    },
                    {
                      "type": "tip",
                      "text": "Scalable security depends on engineers doing their part - and common-sense, low-overhead unit tests are one of the most cost-efficient defenses available. Unit tests can help validate security parameters and avoid regressions that reintroduce security bugs. We strongly recommend including security checks in your unit tests.",
                      "warn": "yes",
                      "name": "No unit tests for security functions",
                      "severity": "medium",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_app_testing_unit_security",
                      "cond": "app_testing_unit_security_no"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "text": "Do your engineers and your QA team look for potential security issues during release testing, and have they been trained to do so?",
                  "defaultChoice": false,
                  "id": "app_testing_qa_security",
                  "choices": [
                    {"app_testing_qa_security_yes": "Yes, our QA process explicitly includes testing for security issues that might have been introduced in the new version."},
                    {"app_testing_qa_security_no": "This is an area where we have some room for improvement."}
                  ]
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Describe specific QA security tests performed:",
                  "cond": "app_testing_qa_security_yes",
                  "id": "app_testing_qa_security_detail"
                },
                {
                  "type": "tip",
                  "text": "Your engineering and QA teams are in the best position to understand how all parts of the application work, what has changed since the previous iteration, and how the changes might introduce security vulnerabilities. Release testing is typically done under considerable time pressure, but it is the last chance to catch security vulnerabilities internally. When your teams are already focused on testing, adding a few security tests won't increase the effort by much.<p>Engineers and testers who have been trained to look for security issues can make all the difference between a secure product and a serious vulnerability.",
                  "warn": "yes",
                  "name": "No security quality assurance",
                  "severity": "medium",
                  "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                  "id": "warn_app_testing_qa_security",
                  "cond": "app_testing_qa_security_no"
                }
              ]
            },
            {
              "type": "block",
              "text": "14: Deployment, Monitoring and Operations",
              "id": "block_monitoring_operations",
              "items": [
                {
                  "type": "block",
                  "text": "14.1: Deployment",
                  "id": "block_deploy",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "What deployment frameworks are used for deploying this project?",
                      "defaultChoice": false,
                      "choices": [
                        {"app_deploy_service_terraform": "Terraform"},
                        {"app_deploy_service_chef": "Chef"},
                        {"app_deploy_service_jenkins": "Jenkins"},
                        {"app_deploy_service_udeploy": "uDeploy"},
                        {"app_deploy_service_other": "Other"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "Additional deployment services:",
                      "cond": "app_deploy_service_other",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "id": "app_deploy_service_other_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do your lower environments (e.g. development, staging, UAT) connect only to lower environments for dependent services/APIs?",
                      "id": "app_aws_lower_environment_separation",
                      "choices": [
                        {"app_aws_lower_environment_separation_yes": "Yes"},
                        {"app_aws_lower_environment_separation_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "There should be strong separation between lower and upper environments as per [ORGANIZATION_ENVIRONMENT_STRATEGY_HREF].",
                      "warn": "yes",
                      "name": "Poor upper and lower environment separation",
                      "severity": "high",
                      "why": "Please explain why it is necessary for lower environments to interact with anything outside of the lower environment:",
                      "id": "warn_app_aws_lower_environment_separation",
                      "cond": "app_aws_lower_environment_separation_no"
                    },
                    {
                      "type": "checkgroup",
                      "text": "What AWS services are used for deployment?",
                      "defaultChoice": false,
                      "cond": "app_deploy_aws",
                      "choices": [
                        {"app_deploy_service_aws_cloudformation": "AWS <a href=\"https://aws.amazon.com/cloudformation\">CloudFormation</a>"},
                        {"app_deploy_service_aws_codebuild": "AWS <a href=\"https://aws.amazon.com/codebuild\">CodeBuild</a>"},
                        {"app_deploy_service_aws_codedeploy": "AWS <a href=\"https://aws.amazon.com/codedeploy\">CodeDeploy</a>"},
                        {"app_deploy_service_aws_codepipeline": "AWS <a href=\"https://aws.amazon.com/codepipeline\">CodePipeline</a>"},
                        {"app_deploy_service_aws_elastic_beanstalk": "AWS <a href=\"https://aws.amazon.com/elasticbeanstalk\">Elastic Beanstalk</a>"},
                        {"app_deploy_service_aws_opsworks": "AWS <a href=\"https://aws.amazon.com/opsworks\">OpsWorks</a>"},
                        {"app_deploy_service_aws_other": "Other"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "Additional AWS deployment services:",
                      "cond": "app_deploy_service_aws_other",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "id": "app_deploy_service_aws_other_detail"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain how this project meets [ORGANIZATION_PATCH_MANAGEMENT_POLICY_HREF] and ensures that servers are kept patched:",
                      "id": "app_deploy_patching"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "14.2: Post-Launch Monitoring",
                  "id": "block_monitoring",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "How would you describe your post-launch monitoring?",
                      "defaultChoice": false,
                      "choices": [
                        {"warn_app_monitoring_robust": "<b>Robust</b>: We have procedures in place to log and monitor for unexpected crashes, exceptions, and other error conditions. If something looks suspicious, a security-conscious engineer evaluates it."},
                        {"warn_app_monitoring_weak": "<b>Weak</b>: If something goes terribly wrong, such as massive spikes in crash rates or other large-scale anomalies, we will probably notice. But our monitoring is fairly coarse, and there is room for improvement."},
                        {"warn_app_monitoring_none": "<b>Nonexistent</b>: At the moment, we are not doing any kind of post-release monitoring that looks for signs of exploitation or increases in crashes/exceptions."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Thank you for putting effort into post-launch monitoring. Exceptions often indicate an underlying security problem, and close monitoring goes a long way toward quickly identifying and subsequently fixing vulnerabilities.",
                      "id": "tip_warn_app_monitoring",
                      "cond": "warn_app_monitoring_robust"
                    },
                    {
                      "type": "tip",
                      "text": "Exceptions and crashes often indicate an underlying security problem. Monitoring the deployed application can go a long way toward quickly identifying and subsequently fixing vulnerabilities. In carefully designed software products, exceptions should be a fairly rare occurrence; it therefore usually does not introduce significant overhead to monitor for them.",
                      "warn": "yes",
                      "name": "Inadequate monitoring for crashes/exceptions",
                      "severity": "medium",
                      "why": "Please explain how you intend to resolve this issue.  If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_warn_app_monitoring",
                      "cond": "warn_app_monitoring_weak || warn_app_monitoring_none"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please provide detail about what you monitor, what tools are used for monitoring, what alerts are generated to trigger further investigation or automatic response",
                      "id": "app_monitoring_detail"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "14.3: AWS (Amazon Web Services) Monitoring",
                  "id": "block_aws_monitor",
                  "cond": "app_deploy_aws",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Is CloudTrail enabled?",
                      "id": "app_aws_monitor_cloudtrail",
                      "cond": "!app_aws_ms_account_yes",
                      "choices": [
                        {"app_aws_monitor_cloudtrail_yes": "Yes"},
                        {"app_aws_monitor_cloudtrail_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is CloudTrail enabled in all regions?",
                      "id": "app_aws_monitor_cloudtrail_all_regions",
                      "cond": "app_aws_monitor_cloudtrail_yes",
                      "choices": [
                        {"app_aws_monitor_cloudtrail_all_regions_yes": "Yes"},
                        {"app_aws_monitor_cloudtrail_all_regions_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "CloudTrail should be enabled in all regions.",
                      "id": "warn_app_aws_monitor_cloudtrail",
                      "why": "Explain why CloudTrail is not being enabled in all regions:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_cloudtrail_all_regions_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are CloudTrail logs encrypted?",
                      "id": "app_aws_monitor_logs_encrypted",
                      "cond": "app_aws_monitor_cloudtrail_yes || app_aws_ms_account_yes",
                      "choices": [
                        {"app_aws_monitor_logs_encrypted_yes": "Yes"},
                        {"app_aws_monitor_logs_encrypted_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Logs should be encrypted.",
                      "id": "warn_aws_monitor_logs_encrypted",
                      "why": "Explain why logs are not encrypted:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_encrypted_no",
                      "severity": "high"
                    },
                    {
                      "type": "checkgroup",
                      "text": "What other AWS services are used for monitoring AWS (Amazon Web Services) activity:",
                      "defaultChoice": false,
                      "choices": [
                        {"app_aws_monitor_cloudwatch": "AWS <a href=\"https://aws.amazon.com/cloudwatch\">CloudWatch</a>"},
                        {"app_aws_monitor_awsconfig": "AWS <a href=\"https://aws.amazon.com/config\">Config</a>"},
                        {"app_aws_monitor_other": "Other"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "Additional monitoring technologies used:",
                      "cond": "app_aws_monitor_other",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "id": "app_aws_monitor_other_details"
                    },
                    {
                      "type": "tip",
                      "text": "CloudWatch should be enabled.",
                      "id": "warn_app_aws_monitor_cloudwatch",
                      "why": "Explain why CloudWatch is not being enabled.",
                      "warn": "yes",
                      "cond": "!app_aws_monitor_cloudwatch",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are CloudWatch alarms setup for CloudTrail?",
                      "id": "app_aws_monitor_cloudwatch_cloudtrail",
                      "cond": "(app_aws_monitor_cloudtrail_yes && app_aws_monitor_cloudwatch) || app_aws_ms_account_yes",
                      "choices": [
                        {"app_aws_monitor_cloudwatch_cloudtrail_yes": "Yes"},
                        {"app_aws_monitor_cloudwatch_cloudtrail_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "CloudWatch logs should be setup for CloudTrail.  Refer to the <a href=\"http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html\">AWS CloudTrail user Guide</a>.",
                      "id": "warn_aws_monitor_cloudwatch_cloudtrail",
                      "why": "Explain why CloudWatch logs are not setup for CloudTrail:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_cloudwatch_cloudtrail_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are CloudFront logs sent to S3?",
                      "id": "app_aws_monitor_logs_cloudfront",
                      "cond": "app_aws_cloudfront",
                      "choices": [
                        {"app_aws_monitor_logs_cloudfront_yes": "Yes"},
                        {"app_aws_monitor_logs_cloudfront_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "CloudFront logs should be sent to S3.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html\">Amazon CloudFront Developer Guide</a>.",
                      "id": "warn_aws_monitor_logs_cloudfront",
                      "why": "Explain why CloudFront logs are not sent to S3:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_cloudfront_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is S3 Access Logging activated?",
                      "id": "app_aws_monitor_s3_logging",
                      "cond": "app_aws_s3",
                      "choices": [
                        {"app_aws_monitor_s3_logging_yes": "Yes"},
                        {"app_aws_monitor_s3_logging_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "S3 should have access logging enabled.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html\">Amazon Simple Storage Service Developer Guide</a>.",
                      "id": "warn_app_aws_monitor_s3_logging",
                      "why": "Explain why S3 logging is not activated:",
                      "warn": "yes",
                      "severity": "high",
                      "cond": "app_aws_monitor_s3_logging_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are S3 API calls logged to CloudTrail?",
                      "id": "app_aws_monitor_s3_api_logging",
                      "cond": "app_aws_s3",
                      "choices": [
                        {"app_aws_monitor_s3_api_logging_yes": "Yes"},
                        {"app_aws_monitor_s3_api_logging_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "S3 should be logging API calls to CloudTrail.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/cloudtrail-logging.html\">Amazon Simple Storage Service Developer Guide</a>.",
                      "id": "warn_app_aws_monitor_s3_api_logging",
                      "why": "Explain why S3 logs are not sent to CloudTrail:",
                      "warn": "yes",
                      "severity": "high",
                      "cond": "app_aws_monitor_s3_api_logging_no || (app_aws_s3 && app_aws_monitor_cloudtrail_no)"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are ECS (instance & container) logs sent to CloudWatch?",
                      "id": "app_aws_monitor_logs_ecs",
                      "cond": "app_aws_ecs",
                      "choices": [
                        {"app_aws_monitor_logs_ecs_yes": "Yes"},
                        {"app_aws_monitor_logs_ecs_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "ECS (instance & container) logs should be sent to CloudWatch.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonECS/latest/developerguide/cloudwatch-metrics.html\">Amazon EC2 Container Service Developer Guide</a>.",
                      "id": "warn_aws_monitor_logs_ecs",
                      "why": "Explain why ECS logs are not sent to CloudWatch:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_ecs_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are CloudFormation logs sent to CloudTrail?",
                      "cond": "app_deploy_service_aws_cloudformation",
                      "id": "app_aws_monitor_logs_cloudformation",
                      "choices": [
                        {"app_aws_monitor_logs_cloudformation_yes": "Yes"},
                        {"app_aws_monitor_logs_cloudformation_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "CloudFormation logs should be sent to CloudTrail.  Refer to the <a href=\"http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-api-logging-cloudtrail.html\">AWS CloudFormation User Guide</a>.",
                      "id": "warn_aws_monitor_logs_cloudformation",
                      "why": "Explain why CloudFormation logs are not sent to CloudTrail:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_cloudformation_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are WAF (Web Application Firewall) logs sent to CloudTrail?",
                      "id": "app_aws_monitor_logs_cloudfront_waf",
                      "cond": "app_aws_cloudfront_waf_yes",
                      "choices": [
                        {"app_aws_monitor_logs_cloudfront_waf_yes": "Yes"},
                        {"app_aws_monitor_logs_cloudfront_waf_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "WAF logs should be sent to CloudTrail.  Refer to the <a href=\"http://docs.aws.amazon.com/waf/latest/developerguide/logging-using-cloudtrail.html\">AWS WAF and AWS Shield Advanced Developer Guide</a>.",
                      "id": "warn_aws_monitor_logs_cloudfront_waf",
                      "why": "Explain why CloudFront logs are not sent to S3:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_cloudfront_waf_no || (app_aws_cloudfront_waf_yes && app_aws_monitor_cloudtrail_no)",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are Elastic Beanstalk logs sent to CloudWatch?",
                      "cond": "app_deploy_service_aws_elastic_beanstalk",
                      "id": "app_aws_monitor_logs_elastic_beanstalk",
                      "choices": [
                        {"app_aws_monitor_logs_elastic_beanstalk_yes": "Yes"},
                        {"app_aws_monitor_logs_elastic_beanstalk_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Elastic Beanstalk logs should be sent to CloudWatch.  Refer to the <a href=\"http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatch.html\">AWS Elastic Beanstalk Developer Guide</a>.",
                      "id": "warn_aws_monitor_logs_elastic_beanstalk",
                      "why": "Explain why Elastic Beanstalk logs are not sent to CloudWatch:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_elastic_beanstalk_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are Elastic Load Balancer (ELB/ALB) logs sent to S3?",
                      "id": "app_aws_monitor_logs_elb",
                      "cond": "app_aws_elb",
                      "choices": [
                        {"app_aws_monitor_logs_elb_yes": "Yes"},
                        {"app_aws_monitor_logs_elb_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Elastic Load Balancer (ELB/ALB) logs should be sent to S3.  Refer to the <a href=\"http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/access-log-collection.html\">Elastic Classic Load Balancing Guide</a> and <a href=\"http://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html\">Elastic Application Load Balancing Guide</a>.",
                      "id": "warn_aws_monitor_logs_elb",
                      "why": "Explain why Elastic Load Balancer (ELB/ALB) logs are not sent to S3:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_elb_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are KMS logs sent to CloudTrail using a common S3 bucket?",
                      "cond": "app_secret_aws_kms",
                      "id": "app_aws_monitor_logs_kms",
                      "choices": [
                        {"app_aws_monitor_logs_kms_yes": "Yes"},
                        {"app_aws_monitor_logs_kms_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "KMS logs should be sent to CloudTrail.  Refer to the <a href=\"http://docs.aws.amazon.com/kms/latest/developerguide/logging-using-cloudtrail.html\">AWS Key Management Service Developer Guide</a>.",
                      "id": "warn_aws_monitor_logs_kms",
                      "why": "Explain why KMS logs are not sent to CloudTrail:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_kms_no || (app_secret_aws_kms && app_aws_monitor_cloudtrail_no)",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are Lambda logs sent to CloudWatch?",
                      "cond": "app_aws_lambda",
                      "id": "app_aws_monitor_logs_lambda",
                      "choices": [
                        {"app_aws_monitor_logs_lambda_yes": "Yes"},
                        {"app_aws_monitor_logs_lambda_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Lambda logs should be sent to CloudWatch.  Refer to the <a href=\"http://docs.aws.amazon.com/lambda/latest/dg/monitoring-functions-logs.html\">AWS Lambda Developer Guide</a>.",
                      "id": "warn_aws_monitor_logs_lambda",
                      "why": "Explain why Lambda logs are not sent to CloudWatch:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_logs_lambda_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are VPC Flow Logs enabled in AWS CloudWatch?",
                      "id": "app_aws_monitor_flow_logs",
                      "cond": "app_aws_vpc_yes",
                      "choices": [
                        {"app_aws_monitor_flow_logs_yes": "Yes"},
                        {"app_aws_monitor_flow_logs_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "AWS Cloudwatch VPC Flow Logs should be enabled when VPC is used.  Refer to the <a href=\"http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html\">AWS VPC User Guide</a>.",
                      "id": "warn_aws_monitor_flow_logs",
                      "why": "Explain why VPC Flow Logs are not used:",
                      "warn": "yes",
                      "cond": "app_aws_monitor_flow_logs_no || (app_aws_vpc_yes && !app_aws_monitor_cloudwatch)",
                      "severity": "high"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "15: Mobile Application",
              "id": "mobile_block",
              "cond": "app_project_type_mobile_app",
              "items": [
                {
                  "type": "checkgroup",
                  "text": "Please choose the application platform(s):",
                  "id": "app_mobile_platform",
                  "choices": [
                    {"app_mobile_platform_iOS": "Apple iOS"},
                    {"app_mobile_platform_android": "Google Android"},
                    {"app_mobile_platform_others": "Others"}
                  ]
                },
                {
                  "type": "line",
                  "text": "Describe the application platforms:",
                  "cond": "app_mobile_platform_others",
                  "maxlength": "[MAXLENGTH_LINE_ITEM]",
                  "id": "app_mobile_platform_detail"
                },
                {
                  "type": "tip",
                  "text": "Please go through the <a href=\"https://developer.apple.com/library/content/documentation/Security/Conceptual/Security_Overview/Introduction/Introduction.html#//apple_ref/doc/uid/TP30000976\">Security Overview</a> for Apple platforms and be aware and gain insights about <a href=\"https://developer.apple.com/library/content/documentation/Security/Conceptual/SecureCodingGuide/Introduction.html\">Apple's Secure Coding Guidelines</a>.",
                  "id": "tip_mobile_ios_coding_guideline",
                  "cond": "app_mobile_platform_iOS"
                },
                {
                  "type": "tip",
                  "text": "Please go through <a href=\"https://developer.android.com/topic/security/index.html\">Android Security overview</a> and <a href=\"https://developer.android.com/topic/security/best-practices.html\">application security best practices</a>.",
                  "id": "tip_mobile_android_coding_guideline",
                  "cond": "app_mobile_platform_android"
                },
                {
                  "type": "block",
                  "text": "15.1: Application Design and Threat Modelling",
                  "id": "mobile_architecture_block",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Are there application components that have been identified and are known to be NOT needed but are still shipped in the build?",
                      "id": "mobile_architecture_components",
                      "choices": [
                        {"mobile_architecture_components_yes": "Yes"},
                        {"mobile_architecture_components_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Components or code that are not needed must not be shipped along with the rest of the application.",
                      "id": "warn_mobile_component_not_required",
                      "why": "Explain why the non-required components cannot be taken out:",
                      "warn": "yes",
                      "cond": "mobile_architecture_components_yes",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is there a feature that depends upon security controls enforced ONLY on the client side (except for features like Fingerprint/TouchID), but NOT on the respective remote endpoint(s)?",
                      "id": "mobile_architecture_client_control",
                      "choices": [
                        {"mobile_architecture_client_control_yes": "Yes"},
                        {"mobile_architecture_client_control_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Security controls, almost always, MUST have the relevant respective implementation at the remote endpoint as well.",
                      "id": "warn_mobile_client_only_security_control",
                      "why": "Explain about what this security control is and why this cannot be implemented at the server endpoint:",
                      "warn": "yes",
                      "cond": "mobile_architecture_client_control_yes",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Have you worked with the project architect and technical leads so that a threat model for the mobile app and the associated remote services, which identifies potential threats and countermeasures, has been produced?",
                      "id": "mobile_architecture_threat_model",
                      "choices": [
                        {"mobile_architecture_threat_model_yes": "Yes"},
                        {"mobile_architecture_threat_model_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "cond": "mobile_architecture_threat_model_yes",
                      "text": "That's good to know! Please provide details below of what threats were identified and what's the plan to address those? You may like to provide reference to a wiki page containing the threat model.",
                      "id": "mobile_architecture_threat_model_details"
                    },
                    {
                      "type": "tip",
                      "text": "A threat model of the application MUST always be prepared with help from architects and technical leads.",
                      "id": "warn_mobile_client_no_threat_model",
                      "why": "Explain why a threat modelling hasn't been done yet:",
                      "warn": "yes",
                      "cond": "mobile_architecture_threat_model_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do all the security controls have centralized implementation?",
                      "id": "mobile_architecture_control_placement",
                      "choices": [
                        {"mobile_architecture_control_placement_yes": "Yes"},
                        {"mobile_architecture_control_placement_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "It's recommended to have all security controls implemented via a centralized implementation. For example, all authentication within an application may be controlled through a single Authentication API. All components processing either local or remote authentication may act through this API and all authentication requests will inevitably pass through its methods.",
                      "id": "tip_mobile_control_placement",
                      "cond": "mobile_architecture_control_placement_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Please confirm that a mechanism for enforcing (auto)updates of the mobile app exists?",
                      "id": "mobile_architecture_autoupdate",
                      "choices": [
                        {"mobile_architecture_autoupdate_yes": "Yes"},
                        {"mobile_architecture_autoupdate_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "It's recommended for mobile applications to have an auto-update feature. Aside from telling users about new features and bug fixes, this also helps in making sure that new security controls or fixes get pushed to the end users as soon as possible.",
                      "id": "tip_mobile_auto_update",
                      "cond": "mobile_architecture_autoupdate_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "15.2: Data Storage & Privacy",
                  "id": "mobile_data_block",
                  "items": [
                    {
                      "type": "tip",
                      "text": "Please read through the following guidelines for data storage for an <a href=\"https://b-mueller.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x05d-Testing-Data-Storage.html#testing-for-sensitive-data-in-logs\">Android application</a>.",
                      "id": "tip_warn_app_mobile_data_android",
                      "cond": "app_mobile_platform_android"
                    },
                    {
                      "type": "tip",
                      "text": "Please read through the following guidelines for data storage for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x06d-Testing-Data-Storage.html#testing-for-sensitive-data-in-logs\">iOS application</a>.",
                      "id": "tip_warn_app_mobile_data_ios",
                      "cond": "app_mobile_platform_iOS"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application provide a mobile payments or in-app purchase feature?",
                      "id": "app_mobile_purchase",
                      "choices": [
                        {"app_mobile_purchase_yes": "Yes"},
                        {"app_mobile_purchase_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application offer to save and/or later makes use of the user credentials or other such sensitive data on the mobile file-system?",
                      "id": "app_mobile_credentials_save",
                      "choices": [
                        {"app_mobile_credentials_save_yes": "Yes"},
                        {"app_mobile_credentials_save_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application use system credential storage facilities appropriately to store sensitive data, such as user credentials or cryptographic keys?",
                      "id": "app_mobile_sensitive_system_storage",
                      "cond": "app_mobile_credentials_save_yes",
                      "choices": [
                        {"app_mobile_sensitive_system_storage_yes": "Yes"},
                        {"app_mobile_sensitive_system_storage_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application allow running the app on jailbroken or rooted device?",
                      "id": "app_mobile_rooted",
                      "choices": [
                        {"app_mobile_rooted_yes": "Yes"},
                        {"app_mobile_rooted_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Jailbroken or rooted devices or the presence of rogue applications can represent an execution risk.should look into ways to dynamically gauge the security of the underlying device. First, the mobile app sandbox, which is prevalent in modern mobile operating system design, must be intact. Rooting or jailbreaking the device breaks the underlying security model, and it is highly recommended to restrict these devices from accessing enterprise data. Furthermore, jailbreak technology is evolving rapidly to evade detection; coping with these mechanisms is essential to keeping up with these threats.",
                      "id": "tip_warn_mobile_rooted",
                      "cond": "app_mobile_rooted_yes"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application use Fingerprint or TouchID to identify the user?",
                      "id": "app_mobile_touchID",
                      "choices": [
                        {"app_mobile_touchID_yes": "Yes"},
                        {"app_mobile_touchID_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Fingerprints/TouchID is a security feature provided directly by the platform and is a great way to prevent unauthorized access to the application and its data.",
                      "id": "warn_app_mobile_no_touchID",
                      "why": "Explain why Fingerprint/TouchID is't being used and what's the plan of action:",
                      "warn": "yes",
                      "cond": "app_mobile_touchID_no",
                      "severity": "medium"
                    },
                    {
                      "type": "checkgroup",
                      "text": "Where does the application save any user or application data on the file-system?",
                      "id": "app_mobile_data_save",
                      "choices": [
                        {"app_mobile_data_save_external": "External storage (e.g. SD card)"},
                        {"app_mobile_data_save_iCloud": "iCloud"},
                        {"app_mobile_data_save_sandbox": "Internal storage, Documents or Application-Data folders in application sandbox"},
                        {"app_mobile_data_save_db": "SQLite or other local database"},
                        {"app_mobile_data_save_content_providers": "Content providers"},
                        {"app_mobile_data_save_others": "Others"}
                      ]
                    },
                    {
                      "type": "line",
                      "text": "Describe where the application saves user or application data:",
                      "cond": "app_mobile_data_save_others",
                      "maxlength": "[MAXLENGTH_LINE_ITEM]",
                      "id": "app_mobile_data_save_others_detail"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application perform input validation when handling data from external storage as you would with data from any untrusted source?",
                      "id": "app_mobile_external_input_validation",
                      "cond": "app_mobile_data_save_external",
                      "choices": [
                        {"app_mobile_external_input_validation_yes": "Yes"},
                        {"app_mobile_external_input_validation_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "You should Perform input validation when handling data from external storage. You should not store executables or class files on external storage prior to dynamic loading. If your app does retrieve executable files from external storage, the files should be signed and cryptographically verified prior to dynamic loading.",
                      "id": "warn_mobile_external_input_validation",
                      "why": "Explain why input validation is not performed:",
                      "warn": "yes",
                      "cond": "app_mobile_external_input_validation_no",
                      "severity": "high"
                    },
                    {
                      "type": "tip",
                      "text": "Look at <a href=\"https://developer.android.com/training/articles/security-tips.html#ContentProviders\">the best practices</a> when working with content providers.",
                      "id": "tip_warn_mobile_content_providers",
                      "cond": "app_mobile_data_save_content_providers && app_mobile_platform_android"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application make use of WebView or UIWebView to load any sensitive or enterprise proprietary data or any other kind of data?",
                      "id": "app_mobile_webview",
                      "choices": [
                        {"app_mobile_webview_yes": "Yes"},
                        {"app_mobile_webview_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application clear WebView and network response cache to delete any files stored locally or use <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control\">server-side headers such as no-cache</a> to indicate that an application should not cache particular content?",
                      "id": "app_mobile_webview_cache",
                      "cond": "app_mobile_webview_yes",
                      "choices": [
                        {"app_mobile_webview_cache_yes": "Yes"},
                        {"app_mobile_webview_cache_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Sensitive data should either not be cached or should be cleared as soon as WebView is unloaded.",
                      "id": "warn_app_mobile_webview_cache",
                      "why": "Explain why cache is not cleared or no-cache header can't be used:",
                      "warn": "yes",
                      "cond": "app_mobile_webview_cache_no",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is any sensitive data written to application logs?",
                      "id": "app_mobile_data_log",
                      "choices": [
                        {"app_mobile_data_log_yes": "Yes"},
                        {"app_mobile_data_log_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "What sensitive data is being written to application logs? Please provide details:",
                      "id": "mobile_log_data_detail",
                      "cond": "app_mobile_data_log_yes"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is any sensitive data shared with third parties unless it is a necessary part of the architecture?",
                      "id": "app_mobile_data_shared",
                      "choices": [
                        {"app_mobile_data_shared_yes": "Yes"},
                        {"app_mobile_data_shared_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "What sensitive data is being shared? Please provide details:",
                      "id": "app_mobile_data_shared_detail",
                      "cond": "app_mobile_data_shared_yes"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is the keyboard cache disabled and clipboard deactivated on text inputs/fields that process sensitive data?",
                      "id": "app_mobile_data_keyboard",
                      "choices": [
                        {"app_mobile_data_keyboard_yes": "Yes"},
                        {"app_mobile_data_keyboard_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Keyboard cache should be disabled and clipboard deactivated on text inputs/fields especially for those that may process sensitive data like password, SSN, card number etc.",
                      "id": "warn_app_mobile_data_keyboard",
                      "why": "Explain why keyboard cache is not disabled:",
                      "warn": "yes",
                      "cond": "app_mobile_data_keyboard_no",
                      "severity": "low"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is any sensitive data exposed via IPC mechanisms (for example, deep linking) or via backups generated by the mobile operating system?",
                      "id": "app_mobile_data_ipc",
                      "choices": [
                        {"app_mobile_data_ipc_yes": "Yes"},
                        {"app_mobile_data_ipc_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "No sensitive data should be exposed due to inter process communication or in the backups.",
                      "id": "warn_app_mobile_data_ipc",
                      "why": "Explain what data is being exposed and why:",
                      "warn": "yes",
                      "cond": "app_mobile_data_ipc_yes",
                      "severity": "low"
                    },
                    {
                      "type": "checkgroup",
                      "text": "Please select which of the following security controls does the application implement?",
                      "id": "app_mobile_data_other_controls",
                      "choices": [
                        {"app_mobile_data_pwd_ui": "Verified that no sensitive data, such as passwords or pins, is exposed through the user interface."},
                        {"app_mobile_data_screenshots": "Verifed that the app removes sensitive data from views when backgrounded (screenshots)."},
                        {"app_mobile_data_memory": "Verified that the app does not hold sensitive data in memory longer than necessary, and memory is cleared explicitly after use."},
                        {"app_mobile_data_acp": "Verified that the app enforces a minimum device-access-security policy, such as requiring the user to set a device passcode."},
                        {"app_mobile_data_education": "Verified that the app educates the user about the types of personally identifiable information processed (if applicable), as well as security best practices the user should follow in using the app."},
                        {"app_mobile_data_logout": "Verified that the remote endpoint terminates the existing session when the user logs out."},
                        {"app_mobile_data_pwd_policy": "Verified that a password policy exists and is enforced at the remote endpoint."},
                        {"app_mobile_data_login_abuse": "Verified that the remote endpoint implements a mechanism to protect against the submission of credentials an excessive number of times (login attempts)."},
                        {"app_mobile_data_2fa": "Verified that a second factor of authentication exists at the remote endpoint and the 2FA requirement is consistently enforced."},
                        {"app_mobile_data_step_up_auth": "Verified that step-up authentication is required to enable actions that deal with sensitive data or transactions."},
                        {"app_mobile_data_login_log": "Verified that the app informs the user of all login activities with his or her account. Users are able to view a list of devices used to access the account, and to block specific devices."},
                        {"app_mobile_data_cert_pinned": "Verified that the app either uses its own certificate store, or pins the endpoint certificate or public key, and subsequently does not establish connections with endpoints that offer a different certificate or key, even if signed by a trusted CA."},
                        {"app_mobile_data_account_recovery": "Verified that the app doesn't rely on a single insecure communication channel (email or SMS) for critical operations, such as enrollments and account recovery."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "You may wish to read through about some these security controls and how to test for them for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x05g-Testing-Network-Communication.html\">Android application</a>.",
                      "id": "tip_warn_app_mobile_security_controls_android",
                      "cond": "app_mobile_platform_android"
                    },
                    {
                      "type": "tip",
                      "text": "You may wish to read through about some these security controls and how to test for them for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x06g-Testing-Network-Communication.html\">iOS application</a>.",
                      "id": "tip_warn_app_mobile_security_controls_ios",
                      "cond": "app_mobile_platform_iOS"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please indicate if any of the above security controls are unchecked (not implemented). Explain why those are not implemented and what's the future course of action:",
                      "id": "app_mobile_data_other_controls_detail",
                      "cond": "!app_mobile_data_pwd_ui || !app_mobile_data_screenshots || !app_mobile_data_memory || !app_mobile_data_acp || !app_mobile_data_education || !app_mobile_data_logout || !app_mobile_data_pwd_policy || !app_mobile_data_login_abuse || !app_mobile_data_2fa || !app_mobile_data_step_up_auth || !app_mobile_data_login_log || !app_mobile_data_cert_pinned || !app_mobile_data_account_recovery"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "15.3: Platform Interaction",
                  "id": "mobile_platform_interaction_block",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Does the application require specific permissions to run or access a product feature?",
                      "id": "app_mobile_permissions",
                      "choices": [
                        {"app_mobile_permissions_yes": "Yes"},
                        {"app_mobile_permissions_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Do limit permissions to only the most necessary ones required for the app to function correctly. Excessive use of permissions to the mobile applications — which are granted by the user, often by default — can provide malware and rogue applications access to basic services (e.g., SMS) used to facilitate fraudulent activities. Also look at the <a href=\"https://developer.android.com/training/articles/security-tips.html#Permissions\">best practices for using permissions</a>.",
                      "id": "tip_warn_mobile_permissions",
                      "cond": "app_mobile_permissions_yes"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "What permissions are used by the application to run? Are all these permissions absolutely required? Are the permissions requested as the user starts using specific sections of the app? Please provide details:",
                      "id": "mobile_permissions_detail",
                      "cond": "app_mobile_permissions_yes"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application use WebViews in such a way that they are configured to allow only the minimum set of protocol handlers required (ideally, only https). Potentially dangerous handlers, such as file, tel and app-id, are disabled?",
                      "id": "app_mobile_webview_handlers",
                      "cond": "app_mobile_webview_yes",
                      "choices": [
                        {"app_mobile_webview_handlers_yes": "Yes"},
                        {"app_mobile_webview_handlers_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Potentially dangerous handlers, such as file:, tel: and app-id: etc. should be disabled to avoid abuse/mis-use of these. For example, attackers can exploit such a vulnerability by putting an invisible &lt;iframe src=\"tel://xxx?call\"&gt;&lt;/iframe&gt; (where xxx can be replaced by a premium number)",
                      "id": "warn_app_mobile_webview_handlers",
                      "why": "Explain what protocol handlers are allowed and why? What checks are in place to deter abuse?",
                      "warn": "yes",
                      "cond": "app_mobile_webview_handlers_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application expose any of its native methods to a WebView?",
                      "id": "app_mobile_webview_native_methods",
                      "cond": "app_mobile_webview_yes",
                      "choices": [
                        {"app_mobile_webview_native_methods_yes": "Yes"},
                        {"app_mobile_webview_native_methods_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the WebView only render JavaScript contained within the app package/bundle?",
                      "id": "app_mobile_webview_native_methods_bundled",
                      "cond": "app_mobile_webview_native_methods_yes",
                      "choices": [
                        {"app_mobile_webview_native_methods_bundled_yes": "Yes"},
                        {"app_mobile_webview_native_methods_bundled_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Mobile platforms offer a way that enables JavaScript executed in a WebView to call and use native functions within a mobile App. This can be potentially dangerous unless it's only allowed via the bundled and trusted JavaScript.",
                      "id": "warn_app_mobile_webview_native_methods_bundled",
                      "why": "Explain why does the application need to render JavaScript from outside the package/bundle?",
                      "warn": "yes",
                      "cond": "app_mobile_webview_native_methods_bundled_no",
                      "severity": "high"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "15.4: Reverse Engineering",
                  "id": "mobile_reverse_engg_block",
                  "items": [
                    {
                      "type": "tip",
                      "text": "You may wish to read through about reverse engineering security controls and how to test for them for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x06j-Testing-Resiliency-Against-Reverse-Engineering.html\">iOS application</a>.",
                      "id": "tip_warn_app_mobile_security_controls_rev_engg_ios",
                      "cond": "app_mobile_platform_iOS"
                    },
                    {
                      "type": "tip",
                      "text": "You may wish to read through about reverse engineering security controls and how to test for them for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x05j-Testing-Resiliency-Against-Reverse-Engineering.html\">Android application</a>.",
                      "id": "tip_warn_app_mobile_security_controls_rev_engg_android",
                      "cond": "app_mobile_platform_android"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app implement two or more functionally independent methods of root detection?",
                      "id": "mobile_reverse_engg_root_detection",
                      "choices": [
                        {"mobile_reverse_engg_root_detection_yes": "Yes"},
                        {"mobile_reverse_engg_root_detection_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Root detection is not highly effective on its own, but having some root checks sprinkled throughout the app can improve the effectiveness of the overall anti-tampering scheme.",
                      "id": "warn_mobile_reverse_engg_root_detection",
                      "why": "Explain why does the application not make use of root detection?",
                      "warn": "yes",
                      "cond": "mobile_reverse_engg_root_detection_no",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app respond to the presence of a rooted device either by alerting the user or terminating itself?",
                      "id": "mobile_reverse_engg_root_detection_response",
                      "cond": "mobile_reverse_engg_root_detection_yes",
                      "choices": [
                        {"mobile_reverse_engg_root_detection_response_yes": "Yes"},
                        {"mobile_reverse_engg_root_detection_response_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Application should respond to the presence of rooted device and alert the user or terminate itself to avoid tampering.",
                      "id": "warn_mobile_reverse_engg_root_detection_alert",
                      "why": "Explain why does the application not terminate itself or alert the user?",
                      "warn": "yes",
                      "cond": "mobile_reverse_engg_root_detection_response_no",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the application implement multiple functionally independent debugging defenses that, in context of the overall protection scheme, force adversaries to invest significant manual effort to enable debugging? All available debugging protocols must be covered (e.g. JDWP and native).",
                      "id": "mobile_reverse_engg_dbg_defense",
                      "choices": [
                        {"mobile_reverse_engg_dbg_defense_yes": "Yes"},
                        {"mobile_reverse_engg_dbg_defense_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain why debugging defense cannot be put into place:",
                      "id": "mobile_reverse_engg_dbg_defense_detail",
                      "cond": "mobile_reverse_engg_dbg_defense_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app detect, and respond to, tampering with executable files and critical data?",
                      "id": "mobile_reverse_engg_exe_tampering",
                      "choices": [
                        {"mobile_reverse_engg_exe_tampering_yes": "Yes"},
                        {"mobile_reverse_engg_exe_tampering_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain why tampering with data is not important:",
                      "id": "mobile_reverse_engg_exe_tampering_detail",
                      "cond": "mobile_reverse_engg_exe_tampering_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app make sure that all executable files and libraries belonging to the app are either encrypted on the file level and/or important code and data segments inside the executables are encrypted or packed? Trivial static analysis should not reveal important code or data.",
                      "id": "mobile_reverse_engg_exe_packing",
                      "choices": [
                        {"mobile_reverse_engg_exe_packing_yes": "Yes"},
                        {"mobile_reverse_engg_exe_packing_no": "No"}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app implement a 'device binding' functionality when a mobile device is treated as being trusted? Does it make sure that device fingerprint is derived from multiple device properties?",
                      "id": "mobile_reverse_engg_device_binding",
                      "choices": [
                        {"mobile_reverse_engg_device_binding_yes": "Yes"},
                        {"mobile_reverse_engg_device_binding_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain why device binding is not implemented:",
                      "id": "mobile_reverse_engg_device_binding_detail",
                      "cond": "mobile_reverse_engg_device_binding_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app detect the presence of widely used reverse engineering tools, such as code injection tools, hooking frameworks and debugging servers?",
                      "id": "mobile_reverse_engg_tools",
                      "choices": [
                        {"mobile_reverse_engg_tools_yes": "Yes"},
                        {"mobile_reverse_engg_tools_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain why the detection of presence of reverse engineering tools is not implemented:",
                      "id": "mobile_reverse_engg_tools_detail",
                      "cond": "mobile_reverse_engg_tools_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app use obfuscation and make sure that obfuscating transformations and functional defenses are interdependent and well-integrated throughout?",
                      "id": "mobile_reverse_engg_obfus",
                      "choices": [
                        {"mobile_reverse_engg_obfus_yes": "Yes"},
                        {"mobile_reverse_engg_obfus_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain why obfuscation is not implemented well:",
                      "id": "mobile_reverse_engg_obfus_detail",
                      "cond": "mobile_reverse_engg_obfus_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does the app detect, and respond to, being run in an emulator (simulator) using any standard method?",
                      "id": "mobile_reverse_engg_emulator",
                      "choices": [
                        {"mobile_reverse_engg_emulator_yes": "Yes"},
                        {"mobile_reverse_engg_emulator_no": "No"}
                      ]
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please explain why emulator detection is not implemented:",
                      "id": "mobile_reverse_engg_emulator_detail",
                      "cond": "mobile_reverse_engg_emulator_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "15.5: Code Quality & Build Settings",
                  "id": "mobile_code_quality_block",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "Please select which of the following security controls and build settings does the application implement or make use of?",
                      "id": "app_mobile_code_quality",
                      "choices": [
                        {"app_mobile_code_quality_code_signing": "Verified that the app is signed and provisioned with valid certificate."},
                        {"app_mobile_code_quality_release": "Verifed that the app has been built in release mode, with settings appropriate for a release build (e.g. non-debuggable)."},
                        {"app_mobile_code_quality_dbg_symbols": "Verified that debugging symbols have been removed from native binaries."},
                        {"app_mobile_code_quality_dbg_code": "Verified that debugging code has been removed, and the app does not log verbose errors or debugging messages."},
                        {"app_mobile_code_quality_3rd_party_libs": "Verified that all third party components used by the mobile app, such as libraries and frameworks, are identified, and checked for known vulnerabilities."},
                        {"app_mobile_code_quality_exceptions": "Verified that the app catches and handles possible exceptions."},
                        {"app_mobile_code_quality_access": "Verified that error handling logic in security controls denies access by default."},
                        {"app_mobile_code_quality_unmanaged_code": "Verified that in unmanaged code (if applicable), memory is allocated, freed and used securely."},
                        {"app_mobile_code_quality_toolchain": "Verified that free security features offered by the toolchain, such as byte-code minification, stack protection, PIE support and automatic reference counting, are activated."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "You may wish to read through about testing for these settings for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x05i-Testing-Code-Quality-and-Build-Settings.html\">Android application</a>.",
                      "id": "tip_warn_app_mobile_code_quality_android",
                      "cond": "app_mobile_platform_android"
                    },
                    {
                      "type": "tip",
                      "text": "You may wish to read through about testing for these settings for an <a href=\"https://sushi2k.gitbooks.io/the-owasp-mobile-security-testing-guide/content/0x06i-Testing-Code-Quality-and-Build-Settings.html\">iOS application</a>.",
                      "id": "tip_warn_app_mobile_code_quality_ios",
                      "cond": "app_mobile_platform_iOS"
                    },
                    {
                      "type": "box",
                      "maxlength": "[MAXLENGTH_BOX_ITEM]",
                      "text": "Please indicate if any of the above build settings or controls are unchecked (not implemented). Explain why those are not implemented and what's the future course of action:",
                      "id": "app_mobile_code_quality_detail",
                      "cond": "!app_mobile_code_quality_code_signing || !app_mobile_code_quality_release || !app_mobile_code_quality_dbg_symbols || !app_mobile_code_quality_dbg_code || !app_mobile_code_quality_3rd_party_libs || !app_mobile_code_quality_exceptions || !app_mobile_code_quality_access || !app_mobile_code_quality_unmanaged_code || !app_mobile_code_quality_toolchain"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "16: SOC2 Compliance",
              "id": "block_soc",
              "cond": "app_soc_yes",
              "items": [
                {
                  "type": "info",
                  "id": "app_soc_intro",
                  "text": "Projects subject to SOC2 compliance require additional approval for any changes flagged as security changes.  Please answer the following questions to assist with ensuring these changes are properly reviewed.  Some of these changes may have been discussed in other sections, and you may simply refer to those sections.  It is important in this section to clarify any [BUG_TRACKER_SYSTEM_NAME] tickets that require review."
                },
                {
                  "type": "checkgroup",
                  "text": "Were any changes made to any of the following elemenents?",
                  "id": "app_soc_elements",
                  "defaultChoice": false,
                  "choices": [
                    {"app_soc_authentication": "Authentication, authorization or session management systems (e.g. login)"},
                    {"app_soc_administrative": "Administrative / privileged account management systems (e.g. admin tools)"},
                    {"app_soc_cryptographic": "Cryptographic, digital signature or hash functions (e.g. any change to account number of password fields)"},
                    {"app_soc_key_management": "Key management functions (e.g. batch imports)"},
                    {"app_soc_logging": "Logging frameworks (e.g. transaction logging)"},
                    {"app_soc_access_control": "Logical access controls / data segregation controls (e.g. database structure change)"},
                    {"app_soc_infrastructure": "Server infrastructure devices / firewall rules (e.g. new servers)"},
                    {"app_soc_major_components": "Major system components (e.g. new modules)"},
                    {"app_soc_sensitive_data": "Addition / removal of sensitive data elements (e.g. SSN, date of birth, account number, password)"},
                    {"app_soc_restricted_data": "Addition / removal of privacy, credit card and/or health information"}
                  ]
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to authentication, authorization or session management systems.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_authentication",
                  "id": "app_soc_detail_authentication"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to administrative / privileged account management systems.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_administrative",
                  "id": "app_soc_detail_administrative"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to cryptographic, digital signature or hash fucntions.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_cryptographic",
                  "id": "app_soc_detail_cryptographic"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to key management functions.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_key_management",
                  "id": "app_soc_detail_key_management"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to logging frameworks.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_logging",
                  "id": "app_soc_detail_loging"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to logical access controls / data segregation controls.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_access_control",
                  "id": "app_soc_detail_access_control"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to server infrastructure devices / firewall rules.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_infrastructure",
                  "id": "app_soc_detail_infrastructure"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change to major system components.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_major_components",
                  "id": "app_soc_detail_major_components"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change involving addition / removal of sensitive data elements.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_sensitive_data",
                  "id": "app_soc_detail_sensitive_data"
                },
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide details about each change involving addition / removal of privacy, credit card and/or health information.  Include related [BUG_TRACKER_SYSTEM_NAME] ticket references for review and approval.",
                  "cond": "app_soc_restricted_data",
                  "id": "app_soc_detail_restricted_data"
                }
              ]
            },
            {
              "type": "block",
              "text": "17: Additional Notes",
              "id": "block_notes",
              "items": [
                {
                  "type": "box",
                  "maxlength": "[MAXLENGTH_BOX_ITEM]",
                  "text": "Provide any additional information about the security of your application.  Please discuss any security topics relating to the project that are not otherwise discussed in the questionnaire.  Provide detail to help clarify answers in the form.  For example, if the project has subcomponents that use different services or databases, then this section can be used to help clarify how certain answers in the form may apply differently across different subcomponents or services.",
                  "id": "app_other"
                }
              ]
            }
          ]
        },
        {
          "type": "block",
          "text": "New Datacenter Physical/Cloud",
          "id": "block_datacenter",
          "cond": "scenario_datacenter",
          "item": [
            {
              "type": "block",
              "id": "block_office_security",
              "text": "Security at the Office",
              "items": [
                {
                  "type": "info",
                  "text": "<b>Why this section matters:</b> Data centers are often fairly easy to protect because not very many people need physical access to them. Offices, on the other hand, are much harder to secure because a lot of people need frequent access. In addition to being directly connected to data centers on a network level, offices host the physical machines that are used to access data. Unless the office is sufficiently protected, attackers might use physical access to (for example) set up back doors on machines or steal local data, including credentials that can then be used to access information in data centers."
                },
                {
                  "type": "info",
                  "text": "<b>Note:</b> If you have multiple offices with network-level access to systems or data containing confidential information, answer the following questions for the office with the fewest physical controls (the weakest link)."
                },
                {
                  "type": "radiogroup",
                  "id": "office_facilities_excl",
                  "text": "Are all facilities used exclusively by your company, or are some shared?",
                  "defaultChoice": false,
                  "choices": [
                    {"office_facilities_excl_yes": "Yes, we are the only tenant of the facilities."},
                    {"office_facilities_excl_no": "No, some or all of the facilities are shared with other companies."},
                    {"office_facilities_home": "We don't have offices; everyone works from home."}
                  ]
                },
                {
                  "type": "box",
                  "id": "office_home_device_mgmt",
                  "cond": "office_facilities_home",
                  "text": "How do you manage your employees' devices, considering everyone works from home? Are they centrally managed?"
                },
                {
                  "type": "box",
                  "id": "office_facilities_separation",
                  "cond": "office_facilities_excl_no",
                  "text": "How is your physical area separated from other areas of the office facility? Explain how you control access to your area (e.g., door with swipe card and a receptionist)."
                },
                {
                  "type": "radiogroup",
                  "id": "office_ra",
                  "cond": "!office_facilities_home",
                  "text": "Does your company review the physical and environmental risks that your office facilities are exposed to, and do you have procedures in place to evaluate and, if necessary, address them?",
                  "defaultChoice": false,
                  "choices": [
                    {"office_ra_yes": "Yes, we do risk assessments to proactively identify risks related to physical and environmental security."},
                    {"office_ra_no": "No, we don't review physical and environmental risks."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_office_ra",
                  "cond": "office_ra_no",
                  "text": "To ensure that your current security controls are adequate, it's important to assess the physical and environmental risks that your office facilities are exposed to.",
                  "warn": "yes",
                  "name": "No risk assessments of physical security at office",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "checkgroup",
                  "cond": "office_facilities_excl_no",
                  "text": "Select the security controls that are in place at <i>all</i> of your offices:",
                  "defaultChoice": false,
                  "choices": [
                    {"office_controls_receptionist": "Staffed reception desk"},
                    {"office_controls_guards_shared": "Guards (shared by entire building)"},
                    {"office_controls_guards_exclusive": "Guards (hired by and for your company specifically)"},
                    {"office_controls_motion_detectors": "Motion detectors"},
                    {"office_controls_alarms": "Alarms"},
                    {"office_controls_cctv": "CCTV"},
                    {"office_controls_swipe_cards": "Electronic access control (e.g., swipe cards)"},
                    {"office_controls_perimeter_security": "Perimeter security"}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_office_controls_swipe_cards",
                  "cond": "(office_facilities_excl_no || office_facilities_excl_yes) && !office_controls_swipe_cards",
                  "text": "Electronic access control is strongly recommended for office facilities that deal with confidential or sensitive data or have network-level access to it. Standard (non-electronic) keys are very difficult to control (short of changing the entire lock), and access is generally not logged in an auditable way.",
                  "warn": "yes",
                  "name": "No electronic access controls at the office",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "id": "office_policy",
                  "cond": "!office_facilities_home",
                  "text": "Do you have a written policy that lists the physical security requirements for office facilities?",
                  "defaultChoice": false,
                  "choices": [
                    {"office_policy_yes": "Yes"},
                    {"office_policy_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_office_policy",
                  "cond": "office_policy_no",
                  "text": "Having a written physical security policy helps ensure that all offices establish the same standards for protecting against unauthorized physical access. Because overall security is determined by the weakest link in the chain, a single noncompliant office may introduce risk to your company's (and customers') confidential and sensitive information.",
                  "warn": "yes",
                  "name": "No written policy for physical security at office",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "medium"
                },
                {
                  "type": "block",
                  "id": "block_access_control",
                  "cond": "office_controls_swipe_cards",
                  "text": "Access Control",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "office_access",
                      "text": "Do you have an auditable process in place for granting and revoking physical access to office facilities?",
                      "defaultChoice": false,
                      "choices": [
                        {"office_access_yes": "Yes"},
                        {"office_access_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_office_access",
                      "cond": "office_access_no",
                      "text": "Physical access to office facilities should be restricted, because a breach can affect the confidentiality, integrity, and availability of information. It's important to have an auditable process for granting and revoking physical access, and for reviewing physical entry logs.",
                      "warn": "yes",
                      "name": "No auditable procedures for physical security at office",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "office_acclogs",
                      "cond": "!office_facilities_home",
                      "text": "Are physical entry logs kept for at least six months?",
                      "defaultChoice": false,
                      "choices": [
                        {"office_acclogs_yes": "Yes"},
                        {"office_acclogs_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_office_acclogs",
                      "cond": "office_acclogs_no",
                      "text": "Unfortunately, security incidents (whether physical or logical) are not always immediately detected. It's important to retain physical access log files, typically for six months, in case they're needed for investigation.",
                      "warn": "yes",
                      "name": "No office access log retention",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "block",
                      "id": "block_entry_log_review",
                      "cond": "!office_facilities_home",
                      "text": "Entry Log Review",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "How often do you review physical entry logs?",
                          "defaultChoice": false,
                          "choices": [
                            {"office_acclogs_review_never": "Never"},
                            {"office_acclogs_review_quarterly": "Every couple of months"},
                            {"office_acclogs_review_monthly": "Once per month"},
                            {"office_acclogs_review_often": "More often"}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_office_acclogs_review_never",
                          "cond": "office_acclogs_review_never",
                          "text": "In data theft incidents, it is not always immediately obvious that data has been copied (after all, nothing is missing per se). To address this, physical access logs should be regularly reviewed so that irregularities can be quickly identified and investigated.",
                          "warn": "yes",
                          "name": "No office access log reviews",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "medium"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "office_network_room",
                  "cond": "!office_facilities_home",
                  "text": "Offices need a lot of networking equipment. If an attacker manages to gain access to such equipment, they could, for example, do a man-in-the-middle attack for all office traffic. It's important to protect access to network equipment like floor distributor switches, office routers, wireless APs, etc.",
                  "defaultChoice": false,
                  "choices": [
                    {"office_network_room_yes": "All of these are well protected and locked away. Only a few IT employees have physical access to networking equipment."},
                    {"office_network_room_no": "We don't protect access to office networking equipment."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_office_network_room",
                  "cond": "office_network_room_no",
                  "text": "Lack of protection for office network equipment can provide an attacker with a conveniently central place from which to attempt to breach your network. If someone manages to gain unauthorized physical access to office routers/distribution switches, they might be able to get around security controls (such as ARP-spoofing protections or 802.1x). It's best to lock away office networking equipment, to prevent unauthorized tempering.",
                  "warn": "yes",
                  "name": "No protection of office network equipment",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "medium"
                },
                {
                  "type": "box",
                  "id": "office_other",
                  "text": "Is there anything else you want us to know about the physical security at your office?"
                }
              ]
            },
            {
              "type": "block",
              "text": "Data Center Security",
              "items": [
                {
                  "type": "info",
                  "text": "<b>Why this section matters:</b> Most of a company's data should be stored and processed in a data center. The physical and environmental protections built into data centers are intended to provide a safe haven for data. This section asks questions about these security controls, to ensure they can provide adequate protection for confidential data."
                },
                {
                  "type": "line",
                  "id": "dc_howmany",
                  "text": "How many data centers will (potentially) be used to store confidential data?"
                },
                {
                  "type": "line",
                  "id": "dc_countries",
                  "text": "List all countries where data centers are located:"
                },
                {
                  "type": "checkgroup",
                  "id": "dc_outsourced",
                  "text": "Do you use Google Cloud, Amazon Web Services, or a similar outsourced, virtual-machine-based data center?",
                  "defaultChoice": false,
                  "choices": [
                    {"dc_outsourced_yes": "Yes."},
                    {"dc_outsourced_no": "No, we maintain our own data centers."}
                  ]
                },
                {
                  "type": "line",
                  "id": "dc_provider",
                  "cond": "dc_outsourced_yes",
                  "text": "Who is your data center provider?"
                },
                {
                  "type": "block",
                  "cond": "dc_outsourced_no",
                  "text": "Running Own Data Centers",
                  "items": [
                    {
                      "id": "dc_facilities_excl",
                      "text": "Are all facilities used exclusively by your company, or are some shared?",
                      "type": "radiogroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_facilities_excl_yes": "Yes, we are the only user of all data centers that potentially store confidential data."},
                        {"dc_facilities_excl_no": "No, some or all of the facilities are shared with other companies."}
                      ]
                    },
                    {
                      "type": "box",
                      "id": "dc_facilities_equipment_separated",
                      "cond": "dc_facilities_excl_no",
                      "text": "How is your equipment separated from other users of the facility?"
                    },
                    {
                      "type": "line",
                      "id": "dc_certifications",
                      "text": "Are the data centers categorized in tiers or certified in some way (e.g., TIA-942, ISO 27001, SSAE-16, etc.)? If yes, list the tiers/certifications:"
                    },
                    {
                      "id": "dc_policy",
                      "text": "Do you have a written policy that lists the physical security requirements for data centers?",
                      "type": "radiogroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_policy_yes": "Yes"},
                        {"dc_policy_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_dc_policy",
                      "cond": "dc_policy_no",
                      "text": "When strong physical security controls are in place, certain requirements that are usually recommended (e.g., encryption of data at rest) may be relaxed. These exceptions are acceptable only if specific security controls are  implemented in all data centers that may store confidential information. A written policy describing these requirements should be enforced to ensure that a baseline for physical security is uniformly implemented across all data centers.",
                      "warn": "yes",
                      "name": "No written physical security policy",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "checkgroup",
                      "text": "Select the security controls that are in place at <i>all</i> of your data centers:",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_controls_guards": "Guards"},
                        {"dc_controls_mantrap": "Mantrap"},
                        {"dc_controls_motiondetectors": "Motion detectors"},
                        {"dc_controls_alarms": "Alarms"},
                        {"dc_controls_cctv": "CCTV"},
                        {"dc_controls_electronic_access_control": "Electronic access control (e.g., swipe cards)"},
                        {"dc_controls_perimetersec": "Perimeter security"}
                      ]
                    },
                    {
                      "type": "checkgroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_controls_ups": "UPS batteries"},
                        {"dc_controls_generator": "Backup generators"},
                        {"dc_controls_water_detection": "Water detection system"},
                        {"dc_controls_fire_detection": "Fire detection system"},
                        {"dc_controls_fire_suppression_gas": "Gas-based fire suppression system"},
                        {"dc_controls_fire_suppression_water": "Water-based fire suppression system"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_dc_controls_electronic_access_control",
                      "cond": "!dc_controls_electronic_access_control",
                      "text": "Electronic access control is strongly recommended for data centers that handle or store confidential or sensitive data. Standard (non-electronic) keys are very difficult to control (short of changing the entire lock), and access is generally not logged in an auditable way.",
                      "warn": "yes",
                      "name": "No electronic access control",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "id": "dc_testing",
                      "text": "Are all of the controls you selected above tested at least annually?",
                      "type": "radiogroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_testing_yes": "Yes"},
                        {"dc_testing_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_dc_testing",
                      "cond": "dc_testing_no",
                      "text": "Make sure to put procedures in place to regularly verify that security controls are working as intended.",
                      "warn": "yes",
                      "name": "Security controls in data centers not tested",
                      "why": "List the controls that are not regularly tested, and explain whether you have compensating controls in place:",
                      "severity": "high"
                    },
                    {
                      "id": "dc_monitoring",
                      "text": "Do all data centers have monitoring and alerting in place for power supply, HVAC, and temperature?",
                      "type": "radiogroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_monitoring_yes": "Yes"},
                        {"dc_monitoring_no": "No"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_dc_monitoring",
                      "cond": "dc_monitoring_no",
                      "text": "HVAC and temperature inside data centers should be monitored, and appropriate personnel should be informed when they are outside normal ranges.",
                      "warn": "yes",
                      "name": "Data center security controls not monitored",
                      "why": "If you have compensating controls in place, such as automatic failover to another data center, please explain below:",
                      "severity": "high"
                    },
                    {
                      "type": "block",
                      "id": "block_dc_access_control",
                      "cond": "dc_controls_electronic_access_control",
                      "text": "Access Control",
                      "items": [
                        {
                          "id": "dc_access",
                          "text": "Do you have an auditable process in place for granting and revoking physical access to data centers?",
                          "type": "radiogroup",
                          "defaultChoice": false,
                          "choices": [
                            {"dc_access_yes": "Yes"},
                            {"dc_access_no": "No"}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_dc_access",
                          "cond": "dc_access_no",
                          "text": "Physical access to data center facilities should generally be highly restricted, because a breach can affect confidentiality, integrity, and availability of information. It's important to have an auditable process for granting and revoking physical access, and for reviewing physical entry logs. Otherwise it won't be possible to determine at any given time who actually has access to the data center and the data stored within it.",
                          "warn": "yes",
                          "name": "No auditable procedures for data center access",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "high"
                        },
                        {
                          "id": "dc_acclogs",
                          "text": "Are physical entry logs kept for at least six months?",
                          "type": "radiogroup",
                          "defaultChoice": false,
                          "choices": [
                            {"dc_acclogs_yes": "Yes"},
                            {"dc_acclogs_no": "No"}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_dc_acclogs",
                          "cond": "dc_acclogs_no",
                          "text": "Unfortunately, security incidents (whether physical or logical) are not always immediately detected. It's important to retain physical access log files, typically for six months, in case they're needed for investigation.",
                          "warn": "yes",
                          "name": "No data center access log retention",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "medium"
                        },
                        {
                          "type": "block",
                          "id": "block_entry_logs",
                          "text": "Entry Logs Review",
                          "items": [
                            {
                              "type": "radiogroup",
                              "defaultChoice": false,
                              "choices": [
                                {"dc_acclogs_review_never": "Never"},
                                {"dc_acclogs_review_quarterly": "Every couple of months"},
                                {"dc_acclogs_review_monthly": "Once per month"},
                                {"dc_acclogs_review_often": "More often"}
                              ],
                              "text": "How often do you review physical entry logs?"
                            },
                            {
                              "type": "tip",
                              "id": "warn_dc_acclogs_review_never",
                              "cond": "dc_acclogs_review_never",
                              "text": "In data theft incidents, it is not always immediately obvious that data has been copied (after all, nothing is missing per se). To address this, physical access logs should be regularly reviewed so that irregularities can be quickly identified and investigated.",
                              "warn": "yes",
                              "name": "No data center access log reviews",
                              "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                              "severity": "medium"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "id": "dc_outage",
                      "text": "Even the most advanced and protected data centers have occasional outages. Depending on the availability requirements of your project, it might be necessary to quickly switch to another data center so that operations can be resumed without excessive downtime.",
                      "type": "radiogroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_outage_yes": "We are able to quickly route traffic to another data center (within one hour)."},
                        {"dc_outage_no": "We would need more than one hour to resume our service in case of a data center outage."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_dc_outage",
                      "cond": "dc_outage_no",
                      "text": "If availability is a strong concern for your project, you should make sure you're able to quickly switch to a different data center that is not geographically close to the one that's experiencing the outage.",
                      "warn": "yes",
                      "name": "No data center outage procedures",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "id": "dc_ra",
                      "text": "Does your company review the physical and environmental risks that your data centers are exposed to, and do you have procedures in place to evaluate and, if necessary, address them?",
                      "type": "radiogroup",
                      "defaultChoice": false,
                      "choices": [
                        {"dc_ra_yes": "Yes, we do risk assessments or &mdash; if hosted with a colocation provider &mdash; review our provider's security practices."},
                        {"dc_ra_no": "No, we don't."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_dc_ra",
                      "cond": "dc_ra_no",
                      "text": "To ensure that current security controls are adequate, it's important to assess the physical and environmental risks that your data center (or data center provider) is exposed to.",
                      "warn": "yes",
                      "name": "Environmental risks in data center not monitored",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    }
                  ]
                },
                {
                  "type": "box",
                  "id": "dc_other",
                  "text": "Is there anything else you want us to know about the security of your data centers?"
                }
              ]
            },
            {
              "type": "block",
              "id": "block_feedback",
              "text": "Feedback",
              "items": [
                {
                  "type": "box",
                  "id": "feedback",
                  "text": "<b>Good news!</b> You have made it to the end of this questionnaire. If you can spare another minute, please let us know how we can improve it. Any feedback is highly appreciated."
                }
              ]
            }
          ]
        },
        {
          "type": "block",
          "text": "Infrastructure Modification",
          "id": "block_infrastructure",
          "cond": "scenario_infrastructure",
          "items": [
            {
              "type": "block",
              "text": "Questionnaire Options",
              "items": [
                {
                  "type": "info",
                  "text": "Select the options that describe your project. These settings configure the questionnaire to fit different scenarios."
                },
                {
                  "type": "checkgroup",
                  "id": "options",
                  "defaultChoice": false,
                  "choices": [
                    {"req_sensitive": "<b>Sensitive data</b>: This project involves processing Personally Identifiable Information (PII), Sensitive PII, or other information your customers may consider sensitive."},
                    {"req_nodata": "<b>Remote access only</b>: All information processing occurs on your customers' systems, and this project accesses those systems remotely."}
                  ]
                }
              ]
            },
            {
              "type": "block",
              "id": "block_network",
              "text": "Network",
              "items": [
                {
                  "type": "info",
                  "text": "<b>Why this section matters:</b> Your network is the foundation of your IT infrastructure and the first line of defense against external attackers. If the devices that make up your network are not adequately maintained and secured, an attacker might gain access to confidential information."
                },
                {
                  "type": "radiogroup",
                  "id": "network_config_guidelines",
                  "text": "It's essential to have a written set of guidelines for the configuration, maintenance, and use of your network. Written guidelines and rules help preserve the availability, integrity, and confidentiality of the network itself, and well as the information transmitted over it.",
                  "defaultChoice": false,
                  "choices": [
                    {"network_config_guidelines_yes": "We have clearly defined network guidelines. They are regularly reviewed and applied to all appropriate networking devices."},
                    {"network_config_guidelines_no": "We don't currently have guidelines, or they're not consistently applied."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_network_config_guidelines",
                  "cond": "network_config_guidelines_no",
                  "text": "<p>It's important to follow a strict set of guidelines for maintaining, configuring, and using network devices. Common topics to address:</p><ul><li>Acceptable networking devices</li><li>Protocol requirements (for example, strong authentication, encrypted data)</li><li>Monitoring standards</li><li>Change management requirements</li><li>Firewall policy</li></ul>",
                  "warn": "yes",
                  "name": "No hardening guidelines for network infrastructure",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "id": "network_firewalls",
                  "text": "Firewalls are a basic network security control. Does your company use firewalls to restrict traffic into and out of your network at strategic points?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_firewalls_yes": "Yes, we have firewalls for filtering all inbound and outbound traffic."},
                    {"network_firewalls_no": "We do not use firewalls."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_network_firewalls",
                  "cond": "network_firewalls_no",
                  "text": "Even small networks should be protected by firewalls that are configured to filter both incoming and outgoing traffic, and to allow only those services that have been explicitly whitelisted. Firewalls provide a great basic defense layer, and they are rather easy to configure and maintain.",
                  "warn": "yes",
                  "name": "Lack of firewall",
                  "why": "Explain why firewalls are not necessary in your setup:",
                  "severity": "critical"
                },
                {
                  "type": "block",
                  "id": "block_firewalls",
                  "cond": "network_firewalls_yes",
                  "text": "Firewalls",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "network_dmz",
                      "text": "Does your company place all externally exposed systems in a DMZ, separated from the internal network by a network filter?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_dmz_yes": "Yes, all of our externally exposed systems are hosted in a DMZ and separate from our internal systems."},
                        {"network_dmz_no": "Some of our exposed systems may be on the internal network."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_network_dmz",
                      "cond": "network_dmz_no",
                      "text": "A <a href=\"http://en.wikipedia.org/wiki/DMZ_(computing)\">DMZ</a> (demilitarized zone) is a subnetwork for systems that are exposed to an untrusted network (i.e., the Internet). The purpose of a DMZ is to ensure that even if an externally exposed system is compromised, the attacker only has access to systems within the DMZ &mdash; not the internal network. Without a DMZ in place, a single missing security patch or a 0-day vulnerability in one of the exposed services can lead to a full compromise of the internal network.",
                      "warn": "yes",
                      "name": "Externally exposed systems on internal network",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "network_separation",
                      "text": "Does your company implement a network zoning concept that separates systems by function, value, and risk level?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_separation_yes": "Yes, we operate multiple network zones, separated by filters, that group systems by their value, function, or risk level."},
                        {"network_separation_no": "No, all of our systems are hosted in a single zone and have network-level access to each other."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_network_separation",
                      "cond": "network_separation_no",
                      "text": "A network zoning concept that groups and separates systems can help tremendously in the event of a system compromise. Confining an attacker to a zone ensures that even if that zone is lost, other systems that may be more valuable are still protected. Unless your network is very small, zoning is essential and is difficult to replace with other security controls. Without zoning, a compromise in a completely unrelated system might expose our confidential information.",
                      "warn": "yes",
                      "name": "No appropriate network zoning",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "network_encryption",
                  "text": "Is encryption and integrity protection in place for all internal network traffic that potentially carries sensitive information (including passwords, emails, files, source code, management traffic, etc.)?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_encryption_yes": "Yes"},
                    {"network_encryption_no": "Some unencrypted protocols may carry sensitive information."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_network_encryption",
                  "cond": "network_encryption_no",
                  "text": "<p>Traffic sniffing is usually easily done, both within and outside of the internal network. Even on switched networks, an attacker can use ARP spoofing to route other systems' network packets through their computer and read the contents on the way through. The only effective protection is cryptography. All sensitive traffic should be both encrypted and signed: encrypted to protect against eavesdropping, and signed to make sure an attacker cannot simply modify the content of the transmitted messages.</p><p>Encrypted protocols are readily available for most purposes. In addition, many protocols &mdash; even those originally conceived as plain-text protocols &mdash; can be tunneled through SSL/TLS to add an encrypted and signed layer.</p><p>Encryption must be in place to protect confidential information that is transmitted over the network.</p>",
                  "warn": "yes",
                  "name": "Not all important network traffic encrypted",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "id": "block_plaintext",
                  "cond": "network_encryption_no",
                  "text": "Compensating Controls for Plain-Text Protocols",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "Select the purposes for which you're using unencrypted networking protocols:",
                      "defaultChoice": false,
                      "choices": [
                        {"network_encryption_protocols_management": "Device management (e.g., telnet, writable SNMP, plain-text HTTP, etc.)"},
                        {"network_encryption_protocols_monitoring": "Monitoring (e.g., read-only SNMP, plain-text HTTP, etc.)"},
                        {"network_encryption_protocols_filetransfer": "File transfer (e.g., NFS, plain-text WebDAV, etc.)"},
                        {"network_encryption_protocols_other": "Other"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_encryption_protocols_management",
                      "cond": "network_encryption_protocols_management",
                      "text": "You should never use plain-text protocols for remote device administration and management. These protocols should use encryption to protect credentials passing over the network, and they should also protect the integrity of the transmitted commands in order to guard against manipulation.",
                      "warn": "yes",
                      "name": "Plain-text protocols used for network management",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_encryption_protocols_monitoring",
                      "cond": "network_encryption_protocols_monitoring",
                      "text": "In monitoring contexts, encryption requirements depend on the sensitivity of the information made accessible by the protocol. If sensitive information can be fetched, the protocol should be encrypted. Information gathered through monitoring interfaces can be highly valuable to an attacker; it often contains network and server details that can be used in subsequent attacks.",
                      "warn": "yes",
                      "name": "Plain-text protocols used for network monitoring",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_encryption_protocols_filetransfer",
                      "cond": "network_encryption_protocols_filetransfer",
                      "text": "Protocols that allow access to files on the network should generally be encrypted, unless all of the information on the associated network shares is public. Unencrypted protocols for file access put both the confidentiality and the integrity of data at risk because an attacker can not only steal the information, but also modify it.",
                      "warn": "yes",
                      "name": "Plaintext protocols used for file access",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "box",
                      "id": "network_unencrypted_protocols",
                      "text": "Describe the unencrypted protocols that might carry sensitive information. Explain why these protocols cannot be replaced by encrypted variants, and what measures you have taken to ensure that these protocols cannot be used to endanger our confidential information."
                    },
                    {
                      "type": "radiogroup",
                      "id": "network_arpspoofing",
                      "text": "Do you have controls in place to protect your systems from <a href='http://en.wikipedia.org/wiki/ARP_spoofing'>ARP spoofing</a>?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_arpspoofing_yes": "Yes, our switches protect against ARP spoofing, and where this feature is not available, we monitor for spoofed ARP packets in order to quickly identify attacks."},
                        {"network_arpspoofing_no": "Not all of our network zones are protected against ARP spoofing."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_arpspoofing",
                      "cond": "network_arpspoofing_no",
                      "text": "<p>ARP spoofing was conceived to allow sniffing even on switched networks that don't send all traffic to a subnet. Because the ARP protocol does not have integrity protection, the attack is trivial.</p><p>Luckily, ARP spoofing is relatively easy to prevent, and even easier to identify. Switches that are capable of working on the IP layer have built-in defenses against this attack (they register when systems on two different ports claim the same IP address). Additionally, open source tools such as <a href='http://en.wikipedia.org/wiki/Arpwatch'>arpwatch</a> can be used to identify an active attack and send out alerts.</p><p>It's very important to have controls in place to protect against this kind of attack.</p>",
                      "warn": "yes",
                      "name": "No adequate protection against ARP spoofing",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "network_management_segment",
                      "cond": "network_encryption_protocols_management",
                      "text": "Do you have a separate management network for managing network devices?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_management_segment_yes": "Yes, management of networking devices is done through a separate network with strong access restrictions (e.g., 802.1x, or additional physical security for ports that allow access to the management network). All management interfaces of networking devices are only accessible from the management network."},
                        {"network_management_segment_no": "No, management interfaces for networking devices are accessible from the regular network."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_management_segment",
                      "cond": "network_management_segment_no",
                      "text": "<p>A separate network for device management can help mitigate the risk associated with devices that do not support encrypted protocols. The dedicated management zone should generally not be routable from the regular internal network, and access to the zone should be restricted. Restriction methods include access control (such as 802.1x) and physical port protection.</p><p>For sensitive projects, it's best if networking devices are either administered exclusively through encrypted and integrity-protected protocols, or are managed through a separate and protected management network.</p>",
                      "warn": "yes",
                      "name": "No separate network for device management",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "network_monitoring",
                  "text": "Have you implemented monitoring and alerting for your network?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_monitoring_yes": "Yes"},
                    {"network_monitoring_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_network_monitoring",
                  "cond": "network_monitoring_no",
                  "text": "<p>It's essential to monitor your network for events that may affect the availability, integrity, and confidentiality of data. Network events are numerous and varied, so it's important to find the right signals for your company's infrastructure, architecture, and services.</p><p>It's extremely important to understand what's happening on your network, and to identify security events. Not only should you monitor your network and its events, but you also need to identify people to alert when important signals occur.</p>",
                  "warn": "yes",
                  "name": "No monitoring and alerting for network",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "id": "block_network_monitoring",
                  "cond": "network_monitoring_yes",
                  "text": "Network Monitoring",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "network_monitoring_availability",
                      "text": "Do you monitor the availability of your network and the devices on it?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_monitoring_availability_yes": "Yes, we watch the network for outages, and we alert the right people when issues occur."},
                        {"network_monitoring_availability_no": "No, the availability of our network is not monitored or not sufficiently monitored."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_network_monitoring_availability",
                      "cond": "network_monitoring_availability_no",
                      "text": "<p>It's important to monitor your network for events that may affect the availability of your (and our) data. Monitoring helps ensure that outages are swiftly identified and addressed.</p>",
                      "warn": "yes",
                      "name": "Network availability not monitored",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "network_monitoring_security",
                      "text": "Do you monitor your network for security events?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_monitoring_security_yes": "Yes, we monitor for unauthorized access, unexpected behavior, certain attack signatures, and other indicators of a security incident."},
                        {"network_monitoring_security_no": "We do not currently have extensive monitoring for security incidents on our network."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_network_monitoring_security",
                      "cond": "network_monitoring_security_no",
                      "text": "<p>Monitoring and alerting is strongly recommended, to ensure that unauthorized access and other security incidents are swiftly identified and addressed.</p><p>Note that this does not necessarily mean you need an intrusion detection/prevention system (IDS/IPS) on your network. In many cases, it can be just as effective to identify specific and custom signals that indicate a potential incident.</p>",
                      "warn": "yes",
                      "name": "Security events on network not monitored",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "network_monitoring_logging",
                      "text": "Do you retain logs produced by networking devices (such as firewalls, routers, DNS servers, DHCP servers, etc.) for at least six months, and do you monitor them regularly?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_monitoring_logging_yes": "Yes, we regularly review these logs and retain them in case we need to investigate an incident."},
                        {"network_monitoring_logging_no": "No, these logs are not retained and/or monitored."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_network_monitoring_logging",
                      "cond": "network_monitoring_logging_no",
                      "text": "<p>Log files from devices like firewalls, DNS servers, DHCP servers, and routers are indispensable in the event of a security incident. They're also a great source of signals to help identify security-impacting events in the first place. Network devices should produce adequate log files that are retained for at least six months, so that historic events can also be appropriately investigated.</p>",
                      "warn": "yes",
                      "name": "Short retention period for network logs",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "network_centrallogging",
                      "text": "Are the logs produced by networking devices (such as firewalls, DNS servers, DHCP servers, routers, etc.) stored in a central location?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_centrallogging_yes": "Yes, all devices that support logging write logs to one or more dedicated log systems."},
                        {"network_centrallogging_no": "No, each device stores log files separately."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_network_centrallogging",
                      "cond": "network_centrallogging_no",
                      "text": "<p>With a central log collection location for all relevant networking systems, you can more easily correlate security-impacting events across multiple sources. Centralizing also simplifies log review. For sensitive projects, a central logging system is strongly recommended.</p>",
                      "warn": "yes",
                      "name": "Network devices log collection not centralized",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "network_wifi",
                  "text": "Do you operate wireless networks that allow access to private aspects of your infrastructure (i.e., Wi-Fi networks, excluding networks that only allow guests access to the Internet)?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_wifi_yes": "Yes."},
                    {"network_wifi_no": "No, we only have Wi-Fi networks that allow guests to access the Internet; they don't have access to any private aspects of our infrastructure."}
                  ]
                },
                {
                  "type": "block",
                  "id": "block_wifi",
                  "cond": "network_wifi_yes",
                  "text": "Wireless Networking",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "How are your wireless networks encrypted? (If you have multiple Wi-Fi networks, choose the weakest encryption that gives access to an internal network.)",
                      "defaultChoice": false,
                      "choices": [
                        {"network_wifi_enc_no": "No encryption"},
                        {"network_wifi_enc_wep": "WEP"},
                        {"network_wifi_enc_wpapsk": "WPA/WPA2 with a preshared key (WPA[2]-PSK)"},
                        {"network_wifi_enc_wpaenterprise": "WPA/WPA2 with RADIUS authentication (WPA[2]-Enterprise)"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_wifi_enc_bad",
                      "cond": "network_wifi_enc_no || network_wifi_enc_wep",
                      "text": "<p>Because your Wi-Fi can be used to access a private/internal network, no encryption or WEP encryption is not sufficient. WEP was broken years ago and does not offer any real protection. Enterprise environments require WPA2-Enterprise.</p>",
                      "warn": "yes",
                      "name": "Inadequate WiFi network protection",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "critical"
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_wifi_enc_psk",
                      "cond": "network_wifi_enc_wpapsk",
                      "text": "WPA-PSK is not suitable for a corporate environment: on the one hand, one user on the network can sniff all other users' traffic, and on the other hand, the management of the preshared key is usually very challenging because it must be changed when an employee leaves the company. For companies that would need to share the key with 20 or more employees, the use of WPA/WPA2-Enterprise is strongly recommended instead.",
                      "warn": "yes",
                      "name": "Inadequate WiFi network protection",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "network_vpn",
                  "text": "Do you operate a VPN that allows remote access to your network?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_vpn_yes": "Yes"},
                    {"network_vpn_no": "No"}
                  ]
                },
                {
                  "type": "block",
                  "id": "block_vpn",
                  "cond": "network_vpn_yes",
                  "text": "VPN/Remote Network Access",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "How is access to the VPN authenticated? (Check all that apply.)",
                      "defaultChoice": false,
                      "choices": [
                        {"network_vpn_auth_pwd": "Username and password"},
                        {"network_vpn_auth_machine_cert_os": "Machine certificate, stored by the operating system or on the file system"},
                        {"network_vpn_auth_machine_cert_tpm": "Machine certificate, stored in a Trusted Platform Module (TPM)"},
                        {"network_vpn_auth_2nd_factor": "Second factor (e.g., token)"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_vpn_no2ndfactor",
                      "cond": "req_sensitive && network_vpn_auth_pwd && !network_vpn_auth_2nd_factor",
                      "text": "Because your project seems to handle sensitive data, remote access to your internal network via VPN should be protected by strong authentication, such as a second factor or machine certificates stored on the system's TPM.",
                      "warn": "yes",
                      "name": "No 2nd factor for VPN access",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_vpn_nostrongauth",
                      "cond": "network_vpn_auth_pwd && !network_vpn_auth_machine_cert_os && !network_vpn_auth_machine_cert_tpm && !network_vpn_auth_2nd_factor && !^warn_network_vpn_no2ndfactor",
                      "text": "VPN authentication with a username and password alone is considered insufficient. It is very easy to phish users, and password reuse across services is extremely common (even when policies are in place to explicitly disallow password reuse). Remote access to the internal network should require strong authentication, such as a second factor and/or machine certificates (ideally stored in a TPM). The latter have an additional advantage: certificates are not easily transferred to non-corporate machines.",
                      "warn": "yes",
                      "name": "Insufficient authentication for VPN access",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_vpn_nopwd",
                      "cond": "!network_vpn_auth_pwd && (network_vpn_auth_machine_cert_os || network_vpn_auth_machine_cert_tpm || network_vpn_auth_2nd_factor)",
                      "text": "Using this authentication method without at least a username and password is highly unusual. Did you forget to check the \"Username and password\" box?",
                      "warn": "yes",
                      "why": "If your VPN really doesn't require username and password credentials for authentication, explain why below:"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Is it possible for devices that are not owned and managed by your company to connect to your internal network remotely through VPN?",
                      "defaultChoice": false,
                      "choices": [
                        {"network_vpn_noncorp_yes": "Yes."},
                        {"network_vpn_noncorp_policy": "No, this is prohibited by policy."},
                        {"network_vpn_noncorp_technical": "No, this is prevented by technical measures."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_vpn_noncorp",
                      "cond": "network_vpn_noncorp_yes || (network_vpn_noncorp_policy && req_sensitive)",
                      "text": "Because non-corporate machines cannot be centrally updated, managed, and malware-checked, allowing these machines access to the local network via VPN is extremely dangerous. Please ensure that technical controls are in place to prevent unmanaged machines from connecting via VPN.",
                      "warn": "yes",
                      "name": "Access to VPN from non-corporate machines",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "tip",
                      "id": "warn_network_vpn_noncorp_technical",
                      "cond": "network_vpn_noncorp_technical && !network_vpn_auth_machine_cert_tpm && !network_vpn_auth_machine_cert_os && req_sensitive",
                      "text": "Because non-corporate machines cannot be centrally updated, managed, and malware-checked, allowing these machines access to the local network via VPN is extremely dangerous. You've indicated that technical controls exist but you don't use a certificate. Describe the controls that are in place.",
                      "warn": "yes",
                      "name": "Access to VPN from non-corporate machines",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "network_outsourced",
                  "text": "Is the management of your network (or parts thereof) outsourced?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_outsourced_yes": "Yes"},
                    {"network_outsourced_no": "No"}
                  ]
                },
                {
                  "type": "line",
                  "id": "network_outsourced_company",
                  "cond": "network_outsourced_yes",
                  "text": "What company is network management outsourced to?"
                },
                {
                  "type": "radiogroup",
                  "id": "network_outsourced_audits",
                  "cond": "network_outsourced_yes",
                  "text": "Do you regularly audit your outsourcing provider to ensure compliance with the policies you set, and the use of safe security practices?",
                  "defaultChoice": false,
                  "choices": [
                    {"network_outsourced_audits_yes": "Yes, we audit our outsourcing providers at least annually."},
                    {"network_outsourced_audits_no": "We don't audit our outsourcing providers as often as we probably should."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_network_outsourced_audits",
                  "cond": "network_outsourced_audits_no",
                  "text": "To ensure that outsourcing providers adhere to your policies and employ adequate security practices, it's important to regularly audit them. These security audits should be done at least annually so the providers can adapt to changing security requirements and identify possible issues quickly.",
                  "warn": "yes",
                  "name": "Outsourcing providers not audited",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "box",
                  "id": "network_other",
                  "text": "Do you have any other comments about the security of your network? If yes, please provide them below:"
                }
              ]
            },
            {
              "type": "block",
              "id": "block_servers",
              "text": "Servers",
              "items": [
                {
                  "type": "info",
                  "text": "<b>Why this section is relevant:</b> Servers are an important piece of the overall attack surface of any IT infrastructure. Even seemingly less-sensitive systems should be carefully evaluated, because a single poorly configured system can help an attacker get a foot in the door. From there, they might gain access to more sensitive systems nearby (other servers, clients, etc.)."
                },
                {
                  "type": "radiogroup",
                  "id": "servers_hardening",
                  "text": "Do you have operating system hardening in place, or build standards for server systems?",
                  "defaultChoice": false,
                  "choices": [
                    {"servers_hardening_yes": "Yes, all of our servers are configured according to these standards."},
                    {"servers_hardening_no": "We do not have these standards, or we don't apply them uniformly across the fleet."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_servers_hardening",
                  "cond": "servers_hardening_no",
                  "text": "<p>A set of hardening and/or build standards for servers helps to ensure that all systems are appropriately hardened. These standards should be applied to internally and externally exposed systems, and should include requirements such as:</p><ul><li>Removing or disabling all non-essential services</li><li>Disabling all default accounts and/or changing the password</li><li>Review/tightening of permissions for key files and directories</li><li>Setting up logging</li><li>Securely configuring remote access and management interfaces</li><li>Setting up appropriate host-based firewall rules</li><li>Securely configuring a backup mechanism</li></ul><p></p><p>You probably won't have to create these standards from scratch. Publicly available hardening guides can help you set requirements for your company's systems.</p>",
                  "warn": "yes",
                  "name": "No hardening guidelines for servers",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "cond": "servers_hardening_yes",
                  "text": "Hardening and Build Standards",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "servers_hardening_requirements",
                      "text": "<p>Do your hardening and build standards cover the following topics?</p><ul><li>Removing or disabling all non-essential services</li><li>Disabling all default accounts and/or changing the password</li><li>Review/tightening of permissions for key files and directories</li><li>Setting up logging</li><li>Securely configuring remote access and management interfaces</li><li>Setting up appropriate host-based firewall rules</li><li>Securely configuring a backup mechanism</li></ul>",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_hardening_requirements_yes": "Yes, these are all pretty much covered by our standards."},
                        {"servers_hardening_requirements_no": "No, we might have missed a few of these."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_hardening_requirements",
                      "cond": "servers_hardening_requirements_no",
                      "text": "The topics listed in this question should be part of any set of hardening and build standards. You probably won't have to create these standards from scratch. Publicly available hardening guides can help you set requirements for your company's systems.",
                      "warn": "yes",
                      "name": "Inadequate hardening guidelines for servers",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_hardening_intandext",
                      "text": "Are your hardening and build standards applied to both internal servers and externally exposed systems, and all services that run on them?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_hardening_intandext_yes": "Yes"},
                        {"servers_hardening_intandext_no": "No, we apply them only to externally exposed servers."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_hardening_intandext",
                      "cond": "servers_hardening_intandext_no",
                      "text": "Even though internal servers (and the services they provide) might not be directly exposed to the Internet, it is important to harden them as a second layer of defense. If an attacker manages to compromise a single system, it should still be difficult for them to expand their access. Also, internal servers might be exposed indirectly as backends.",
                      "warn": "yes",
                      "name": "Hardening guidelines not applied to internal servers",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_hardening_requirements_writing",
                      "text": "Are your hardening and build standards documented?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_hardening_requirements_writing_yes": "Yes, we document our hardening and build standards, and we make sure they are consistently applied."},
                        {"servers_hardening_requirements_writing_no": "No, our hardening and build standards haven't been written down."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_hardening_requirements_no_writing",
                      "cond": "servers_hardening_requirements_writing_no",
                      "text": "Because your project seems to handle sensitive data, it's important to document your hardening and build standards. Documentation helps ensure that standards are consistently applied, no matter which employee actually performs the hardening.",
                      "warn": "yes",
                      "name": "Hardening guidelines not documented in writing",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_configmgmt",
                      "text": "Do you have processes in place for managing the configuration of your servers and services?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_configmgmt_yes": "Yes, we have processes in place to ensure that configuration updates are deployed consistently across the entire fleet. Our processes are comprehensive, so it's very unlikely that any systems will be overlooked during important configuration changes."},
                        {"servers_configmgmt_no": "No, our servers are configured on an ad-hoc basis. The processes for rolling out updates to all of our servers could be improved."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_configmgmt",
                      "cond": "servers_configmgmt_no",
                      "text": "Server and service configuration tends to become more complex over time. Without established processes, configuration can become inconsistent among similar systems within the fleet. This is a common source of security issues: some systems are overlooked and continue to have issues that are caused by the configuration. Because your project has stricter requirements for confidentiality, integrity, and/or availability, it's important to establish configuration management processes.",
                      "warn": "yes",
                      "name": "No appropriate processes for configuration management",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_configmgmt_audit",
                      "cond": "servers_configmgmt_yes",
                      "text": "Do you review and/or audit your configuration files, to ensure that they conform to your security policies?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_configmgmt_audit_yes": "Yes, the configuration files of important systems are regularly reviewed or audited."},
                        {"servers_configmgmt_audit_no": "No; unless there is a specific reason to look at them, configuration files are rarely reviewed."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_configmgmt_audit",
                      "cond": "servers_configmgmt_audit_no",
                      "text": "Your project seems to handle sensitive data. Processes should be in place for regularly reviewing configuration files and settings, to ensure that they are appropriate and safe.",
                      "warn": "yes",
                      "name": "Configuration files not audited",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "servers_patching",
                  "text": "Do you have a process for installing operating system and application updates and security patches on servers?",
                  "defaultChoice": false,
                  "choices": [
                    {"servers_patching_yes": "Yes, we are very diligent about applying security updates to operating systems and applications."},
                    {"servers_patching_no": "No, we don't have a process for patching. Some updates might fall through the cracks."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_servers_patching",
                  "cond": "servers_patching_no",
                  "text": "Unfortunately, security bugs and vulnerabilities cannot always be caught during the development process, particularly if the software is complex. Software vendors often issue patches and security fixes to address vulnerabilities that were identified after rollout. It is essential to have processes in place to monitor vulnerabilities in software and apply patches as soon as possible. Note that once a patch has been released, the vulnerability is public, so attackers can easily exploit it.",
                  "warn": "yes",
                  "name": "Lack of patch/updates process",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "critical"
                },
                {
                  "type": "block",
                  "id": "block_server_updates",
                  "cond": "servers_patching_yes",
                  "text": "Security Updates and Vulnerability Management",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "servers_patching_schedule_exceptions",
                      "text": "Do you also have an emergency process for installing patches outside of the regular patching schedule when high-risk vulnerabilities are identified?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_patching_schedule_exceptions_yes": "Yes, we carefully consider the risk associated with each new vulnerability and decide whether the patch should be deployed outside of the regular schedule."},
                        {"servers_patching_schedule_exceptions_no": "No, we generally don't deviate from our standard patching schedule, even for critical vulnerabilities."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_patching_schedule_exceptions",
                      "cond": "servers_patching_schedule_exceptions_no",
                      "text": "Not all patches are equally important; some must be installed very quickly to protect against likely compromise. Your patching process should include carefully considering the risk caused by each vulnerability, and triggering emergency procedures when appropriate so that affected systems are patched as soon as possible.",
                      "warn": "yes",
                      "name": "No emergency patch application procedures",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "checkgroup",
                      "text": "How do you determine whether your systems are affected by vulnerabilities that require patching? (Check all that apply.)",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_patching_infosource_scanning": "We use automated security scans to find software that requires patching."},
                        {"servers_patching_infosource_mailinglists": "The employees who are responsible for patching subscribe to vendor mailing lists that inform them about security issues."},
                        {"servers_patching_infosource_osupdate": "We use the patching mechanisms that are built into the operating systems (e.g., Windows Update, apt-get, Red Hat Network, etc.)."},
                        {"servers_patching_infosource_outsourced": "We hired a company that specializes in informing customers about vulnerabilities in the software they use."},
                        {"servers_patching_infosource_other": "We use a method not listed here."}
                      ]
                    },
                    {
                      "type": "box",
                      "id": "servers_patching_infosource_other_explain",
                      "cond": "servers_patching_infosource_other",
                      "text": "Describe your method for finding out which patches apply to your systems:"
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_patching_infosource_osupdate_only",
                      "cond": "servers_patching_infosource_osupdate && !servers_patching_infosource_other && !servers_patching_infosource_outsourced && !servers_patching_infosource_mailinglists && !servers_patching_infosource_scanning",
                      "text": "Relying on the update mechanism built into the operating system is generally not sufficient; typically, many applications are not covered. You should maintain an inventory of all software that is not covered by built-in updates, and your administrators should subscribe to the key sources of information on updates for that software.",
                      "warn": "yes",
                      "name": "Not all software covered by existing patch management solutions",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_patching_tests",
                      "text": "Do you test security patches before you deploy them to your production systems?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_patching_tests_yes": "Yes, for important servers we have systems that we test patches on before deploying them to production."},
                        {"servers_patching_tests_no": "No, patches get deployed directly to production."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_patching_tests",
                      "cond": "servers_patching_tests_no",
                      "text": "Patches that are deployed without prior testing may have an adverse affect on the availability and integrity of the data hosted on your servers. Unfortunately, there is a long history of faulty security patches. It is generally impossible to test security updates exhaustively in all possible scenarios, so to be safe, you should first deploy patches on test systems that closely mimic your production environment.",
                      "warn": "yes",
                      "name": "No patch testing prior to deployment",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "servers_logging",
                  "text": "Are your systems configured to log security-relevant events, such as authentication, data access, etc.?",
                  "defaultChoice": false,
                  "choices": [
                    {"servers_logging_yes": "Yes, we have comprehensive logging, including security events, for all relevant services."},
                    {"servers_logging_no": "No, our logging is basic or incidental."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_servers_logging",
                  "cond": "servers_logging_no",
                  "text": "Comprehensive logging of security events is absolutely essential for both the identification and the investigation of security incidents. Comprehensive logging is strongly recommended for systems with direct access to confidential information, as well as for surrounding systems.",
                  "warn": "yes",
                  "name": "Systems do not log security relevant events",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "id": "block_server_logging",
                  "cond": "servers_logging_yes",
                  "text": "Logging",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "servers_logging_retention",
                      "text": "Do you retain security event logs for at least six months, and do you monitor them regularly?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_logging_retention_yes": "Yes, we regularly review these logs and retain them in case we need to investigate a security incident."},
                        {"servers_logging_retention_no": "No, these logs are not retained and/or monitored."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_logging_retention",
                      "cond": "servers_logging_retention_no",
                      "text": "Unfortunately, not all security incidents can be identified right away. Log files should be retained for at least six months so incidents can be appropriately investigated, even when they're discovered later on.",
                      "warn": "yes",
                      "name": "Short security events log retention",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_logging_central",
                      "text": "Are the logs produced by your servers stored in a central location?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_logging_central_yes": "Yes, all devices that support logging write logs to one or more dedicated log systems."},
                        {"servers_logging_central_no": "No, each device stores log files separately."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_logging_central",
                      "cond": "servers_logging_central_no",
                      "text": "With a central log collection location for all relevant networking systems, you can more easily correlate significant events across multiple sources. Centralizing also simplifies log review.",
                      "warn": "yes",
                      "name": "Security event logs collection not centralized",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "block",
                  "id": "block_admin_access",
                  "text": "Administrative Access",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "Select the operating systems that are currently in use on your servers:",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_admin_windows": "Microsoft Windows"},
                        {"servers_admin_unix": "Unix (including Linux, Solaris, etc.)"}
                      ]
                    },
                    {
                      "type": "block",
                      "cond": "servers_admin_windows",
                      "text": "Windows Server Administration",
                      "items": [
                        {
                          "type": "radiogroup",
                          "id": "servers_admin_windows_da_accounts",
                          "text": "Do your Windows domain administrators have separate accounts with lower privileges that they use for day-to-day tasks?",
                          "defaultChoice": false,
                          "choices": [
                            {"servers_admin_windows_da_accounts_yes": "Yes. Our domain administrators use their highly privileged accounts only when necessary. For day-to-day tasks, they use regular accounts with fewer privileges."},
                            {"servers_admin_windows_da_accounts_no": "No, our domain administrators are usually logged in with their domain-admin accounts for day-to-day work."}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_servers_admin_windows_da_accounts",
                          "cond": "servers_admin_windows_da_accounts_no",
                          "text": "Using domain administrator accounts all the time is fairly dangerous. When a system is compromised, the attacker inherits the privileges of the compromised user, so it's especially problematic when the user is a domain administrator. Administrators should use separate, regular accounts for most tasks, and that they authenticate as domain admins only when necessary. Readily available Windows tools (such as runas.exe) make this fairly simple.",
                          "warn": "yes",
                          "name": "No separate accounts for domain administrators",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "medium"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "id": "block_unix_linux_admin",
                      "cond": "servers_admin_unix",
                      "text": "Unix/Linux Server Administration",
                      "items": [
                        {
                          "type": "radiogroup",
                          "id": "servers_admin_linux_sudo",
                          "text": "Do your administrators have personal user accounts and use sudo when elevated privileges are necessary?",
                          "defaultChoice": false,
                          "choices": [
                            {"servers_admin_linux_sudo_yes": "Yes, our administrators use sudo (or a similar tool)."},
                            {"servers_admin_linux_sudo_no": "No, our administrators know the root password and log in as root when they need to make changes that require elevated privileges."}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_servers_admin_linux_sudo",
                          "cond": "servers_admin_linux_sudo_no",
                          "text": "When the root account is used for privileged actions, it's impossible to later trace the action to a specific person. The root password for *nix systems should be a highly guarded secret that is kept in a secure physical location (e.g., in an envelope in a safe), retrieved only when absolutely necessary, and changed after each use.",
                          "warn": "yes",
                          "name": "Shared high-privileged accounts",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "medium"
                        },
                        {
                          "type": "radiogroup",
                          "id": "servers_admin_linux_root",
                          "cond": "servers_admin_linux_sudo_yes",
                          "text": "Where is the root password kept?",
                          "defaultChoice": false,
                          "choices": [
                            {"servers_admin_linux_root_yes": "We keep the root password in a secure location (e.g., in an envelope in a safe). It is retrieved only when absolutely necessary. Processes are in place to ensure accountability, and the password is changed after every use."},
                            {"servers_admin_linux_root_no": "We are not quite that protective of root passwords."}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_servers_admin_linux_root",
                          "cond": "servers_admin_linux_root_no",
                          "text": "When the root account is used for privileged actions, it's impossible to later trace the action to a specific person. The root password for *nix systems should be a highly guarded secret that is kept in a secure physical location (e.g., in an envelope in a safe), retrieved only when absolutely necessary, and changed after each use.",
                          "warn": "yes",
                          "name": "Inappropriate protection of high-privileged account password",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "high"
                        },
                        {
                          "type": "radiogroup",
                          "id": "servers_admin_linux_ldap",
                          "text": "Are your *nix systems connected to a central directory for managing access (e.g., LDAP)?",
                          "defaultChoice": false,
                          "choices": [
                            {"servers_admin_linux_ldap_yes": "Yes. It's easy for us to centrally disable accounts."},
                            {"servers_admin_linux_ldap_no": "No, we create individual accounts separately on each of our *nix servers."}
                          ]
                        },
                        {
                          "type": "tip",
                          "id": "warn_servers_admin_linux_ldap",
                          "cond": "servers_admin_linux_ldap_no",
                          "text": "When you have separate individual accounts on each system, you can't centrally disable accounts or change a password for all machines. Individual accounts can be overlooked when an employee leaves the company, or you might forget to change a password on a specific machine. Having a central directly for authentication makes account management much easier and safer.",
                          "warn": "yes",
                          "name": "System access management not centralized",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "severity": "medium"
                        }
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_admin_auditing",
                      "cond": "req_sensitive",
                      "text": "Do you have procedures in place for regularly auditing administrative access to your servers?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_admin_auditing_yes": "Yes, we review the actions our administrators take to make sure we catch issues, such as a compromised account."},
                        {"servers_admin_auditing_no": "No, we generally don't audit administrative access unless prompted by an issue."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_admin_auditing",
                      "cond": "servers_admin_auditing_no",
                      "text": "It appears that your project has strict requirements for confidentiality, integrity, and/or availability. To meet these requirements, you should regularly review administrative actions in order to catch and revert unauthorized changes.",
                      "warn": "yes",
                      "name": "No audit of high-privileged accounts",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "block",
                  "id": "block_backups",
                  "text": "Backups",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "servers_backup_dcsync",
                      "cond": "req_sensitive",
                      "text": "Do you sync data to a different site in near real time?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_backup_dcsync_yes": "Yes. If a disaster occurs at one site, very little data will be lost because almost everything will already have been copied to our backup site."},
                        {"servers_backup_dcsync_no": "No, we don't have a backup site, or we don't synchronize data in near real time."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_backup_dcsync",
                      "cond": "servers_backup_dcsync_no",
                      "text": "If availability and integrity are important to your project, you should synchronize data between your primary site and a data center. Having a backup site helps ensure that an incident at one site does not result in data loss or inconsistencies.",
                      "warn": "yes",
                      "name": "Lack of synchronized backup data center",
                      "why": "If you feel that this project does not require near-real-time synchronization of data, or you have other mitigating controls in place, please explain below:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_backup_media",
                      "cond": "!req_nodata",
                      "text": "Do you store backups on disks, tapes, or other kinds of removable media?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_backup_media_yes": "Yes."},
                        {"servers_backup_media_no": "No."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_backup_media",
                      "cond": "servers_backup_media_no",
                      "text": "Even if you synchronize data in near real time with an alternate site, you may also need to maintain a backup on tape or other removable media. Synchronization issues sometimes cause inconsistencies and mistakes that are propagated through multiple data centers, resulting in permanent data loss. Only regular backups that are stored offline can ensure recovery (for example, if something is accidentally deleted). Note that backups on removable media should be encrypted and stored off-site at a safe location.",
                      "warn": "yes",
                      "name": "Lack of data backup",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_backup_media_encryption",
                      "cond": "servers_backup_media_yes",
                      "text": "Are the backups that are stored on removable media (e.g., disks, tapes, etc.) encrypted?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_backup_media_encryption_yes": "Yes, we encrypt backups to ensure the safety of data during transport and storage."},
                        {"servers_backup_media_encryption_no": "No, backups are not encrypted."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_backup_media_encryption",
                      "cond": "servers_backup_media_encryption_no",
                      "text": "Data on backup media is generally exposed to certain elevated risks, such as during transport to an off-site storage facility. Confidential data should be encrypted on backups. Encryption also makes it easier to destroy data &mdash; if the backup key is destroyed, the data can no longer be recovered and therefore can also be considered destroyed.",
                      "warn": "yes",
                      "name": "Data backups not encrypted",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_backup_media_offsite",
                      "cond": "servers_backup_media_yes",
                      "text": "Do you store backup media in an off-site facility that is protected against potential disaster?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_backup_media_offsite_yes": "Yes, our backup media is stored in a protected facility that is far enough away from our other facilities to mitigate the impact in the event of a disaster."},
                        {"servers_backup_media_offsite_no": "No, backup media is stored on site."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_backup_media_offsite",
                      "cond": "servers_backup_media_offsite_no",
                      "text": "When backup media is stored near the main systems, there is a chance that in a disaster, both might be destroyed at the same time and significant data loss will occur.",
                      "warn": "yes",
                      "name": "Data backup media stored on-site only",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_backup_frequency",
                      "text": "Do you have procedures in place for working with customers to determine an appropriate backup frequency?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_backup_frequency_yes": "Yes, we talk to our customers to gather requirements for backup frequency, and we implement backup intervals accordingly."},
                        {"servers_backup_frequency_no": "No, we have a fixed backup cycle."}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "id": "servers_backup_test",
                      "text": "Do you regularly test your backups?",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_backup_test_yes": "Yes, we test the entire process of recovery, including restoring entire systems from backup."},
                        {"servers_backup_test_no": "We don't usually test backups."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_servers_backup_test",
                      "cond": "servers_backup_test_no",
                      "text": "Backups can only help if they work as expected, of course, and to make sure that is the case, recovery should be tested regularly. Testing should include both the common case of recovering small amounts of very specific data from backup media (e.g., files that have been accidentally deleted), as well as the (with luck, much rarer) case of restoring an entire system from backup.",
                      "warn": "yes",
                      "name": "Data backups not tested",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "Email",
                  "id": "block_email",
                  "cond": "req_sensitive",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Do you use third-party (e.g. hosted email, email marketing services, etc.) email providers?",
                      "id": "servers_email_third_party",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_email_third_party_yes": "Yes, we use a third-party email provider for some or all of our email."},
                        {"servers_email_third_party_no": "No, we use our own internal email infrastructure (e.g. Microsoft Exchange) for all of our email."}
                      ]
                    },
                    {
                      "type": "checkgroup",
                      "text": "Which of the following security controls do you use to protect against spoofed or forged emails on the domains you own and use?",
                      "defaultChoice": false,
                      "choices": [
                        {"email_security_spf_policy": "Restricted <a href=\"https://en.wikipedia.org/wiki/Sender_Policy_Framework\">Sender Policy Framework (SPF)</a> policies (i.e. the fewest hosts possible are allowed with a default SOFTFAIL or FAIL qualifier)."},
                        {"email_security_dkim": "<a href=\"https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail\">DomainKeys Identified Mail (DKIM)</a> email authentication."},
                        {"email_security_dmarc": "<a href=\"https://en.wikipedia.org/wiki/DMARC\">Domain-based Message Authentication, Reporting and Conformance (DMARC)</a> email validation."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "A key step when securing email infrastructure is preventing spoofed and forged emails, which are used in social engineering, phishing and fraud attacks. Without the use of industry standard email security controls, it is difficult to stop spoofed emails. People, even those with high security awareness, do not always recognise potentially dangerous emails.",
                      "why": "If you have compensating controls in place or feel that this does not constitute a risk in your specific circumstances, please explain below. If you are working to address this, please also include an approximate timeframe for the resolution of this concern:",
                      "warn": "yes",
                      "name": "Lack of email security controls",
                      "severity": "medium",
                      "cond": "!(email_security_spf_policy || email_security_dkim || email_security_dmarc)",
                      "id": "warn_servers_email_security_spoof"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does your inbound email infrastructure support Transport Layer Security (TLS) 1.2 with cipher suites with <a href=\"https://en.wikipedia.org/wiki/Forward_secrecy\">forward secrecy</a> (e.g. ECDHE)?",
                      "id": "servers_email_inbound_tls",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_email_inbound_tls_yes": "Yes, our inbound SMTP servers support at least TLS 1.2 and cipher suites with forward secrecy for all inbound email."},
                        {"servers_email_inbound_tls_no": "No, our inbound SMTP servers do not support encryption or do not meet this level of encryption in transit."}
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does your outbound email infrastructure use <a href=\"https://en.wikipedia.org/wiki/Opportunistic_TLS\">Opportunistic TLS (STARTTLS)</a> to request remote servers upgrade to an encrypted connection?",
                      "id": "servers_email_outbound_starttls",
                      "defaultChoice": false,
                      "choices": [
                        {"servers_email_outbound_starttls_yes": "Yes, our outbound SMTP servers will upgrade to an encrypted connection if the STARTTLS extension is available."},
                        {"servers_email_outbound_starttls_no": "No, our outbound SMTP servers do not support STARTTLS."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Emails sent without using Transport Layer Security (TLS) are as open to snoopers as a postcard in the mail. When an email is encrypted in transit with TLS, it makes it harder for others to read what you’re sending. Since your project has a moderate or high confidentiality requirement, Google generally requires that SMTP traffic between the vendor and Google is encrypted using TLS 1.2 with cipher suites that support forward secrecy. Ensure you use <a href=\"https://wiki.mozilla.org/Security/Server_Side_TLS\">trusted and peer reviewed guidance</a> when selecting cipher suites and configuring network service encryption.",
                      "why": "If you have compensating controls in place or feel that this does not constitute a risk in your specific circumstances, please explain below. If you are working to address this, please also include an approximate timeframe for the resolution of this concern:",
                      "warn": "yes",
                      "name": "Email encryption in transit may be inadequate",
                      "severity": "medium",
                      "cond": "servers_email_inbound_tls_no || servers_email_outbound_starttls_no",
                      "id": "warn_servers_email_security_encryption"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "servers_outsourced",
                  "text": "Is the management of your servers (or parts thereof) outsourced?",
                  "defaultChoice": false,
                  "choices": [
                    {"servers_outsourced_yes": "Yes"},
                    {"servers_outsourced_no": "No"}
                  ]
                },
                {
                  "type": "line",
                  "id": "servers_outsourced_company",
                  "cond": "servers_outsourced_yes",
                  "text": "What company is server management outsourced to?"
                },
                {
                  "type": "radiogroup",
                  "id": "servers_outsourced_audits",
                  "cond": "servers_outsourced_yes",
                  "text": "Do you regularly audit your outsourcing provider to ensure compliance with the policies you set, and the use of safe security practices?",
                  "defaultChoice": false,
                  "choices": [
                    {"servers_outsourced_audits_yes": "Yes, we audit our outsourcing providers at least annually."},
                    {"servers_outsourced_audits_no": "We don't audit our outsourcing providers quite as often as we probably should."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_servers_outsourced_audits",
                  "cond": "servers_outsourced_audits_no",
                  "text": "To ensure that outsourcing providers adhere to your policies and employ adequate security practices, it's important to regularly audit them. These security audits should be done at least annually so the providers can adapt to changing security requirements and identify possible issues quickly.",
                  "warn": "yes",
                  "name": "Server management outsourcing providers not audited",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "box",
                  "id": "servers_other",
                  "text": "Is there anything else you want us to know about the security of your servers?"
                }
              ]
            },
            {
              "type": "block",
              "id": "block_clients",
              "text": "Clients (Workstation, Laptops, etc.)",
              "items": [
                {
                  "type": "info",
                  "text": "<b>Why this section matters:</b> In most companies, almost all IT-related work is performed from client computers. Even if certain data is stored in the cloud or on highly secure servers, it's the laptops and desktops that are used to access this information. An attacker who manages to compromise a client computer will in most cases be able to completely impersonate the user of the machine, gaining the same access rights. If an administrator's client machine is affected by an attack, the attacker will likely be able to escalate their foothold to many other important systems in your company. It's therefore critical to ensure the security of the client machines used by your employees."
                },
                {
                  "type": "radiogroup",
                  "id": "clients_hardening",
                  "text": "Do you have operating system hardening and/or build standards for client systems?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_hardening_yes": "Yes, all of our client systems are configured according to these standards, and/or they are built from standard images that comply with our hardening guidelines."},
                    {"clients_hardening_no": "We do not have hardening or build standards, or we don't apply them uniformly across the fleet."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_clients_hardening",
                  "cond": "clients_hardening_no",
                  "text": "<p>A set of hardening and/or build standards should be applied to all client systems that are provided to users, and should include requirements such as:</p><ul><li>Removing or disabling all non-essential services</li><li>Disabling guest and default accounts</li><li>Review/tightening of permissions for key files and directories</li><li>Setting up logging</li><li>Setting up appropriate host-based firewall rules</li><li>Configuring anti-malware tools</li><li>Securely configuring VPN client software (where appropriate)</li><li>Ensuring the security of local administrative accounts</li><li>Setting up whole-disk encryption.</li></ul><p></p><p>>You probably won't have to create these standards from scratch. Publicly available hardening guides can help you set requirements for your company's systems.</p>",
                  "warn": "yes",
                  "name": "No hardening guidelines for client machines",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "cond": "clients_hardening_yes",
                  "text": "Hardening and build standards",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "clients_hardening_requirements",
                      "text": "<p>Do your hardening and build standards cover the following topics?</p><ul><li>Removing or disabling all non-essential services</li><li>Disabling guest and default accounts</li><li>Review/tightening of permissions for key files and directories</li><li>Setting up logging</li><li>Setting up appropriate host-based firewall rules</li><li>Configuring anti-malware tools</li><li>Securely configuring VPN client software (where appropriate)</li><li>Ensuring the security of local administrative accounts</li><li>Setting up whole-disk encryption</li></ul><p></p>",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_hardening_requirements_yes": "Yes, these are all pretty much covered by our standards."},
                        {"clients_hardening_requirements_no": "No, we might have missed a few of these."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_hardening_requirements",
                      "cond": "clients_hardening_requirements_no",
                      "text": "Techniques such as the ones listed above should be part of any set of hardening and build standards for client systems. You probably won't have to create these standards from scratch. Publicly available hardening guides can help you set requirements for your company's systems.",
                      "warn": "yes",
                      "name": "Inadequate hardening guidelines for client machines",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "clients_configmgmt",
                      "text": "Do you have processes in place for managing the configuration of your client systems?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_configmgmt_yes": "Yes, we have processes in place to ensure that configuration updates are deployed consistently across the entire fleet, covering all operating systems provided to users. Our processes are comprehensive, so it's very unlikely that any systems will be overlooked during important configuration changes."},
                        {"clients_configmgmt_no": "No, our client systems are configured on an ad-hoc basis. The processes for rolling out updates to all of our client systems could be improved."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_configmgmt",
                      "cond": "clients_configmgmt_no",
                      "text": "Security requirements and other client system settings can be very difficult to manage, particularly with a large fleet of client systems. Mobile devices make this even more difficult, as they are often not in the same place and are easily overlooked. This is a common source of security issues; you should have a central way to manage client devices.",
                      "warn": "yes",
                      "name": "Client machines configuration not centralized",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "clients_standardbuild_audit",
                      "cond": "req_sensitive",
                      "text": "Do you review and/or audit the standard builds that form the basis of your client fleet, to ensure that they conform to your security policies and requirements?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_standardbuild_audit_yes": "Yes, standard builds are regularly reviewed or audited."},
                        {"clients_standardbuild_audit_no": "No, unless there is a specific reason to look at them, the standard builds are rarely reviewed."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_standardbuild_audit",
                      "cond": "clients_standardbuild_audit_no",
                      "text": "Availability, integrity, and/or confidentiality seem to be critically important for the data, systems, or services you provide. Processes should be in place for regularly reviewing standard client builds, to ensure that they are appropriate and safe.",
                      "warn": "yes",
                      "name": "Standard builds not reviewed",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "clients_patching",
                  "text": "Do you have a process for installing operating system and application updates and security patches on client systems?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_patching_yes": "Yes, we diligently apply security updates to operating systems and applications."},
                    {"clients_patching_no": "No, we don't have a process for patching. Some updates might fall through the cracks."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_clients_patching",
                  "cond": "clients_patching_no",
                  "text": "Unfortunately, security bugs and vulnerabilities cannot always be caught during the development process, particularly if the software is complex. Software vendors often issue patches and security fixes to address vulnerabilities that were identified after rollout. It is essential to have processes in place to monitor vulnerabilities in software and apply patches as soon as possible. Note that once a patch has been released, the vulnerability is public, so attackers can easily exploit it.",
                  "warn": "yes",
                  "name": "Lack of patching process for client machines",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "critical"
                },
                {
                  "type": "block",
                  "id": "block_client_updates",
                  "cond": "clients_patching_yes",
                  "text": "Security Updates and Vulnerability Management",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "clients_patching_schedule_exceptions",
                      "text": "Do you also have an emergency process for installing patches outside of the regular schedule when high-risk vulnerabilities are identified?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_patching_schedule_exceptions_yes": "Yes, we carefully consider the risk associated with each vulnerability and decide whether the patch should be deployed outside of the regular schedule."},
                        {"clients_patching_schedule_exceptions_no": "No, we generally don't deviate from our standard patching schedule, even for critical vulnerabilities.."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_patching_schedule_exceptions",
                      "cond": "clients_patching_schedule_exceptions_no",
                      "text": "Not all patches are equally important. Patches that fix remotely exploitable issues in client systems must be installed very quickly to protect against compromise. Your patching process should include carefully considering the risk caused by each vulnerability, and triggering emergency procedures when appropriate so that affected systems are patched as soon as possible.",
                      "warn": "yes",
                      "name": "No emergency patch application procedures for client machines",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "checkgroup",
                      "text": "How do you know whether your systems are affected by vulnerabilities that require patching? (Check all that apply.)",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_patching_infosource_agents": "We run agents on our client systems to discover what software is installed and report that information back to a central repository."},
                        {"clients_patching_infosource_mailinglists": "The employees who are responsible for patching subscribe to vendor mailing lists that inform them about security issues."},
                        {"clients_patching_infosource_osupdate": "We use the patching mechanisms built into the operating systems (e.g. Windows Update, apt-get, Red Hat Network, etc.)."},
                        {"clients_patching_infosource_outsourced": "We hired a company that specializes in informing customers about vulnerabilities in the software they use."},
                        {"clients_patching_infosource_other": "We use a method not listed here."}
                      ]
                    },
                    {
                      "type": "box",
                      "id": "clients_patching_infosource_other_explain",
                      "cond": "clients_patching_infosource_other",
                      "text": "Describe your method for finding out which patches apply to your systems:"
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_patching_infosource_osupdate_only",
                      "cond": "clients_patching_infosource_osupdate && !clients_patching_infosource_other && !clients_patching_infosource_outsourced && !clients_patching_infosource_mailinglists && !clients_patching_infosource_agents",
                      "text": "Relying on the update mechanism built into the operating system is generally not sufficient; typically, many applications are not covered. You should maintain an inventory of all software that is not covered by built-in updates, and your administrators should subscribe to the key sources of information on updates for that software.",
                      "warn": "yes",
                      "name": "Client software not patched",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "box",
                      "id": "clients_patching_applications",
                      "cond": "!^warn_clients_patching_infosource_osupdate_only",
                      "text": "Describe your process for rolling out patches for non-operating-system software that may be installed on your client systems. Examples include Mozilla Firefox, Adobe Acrobat Reader, Oracle Java Runtime Environment, Adobe Flash, etc."
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "clients_av",
                  "text": "Do you have controls in place to protect client systems from malware?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_av_yes": "Yes, we regularly scan our client systems for known malware, or we limit client systems to whitelisted software identified by cryptographic hashes."},
                    {"clients_av_no": "Some systems in our client fleet may not be fully protected."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_clients_av",
                  "cond": "clients_av_no",
                  "text": "Malware has become one of the most pervasive problems in computer security. Many computers on the Internet are infected with malware. It's important to have effective controls in place that detect, and ideally avert, malware infections.<p>Unfortunately, correctly identifying malware has become extremely difficult; it's very easy for malware authors to slightly modify their creations and evade detection. For best results, limit client systems to a whitelist of identified known <i>good</i> software. Products that facilitate a whitelist approach include <a href='https://github.com/google/santa'>Google Santa</a>, Microsoft AppLocker and Bit9 Parity.",
                  "warn": "yes",
                  "name": "Client machines without adequate malware protection",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "id": "clients_logging",
                  "text": "Are your client systems configured to log security-relevant events, such as authentication, data access, etc.?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_logging_yes": "Yes, we have comprehensive logging enabled on client systems, including security events."},
                    {"clients_logging_no": "No, our logging is basic or incidental."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_clients_logging",
                  "cond": "clients_logging_no",
                  "text": "Comprehensive logging of security events is absolutely essential for both the identification and the investigation of security incidents. Client systems are often the first target a serious attacker will attempt to compromise, so it's important to have logging in place to catch such events.",
                  "warn": "yes",
                  "name": "Incomplete logging on client machines",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "id": "block_client_logging",
                  "cond": "clients_logging_yes",
                  "text": "Logging",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "clients_logging_retention",
                      "text": "Do you retain client system security event logs for at least three months?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_logging_retention_yes": "Yes, we keep them around in case we need to investigate an incident."},
                        {"clients_logging_retention_no": "No, these logs are not retained for three months."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_logging_retention",
                      "cond": "clients_logging_retention_no",
                      "text": "Unfortunately, security incidents can't always be identified right away. Log files should be retained for at least six months so incidents can be appropriately investigated, even when they're discovered later on.",
                      "warn": "yes",
                      "name": "Security events log retention too short",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "clients_logging_central",
                      "cond": "req_sensitive",
                      "text": "Are the logs produced by your client systems stored in a central location?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_logging_central_yes": "Yes, all devices that support logging write logs to one or more dedicated log systems."},
                        {"clients_logging_central_no": "No, each device stores log files separately."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_logging_central",
                      "cond": "clients_logging_central_no",
                      "text": "With a central log collection location for all relevant client systems, you can more easily correlate significant events across multiple sources. Centralizing also simplifies log review.",
                      "warn": "yes",
                      "name": "Security event log collection not centralized",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "clients_admin_restricted",
                  "text": "What level of access do regular users have on their workstation/laptop?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_admin_restricted_yes": "Regular users have (unprivileged) user access on their machines. We have a process in place for granting local administrative access to users who demonstrate a clear need."},
                    {"clients_admin_restricted_no": "Users are local administrators on their machines."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_clients_admin",
                  "cond": "clients_admin_restricted_no",
                  "text": "Allowing users to have administrator access is generally considered dangerous. In a malware attack or vulnerability exploit, the attacker inherits the user's privileges. It's fine to grant local administrative access on a need-to-have basis, but administrator privileges should be considered a risk, particularly for users who are not very well-versed in IT.",
                  "warn": "yes",
                  "name": "Administrative privileges available to users without clear need",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "id": "clients_admin_samepassword",
                  "text": "Do all clients use the same local administrator/root password?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_admin_samepassword_yes": "Yes, the local root or administrator password is the same for all (or many) client systems."},
                    {"clients_admin_samepassword_no": "No, local Administrator/root accounts are disabled, or a different password is set for all machines."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_clients_admin_samepassword",
                  "cond": "clients_admin_samepassword_yes",
                  "text": "On both Windows and Linux machines, it is relatively easy to steal the hashes of the local administrator/root account. Using modern brute-force methods (such as rainbow tables, GPU cracking, etc.), literally billions of passwords can be tried each second. At that rate, even strong passwords can be found out in a very short amount of time. For best results, disable local administrative accounts or set different passwords for each machine. Otherwise an attacker who cracks the local administrator/root password will be able to expand their access to your entire fleet of client machines. Microsoft has released the <a href='https://support.microsoft.com/en-us/kb/3062591'>Local Administrator Password Solution (LAPS)</a> tool to help address this issue in Windows environments.",
                  "warn": "yes",
                  "name": "Local administrator password identical on many machines",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "radiogroup",
                  "id": "clients_winxp",
                  "text": "One major risk factor in many corporate environments is the use of older versions of Windows. Does your company still have systems running  Windows Vista or earlier versions?",
                  "defaultChoice": false,
                  "choices": [
                    {"clients_winxp_yes": "Yes, some or all of our client machines still run Windows Vista or earlier versions."},
                    {"clients_winxp_no": "No, our client machines do not run Windows Vista or earlier versions. Legacy installations have been completely separated from our main infrastructure and cannot access any of your information."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_clients_winxp",
                  "cond": "clients_winxp_yes",
                  "text": "As of April 8, 2014, Windows XP is no longer supported, and as of April 11th 2017, neither is Windows Vista. Security updates or patches for critical vulnerabilities are no longer provided. These Windows versions were originally released more than a decade ago, and lack many of the security controls that are common in more modern operating systems. Many exploits do not work on newer operating systems, thanks to mitigations that make buffer overflows and other memory corruption issues hard to exploit. Using up-to-date software and operating systems is an absolute necessity.",
                  "warn": "yes",
                  "name": "Unsupported version of Windows in use",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "critical"
                },
                {
                  "type": "block",
                  "id": "block_client_encryption",
                  "text": "Encryption",
                  "items": [
                    {
                      "type": "radiogroup",
                      "id": "clients_laptops_hd_encrypted",
                      "text": "Do you fully encrypt the hard disks of laptops and other portable client devices?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_laptops_hd_encrypted_yes": "Yes, we use full-disk encryption for our laptop fleet."},
                        {"clients_laptops_hd_encrypted_no": "No, laptop hard disks are not fully encrypted. Users are responsible for protecting sensitive information on laptops."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_laptops_hd_encrypted",
                      "cond": "clients_laptops_hd_encrypted_no",
                      "text": "Trusting users to encrypt sensitive information on laptops is almost never an effective strategy. Full-disk encryption is strongly recommended. If a laptop contains information that might directly or indirectly compromise our confidential data (including data that indirectly gives access to our information, such as SSH keys, password hashes that may be reused on production systems, etc.), the hard disk <i>must</i> be fully encrypted. It's vital to ensure that the loss or theft of a laptop will not result in a data leak.",
                      "warn": "yes",
                      "name": "No disk encryption on laptops/mobile devices",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "clients_mobile_phones",
                      "text": "Do you allow access to confidential information (e.g., email) from unencrypted mobile devices such as phones and tablets?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_mobile_phones_yes": "Yes, our users can sync potentially confidential information like email onto their mobile phones or tablets."},
                        {"clients_mobile_phones_no": "No, we do not allow access to corporate information from unencrypted devices such as mobile phones or tablets."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_mobile_phones",
                      "cond": "clients_mobile_phones_yes",
                      "text": "Mobile devices are extremely easy to lose or steal. If your users can access confidential information (or other information that might be used to indirectly gain access to confidential data) from mobile devices, adequate encryption is essential. Ideally, a device policy should be rolled out to all corporate phones to enforce encryption and password requirements, and to provide remote wipe functions.",
                      "warn": "yes",
                      "name": "Corporate information access from unencrypted devices",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "medium"
                    },
                    {
                      "type": "radiogroup",
                      "id": "clients_workstation_hd_encrypted",
                      "cond": "req_sensitive",
                      "text": "Do you fully encrypt the hard disks of workstations and other devices in the office that have access to our confidential information?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_workstation_hd_encrypted_yes": "Yes, our workstations use full-disk encryption."},
                        {"clients_workstation_hd_encrypted_no": "No, devices that cannot be brought outside the office are generally unencrypted, even if they provide access to confidential information."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_workstation_hd_encrypted",
                      "cond": "clients_workstation_hd_encrypted_no",
                      "text": "Your project seems to deal with confidential information. On devices that contain information that might directly or indirectly compromise confidential data (including data that indirectly gives access to information, such as SSH keys, password hashes that may be reused on production systems, etc.), full-disk encryption <i>must</i> be enabled.",
                      "warn": "yes",
                      "name": "No disk encryption on workstations",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "clients_media_encryption",
                      "cond": "!req_nodata && req_sensitive",
                      "text": "Do you require users to encrypt confidential information on mobile media such as external hard drives, thumb drives, DVDs, etc., and do you provide them with adequate tools?",
                      "defaultChoice": false,
                      "choices": [
                        {"clients_media_encryption_yes": "Yes, any information that goes on mobile media is encrypted."},
                        {"clients_media_encryption_no": "No, we should establish better requirements for encryption of mobile media."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_clients_media_encryption",
                      "cond": "clients_media_encryption_no",
                      "text": "Because this project seems to deal with sensitive data, you should ensure that all confidential information is encrypted anytime it is stored on media that may be taken outside of a physically secure facility.",
                      "warn": "yes",
                      "name": "Removable media not encrypted",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    }
                  ]
                },
                {
                  "type": "box",
                  "id": "clients_other",
                  "text": "Is there anything else you want us to know about the security of your client systems?"
                }
              ]
            },
            {
              "type": "block",
              "id": "block_security_testing",
              "text": "Technical Security Testing",
              "items": [
                {
                  "type": "info",
                  "text": "<b>Why this section matters:</b> In addition to audits of your information security program, you should perform technical security testing of information systems to make sure they function as intended, and that the data is properly protected. Some security issues, particularly in proprietary software, can only be identified manually; therefore both manual and automated testing should be performed. Even if the project exclusively uses standard off-the-self software, technical security testing helps ensure that software and infrastructure are configured securely and free of known security issues."
                },
                {
                  "type": "radiogroup",
                  "id": "testing_pentests",
                  "text": "Does an independent third party regularly perform penetration tests on all systems used to provide services to customers?",
                  "defaultChoice": false,
                  "choices": [
                    {"testing_pentests_yes": "Yes."},
                    {"testing_pentests_no": "No, we rarely or never have independent third parties do penetration tests."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_testing_pentests",
                  "cond": "testing_pentests_no",
                  "text": "Technical testing by security specialists is absolutely necessary to ensure the security and proper configuration of all software that's used to handle confidential and sensitive information.",
                  "warn": "yes",
                  "name": "No 3rd party penetration testing",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "critical"
                },
                {
                  "type": "block",
                  "id": "block_3rd_party_pentests",
                  "cond": "testing_pentests_yes",
                  "text": "3rd Party Penetration Tests",
                  "items": [
                    {
                      "type": "box",
                      "id": "testing_pentests_scope",
                      "text": "Describe the scope of the penetration tests (in terms of both depth and width) and how the tests are applied to the systems used to provide services to customers."
                    },
                    {
                      "type": "radiogroup",
                      "id": "testing_pentests_manual",
                      "text": "Many vulnerabilities cannot be found by automated scanners. Do the penetration tests include manual security testing?",
                      "defaultChoice": false,
                      "choices": [
                        {"testing_pentests_manual_yes": "Yes, the experts we hire use both automated and manual testing methods."},
                        {"testing_pentests_manual_no": "No, the penetration testing is fully automated."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_no_testing_pentests_manual",
                      "cond": "testing_pentests_manual_no",
                      "text": "Unfortunately, automated security testing is insufficient. Many security issues can only be discovered by manual tests. Automated security scans can (and should) be performed internally as well. It's not necessary to hire outside consultants for internal scans.",
                      "warn": "yes",
                      "name": "No manual penetration testing",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "line",
                      "id": "testing_pentests_companies",
                      "text": "What company/companies did you use for the three most recent penetration tests?"
                    },
                    {
                      "type": "radiogroup",
                      "text": "How often (on average) are penetration tests done for the scope you described?",
                      "defaultChoice": false,
                      "choices": [
                        {"testing_pentests_freq_often": "Multiple times per year."},
                        {"testing_pentests_freq_annually": "Annually."},
                        {"testing_pentests_freq_rarely": "Less frequently."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_testing_pentests_freq_rarely",
                      "cond": "testing_pentests_freq_rarely",
                      "text": "Information systems are usually subject to frequent changes, and security threats also evolve rapidly. For these reasons, it's important to repeat security testing frequently (at least annually) to make sure security issues were not introduced by recent changes.",
                      "warn": "yes",
                      "name": "Infrequent penetration testing",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "testing_pentests_sharesummary",
                      "text": "Are you willing to share a management summary of the most recent penetration testing reports?",
                      "defaultChoice": false,
                      "choices": [
                        {"testing_pentests_sharesummary_yes": "Yes, if this helps to accelerate the partner audit process, we're willing to share them under NDA."},
                        {"testing_pentests_sharesummary_no": "No, this information is considered confidential and is not shared even under NDA."}
                      ]
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "testing_scans",
                  "text": "Are all of the systems used in this project scanned for host-level vulnerabilities? (<i>Note</i>: This question does <i>not</i> refer to anti-malware scans. Instead, it refers to scans that look for known vulnerabilities and misconfiguration of the software running on servers.)",
                  "defaultChoice": false,
                  "choices": [
                    {"testing_scans_yes": "Yes"},
                    {"testing_scans_no": "No"}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_testing_scans",
                  "cond": "testing_scans_no",
                  "text": "Automated security scans are a low-cost, low-effort way to make sure that known vulnerabilities and insecure misconfiguration in standard software are quickly identified and can be addressed. For best results, perform automated security scans at least quarterly. Ideally, scans should apply to both externally exposed and internal-only systems.",
                  "warn": "yes",
                  "name": "No automated security scans",
                  "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                  "severity": "high"
                },
                {
                  "type": "block",
                  "id": "block_security_scanning",
                  "cond": "testing_scans_yes",
                  "text": "Security Scanning",
                  "items": [
                    {
                      "type": "line",
                      "id": "testing_scans_software",
                      "text": "What software or company do you use for vulnerability scans?"
                    },
                    {
                      "type": "radiogroup",
                      "text": "How often do you run vulnerability scans?",
                      "defaultChoice": false,
                      "choices": [
                        {"testing_scans_monthly": "Once per month or more often"},
                        {"testing_scans_quarterly": "Once per quarter"},
                        {"testing_scans_rarely": "Less frequently"}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_testing_scans_rarely",
                      "cond": "testing_scans_rarely",
                      "text": "Information systems are usually subject to frequent changes, and security threats also evolve rapidly. For these reasons, it's important to repeat security scans frequently (at least quarterly) to make sure security issues have not been introduced by recent changes or recently discovered in off-the-shelf software.",
                      "warn": "yes",
                      "name": "Infrequent automated scans",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "severity": "high"
                    },
                    {
                      "type": "radiogroup",
                      "id": "testing_scans_intext",
                      "text": "Which systems are covered by the security scans?",
                      "defaultChoice": false,
                      "choices": [
                        {"testing_scans_intext_yes": "Both internal systems and externally exposed systems are regularly scanned."},
                        {"testing_scans_intext_no": "Our scans cover only those systems that are exposed on the Internet."}
                      ]
                    },
                    {
                      "type": "tip",
                      "id": "warn_warn_testing_scans_extonly",
                      "cond": "testing_scans_intext_no",
                      "text": "It's important to scan both externally exposed <i>and</i> internal systems. The results of these scans are extremely valuable for vulnerability and patch management. They can &mdash; with very low effort &mdash; quickly identify components that have not received necessary patches."
                    }
                  ]
                },
                {
                  "type": "radiogroup",
                  "id": "testing_inhouse",
                  "text": "In addition to third-party penetration tests and security scans, do you have security know-how internally, and do you use that know-how to conduct in-house security testing?",
                  "defaultChoice": false,
                  "choices": [
                    {"testing_inhouse_yes": "Yes, our security team does technical security reviews of the systems used for this project."},
                    {"testing_inhouse_no": "No, we don't do in-house security testing."}
                  ]
                },
                {
                  "type": "tip",
                  "id": "warn_no_testing_inhouse_sensitive",
                  "cond": "testing_inhouse_no && req_sensitive",
                  "text": "Not every company can have the necessary know-how to do technical security/penetration tests on their own. But because your project has very high confidentiality and/or integrity requirements, it's important to have sufficient know-how and resources to do in-house technical testing of the services you provide."
                },
                {
                  "type": "tip",
                  "id": "warn_no_testing_inhouse",
                  "cond": "testing_inhouse_no && !req_sensitive",
                  "text": "Not every company can have the necessary know-how to do technical security/penetration tests on their own. To compensate, in-depth and frequent third-party penetration tests should be performed on both externally exposed services and internal-only systems."
                },
                {
                  "type": "block",
                  "id": "block_inhouse_testing",
                  "cond": "testing_inhouse_yes",
                  "text": "In-house Security Testing/Reviews",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "What kinds of security testing and security reviews are done internally?",
                      "defaultChoice": false,
                      "choices": [
                        {"testing_inhouse_pentestext": "Red-team-style penetration tests of externally exposed systems."},
                        {"testing_inhouse_pentestint": "Red-team-style penetration tests of internal systems."},
                        {"testing_inhouse_blackbox": "Black-box security testing of software developed internally."},
                        {"testing_inhouse_codereviews": "Security code reviews of software developed internally."},
                        {"testing_inhouse_designreviews": "Security design reviews of software developed internally."},
                        {"testing_inhouse_other": "Other kinds of testing."}
                      ]
                    },
                    {
                      "type": "box",
                      "id": "testing_inhouse_other_details",
                      "cond": "testing_inhouse_other",
                      "text": "Describe the other kinds of testing your security team is conducting."
                    },
                    {
                      "type": "tip",
                      "id": "tip_testing_good",
                      "cond": "testing_inhouse_pentestext && testing_inhouse_pentestint && testing_inhouse_blackbox && testing_inhouse_codereviews && testing_inhouse_designreviews",
                      "text": "Thank you for your diligence!"
                    },
                    {
                      "type": "line",
                      "id": "testing_inhouse_fte",
                      "cond": "testing_inhouse_pentestext || testing_inhouse_pentestint || testing_inhouse_blackbox || testing_inhouse_codereviews || testing_inhouse_other || testing_inhouse_designreviews",
                      "text": "Approximately how many FTE (full-time equivalents) are working on this kind of testing?"
                    }
                  ]
                },
                {
                  "type": "box",
                  "id": "testing_other",
                  "text": "Is there anything else you want us to know about the security testing of your infrastructure and/or product?"
                }
              ]
            },
            {
              "type": "block",
              "id": "block_security_contact",
              "text": "Security Contact",
              "items": [
                {
                  "type": "line",
                  "id": "security_contacts",
                  "text": "Please provide the email addresses (separated by semicolons) of team members who should be contacted about any security issues:"
                }
              ]
            },
            {
              "type": "block",
              "id": "block_feedback",
              "text": "Feedback",
              "items": [
                {
                  "type": "box",
                  "id": "feedback",
                  "text": "<b>Good news!</b> You have made it to the end of this questionnaire. If you can spare another minute, please let us know how we can improve it. Any feedback is highly appreciated."
                }
              ]
            }
          ]
        },
        {
          "type": "block",
          "text": "On Board Web Application",
          "id": "block_webapp",
          "cond": "scenario_webapp",
          "items": [
            {
              "type": "block",
              "text": "Application",
              "id": "block_application",
              "items": [
                {
                  "type": "block",
                  "text": "Application Metadata",
                  "id": "block_application_metadata",
                  "items": [
                    {
                      "type": "line",
                      "text": "The name of the application:",
                      "id": "application_name"
                    },
                    {
                      "type": "box",
                      "text": "A brief description:",
                      "id": "application_description"
                    },
                    {
                      "type": "line",
                      "text": "What frameworks (if any) does this application require?",
                      "id": "application_frameworks"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "Vulnerability Reporting and Management",
                  "id": "block_vulnerability_reporting",
                  "items": [
                    {
                      "type": "info",
                      "text": "Because no system is entirely free of security issues, it's important to provide ways for external users to offer input and report vulnerabilities."
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do you have an easily discoverable way for external researchers to report security vulnerabilities in your systems?",
                      "defaultChoice": false,
                      "id": "application_vm_securitycontact",
                      "choices": [
                        {"application_vm_securitycontact_yes": "Yes, we have a published security email contact, or we provide another way for users to report security issues. Incoming reports are timely reviewed and triaged."},
                        {"application_vm_securitycontact_no": "No, we do not currently offer a way to report security vulnerabilities for priority handling."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Make it easy for others to let you know about security issues in your products. That way you'll learn about vulnerabilities earlier and can respond to them quickly. Also, without an easy way to report issues directly to you, external researchers might publish issues widely instead.",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "warn": "yes",
                      "name": "No external security contact published",
                      "severity": "medium",
                      "id": "warn_application_vm_securitycontact",
                      "cond": "application_vm_securitycontact_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "HTTPS and Mixed-Content Risks",
                  "id": "block_https",
                  "items": [
                    {
                      "type": "radiogroup",
                      "text": "Select the option that best describes your web application:",
                      "defaultChoice": false,
                      "choices": [
                        {"application_ssl_exclusively": "The web application is reachable exclusively over HTTPS. Even if the user manually edits the URL to start with <code>http://</code>, it won't work or it will redirect to <code>https://</code>."},
                        {"application_ssl_mixed": "The web application is flexible — users can reach it over HTTP or over HTTPS."},
                        {"application_ssl_none": "The web application supports HTTP only, and can't be reached over HTTPS even if you edit the URL."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "It's often extremely easy for attackers to eavesdrop on packets transmitted between users and web applications (for example, on public Wi-Fi networks). To avoid exposing sensitive data in transit, any application that allows users to log in — or contains anything but public data — should be available solely over HTTPS. It's also fine to use a web server that listens on port 80 (plain HTTP) and redirects users to the SSL version; this method can make it easier for users to access the application.",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "warn": "yes",
                      "name": "Unencrypted application network traffic",
                      "severity": "high",
                      "id": "warn_application_not_ssl",
                      "cond": "application_ssl_mixed || application_ssl_none"
                    },
                    {
                      "type": "block",
                      "text": "Configuring SSL/TLS",
                      "id": "application_ssl_configuration",
                      "cond": "application_ssl_mixed || application_ssl_exclusively",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "Have you recently reviewed your SSL configuration to ensure that only secure protocols and ciphers are offered to clients?",
                          "choices": [
                            {"application_ssl_configuration_ciphers_yes": "Yes, we regularly review the cipher suite advertised by the server and the protocols it uses."},
                            {"application_ssl_configuration_ciphers_no": "We're not sure whether our SSL/TLS configuration is secure."}
                          ],
                          "id": "application_ssl_configuration_ciphers"
                        },
                        {
                          "type": "tip",
                          "text": "Detailed guidance on SSL/TLS and cipher suites is beyond the scope of this questionnaire. A very good and well-maintained resource is <a href='https://wiki.mozilla.org/Security/Server_Side_TLS'>Mozilla's SSL/TLS configuration wiki page</a>, which gives up-to-date recommendations for the most common use cases. Another good resource for reviewing the security of your SSL/TLS server is <a href='https://www.ssllabs.com/ssltest/'>SSL Labs' server test</a>.",
                          "name": "Protocol and cipher selection",
                          "cond": "application_ssl_configuration_ciphers_no",
                          "id": "tip_application_ssl_configuration_ciphers"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Does your server offer <a href='https://en.wikipedia.org/wiki/Forward_secrecy'>forward secrecy</a> for clients that support it?",
                          "choices": [
                            {"application_ssl_configuration_pfs_yes": "Yes, the server supports ECDHE and DHE ciphers that offer forward secrecy."},
                            {"application_ssl_configuration_pfs_no": "No, no ciphers providing forward secrecy are enabled."}
                          ],
                          "id": "application_ssl_configuration_pfs"
                        },
                        {
                          "type": "tip",
                          "text": "In ciphers that support forward secrecy, an ephemeral key is negotiated for each connection, using the Diffie-Hellman algorithm. This key is used for a limited period of time, after which it is \"forgotten.\" Even if the private SSL key is later compromised, an attacker who recorded conversations between the server and clients won't be able to decrypt those conversations without also breaking the associated ephemeral keys. Enabling ciphers that offer forward secrecy can protect your users against future disclosure of the information transmitted between them and your server.",
                          "name": "Enable forward secrecy for HTTPS",
                          "cond": "application_ssl_configuration_pfs_no",
                          "id": "tip_application_ssl_configuration_pfs"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Are your SSL/TLS private keys appropriately protected on your web servers?",
                          "choices": [
                            {"application_ssl_configuration_keys_yes": "Yes, we have taken all necessary steps to protect our private keys."},
                            {"application_ssl_configuration_keys_no": "I'm not sure how well protected they are."}
                          ],
                          "id": "application_ssl_configuration_keys"
                        },
                        {
                          "type": "tip",
                          "text": "Make sure private SSL/TLS keys are, at a minimum, protected through file system permissions. It's important to make sure the user account that's used to serve web pages does not have access; otherwise, a vulnerability in the web app could easily lead to a compromise of the keys. If you are using an SSL certificate with a wildcard CN (e.g., *.example.net), ensure that the private key is well protected on all the servers it resides on (not just your most important server).",
                          "name": "Protection of SSL/TLS private keys",
                          "cond": "application_ssl_configuration_keys_no",
                          "id": "tip_application_ssl_configuration_keys"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Where is the SSL connection between the user and your application terminated?",
                          "choices": [
                            {"application_ssl_configuration_termination_app": "At the application server"},
                            {"application_ssl_configuration_termination_loadbalancer": "At the load balancer"},
                            {"application_ssl_configuration_termination_other": "Somewhere else"}
                          ],
                          "id": "application_ssl_configuration_termination"
                        },
                        {
                          "type": "line",
                          "text": "Provide more details on the termination point:",
                          "cond": "application_ssl_configuration_termination_other",
                          "id": "application_ssl_configuration_termination_other_value"
                        },
                        {
                          "type": "radiogroup",
                          "text": "How is traffic between the load balancer and the application servers protected?",
                          "choices": [
                            {"application_ssl_configuration_lb_traffic_encrypted": "Traffic is encrypted and certificates between load balancer and application servers are validated."},
                            {"application_ssl_configuration_lb_traffic_unencrypted_own_network": "Traffic is unencrypted, but all networks transited between load balancers and application servers are owned and exclusively used by us."},
                            {"application_ssl_configuration_lb_traffic_unencrypted_other_network": "Traffic is unencrypted, and traffic has to transit through networks not owned and exclusively used by us."},
                            {"application_ssl_configuration_lb_traffic_other": "Through other means."}
                          ],
                          "id": "application_ssl_configuration_lb_traffic",
                          "cond": "application_ssl_configuration_termination_loadbalancer"
                        },
                        {
                          "type": "tip",
                          "text": "Because user traffic appears to transit networks behind your load balancer that are not fully owned and operated by you, we strongly recommend that you establish another SSL/TLS connection between the load balancer and the servers that actually serve the application. Otherwise, an attacker who can listen in on the traffic behind your load balancers will be able to see unencrypted user data.",
                          "name": "End-to-End SSL encryption necessary",
                          "cond": "application_ssl_configuration_lb_traffic_unencrypted_other_network",
                          "id": "tip_application_ssl_configuration_endtoend"
                        },
                        {
                          "type": "box",
                          "text": "Describe how the traffic is protected:",
                          "cond": "application_ssl_configuration_lb_traffic_other",
                          "id": "application_ssl_configuration_lb_traffic_other_value"
                        }
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Applications served over SSL may still be vulnerable to attacks if resources (often JavaScript, style sheets, or other active content) are included over plain HTTP. This defeats the purpose of SSL, because the active content loaded through plain HTTP will have access to the DOM of content protected by SSL. Make sure no resources are included from plain HTTP sites. Typically, browsers will help identify cases where resources from non-SSL sites are included, by displaying <a href='https://developer.mozilla.org/en-US/docs/Security/MixedContent'>mixed content</a> warnings.<p>To avoid these issues, do you have checks in place to ensure that all references to resources either point to SSL or are protocol-relative</a>?",
                      "choices": [
                        {"application_ssl_mixedcontent_yes": "Yes, we are very careful and have specific controls in place to prevent mixed-content issues."},
                        {"application_ssl_mixedcontent_no": "It wouldn't be too difficult for something to fall through the cracks and introduce mixed-content bugs."}
                      ],
                      "id": "application_ssl_mixedcontent",
                      "cond": "application_ssl_mixed || application_ssl_exclusively"
                    },
                    {
                      "type": "tip",
                      "text": "Mixed content is a big deal, and it's becoming more problematic as an increasing number of users roam on public Wi-Fi and other insecure networks. We recommend cleaning up your codebase to avoid this kind of issue, and establishing procedures to help guard against new instances.",
                      "warn": "yes",
                      "name": "Mixed content issue",
                      "severity": "medium",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "id": "warn_ssl_mixed_content",
                      "cond": "application_ssl_mixedcontent_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "To improve security for your users even further, have you deployed <a href='https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security'>HTTP Strict Transport Security (HSTS)</a> on your server?",
                      "defaultChoice": false,
                      "choices": [
                        {"tip_application_ssl_hsts_yes": "Yes, we have HSTS configured with a max-age value of at least 6 months."},
                        {"tip_application_ssl_hsts_no": "No, we don't use HTTP Strict Transport Security, or we have a short max-age configured."}
                      ],
                      "cond": "application_ssl_exclusively",
                      "id": "tip_application_ssl_hsts"
                    },
                    {
                      "type": "tip",
                      "text": "Strict Transport Security is an HTTP response header that tells clients to initiate connections over HTTPS only. This defense-in-depth mechanism helps mitigate certain issues, such as the accidental inclusion of (or linking to) resources over plain HTTP. In HSTS, the header must be configured with a 'max-age' value; this tells clients how long to honor the directive.<p>Sensitive web applications should enable HSTS to ensure that users are always protected by SSL/TLS. For this protection to be effective, the max-age value should be in the 6+ months range.",
                      "warn": "yes",
                      "name": "Strict Transport Security not enabled",
                      "severity": "high",
                      "id": "warn_application_ssl_nohsts",
                      "cond": "tip_application_ssl_hsts_no"
                    },
                    {
                      "type": "radiogroup",
                      "text": "If your application supports authentication, are authentication cookies marked with the <code>secure</code> attribute?",
                      "defaultChoice": false,
                      "choices": [
                        {"application_ssl_cookies_secure_yes": "Yes, the authentication cookies are marked <code>secure</code>."},
                        {"application_ssl_cookies_secure_no": "I'm not sure whether the application does that."}
                      ],
                      "cond": "application_ssl_exclusively",
                      "id": "application_ssl_cookies_secure"
                    },
                    {
                      "type": "tip",
                      "text": "Unless a cookie has the <code>secure</code> attribute set, the browser will add the cookie to plain-text HTTP requests, even if the application is SSL-only. A man-in-the-middle attack can use this vulnerability to steal authentication cookies.",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below.",
                      "warn": "yes",
                      "name": "Cookie without secure flag",
                      "severity": "medium",
                      "id": "warn_application_ssl_cookies_secure",
                      "cond": "application_ssl_cookies_secure_no"
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "Authentication and Authorization",
                  "id": "block_authn_authz",
                  "items": [
                    {
                      "type": "block",
                      "text": "Basic Information",
                      "items": [
                        {
                          "type": "checkgroup",
                          "text": "To get started, tell us a little about your application so we can ask you the right questions.",
                          "defaultChoice": false,
                          "choices": [
                            {"application_authentication_requires_login": "Our application requires regular users to log in. Most features aren't available without logging in."},
                            {"application_authentication_admin_interface": "In addition to an interface for regular users, our application provides an administration interface."},
                            {"application_authentication_roles": "Our application features complex user management. Various roles can be assigned to user accounts."}
                          ]
                        },
                        {
                          "type": "box",
                          "text": "Briefly describe the different roles your application provides. If your application also offers custom role definitions, be sure to mention that.",
                          "id": "application_authentication_roles_description",
                          "cond": "application_authentication_roles"
                        },
                        {
                          "type": "checkgroup",
                          "text": "Is your application integrated with any of the following single sign-on (SSO) mechanisms?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_authentication_sso_saml": "SAML 2.0"},
                            {"application_authentication_sso_oauth": "OpenID Connect / OAuth2 Login"},
                            {"application_authentication_sso_openid": "OpenID 2.0"},
                            {"application_authentication_sso_ldap": "LDAP / Active Directory"},
                            {"application_authentication_sso_other": "Other"},
                            {"application_authentication_sso_none": "None of the above"}
                          ],
                          "cond": "application_authentication_requires_login || application_authentication_admin_interface"
                        },
                        {
                          "type": "line",
                          "text": "What other SSO mechanisms does the application support?",
                          "id": "application_authentication_sso_other_description",
                          "cond": "application_authentication_sso_other"
                        },
                        {
                          "type": "tip",
                          "text": "OpenID 2.0 has been replaced by OpenID Connect (also called OAuth2 Login). We recommend updating your application's SSO integration to support OpenID Connect.",
                          "warn": "yes",
                          "name": "OpenID is deprecated",
                          "severity": "high",
                          "id": "warn_application_authentication_openid_deprecated",
                          "cond": "application_authentication_sso_openid && !application_authentication_sso_oauth"
                        },
                        {
                          "type": "tip",
                          "text": "Integrating with LDAP and/or Active Directory has a significant downside: any application that integrates with it has to receive the user's SSO password. As a result, a vulnerability in any integrated application puts the password at risk for all other applications. We recommend using an SSO mechanism that does not require the password to be sent anywhere other than a central authentication system.",
                          "warn": "yes",
                          "name": "LDAP/AD integration sends password to application",
                          "severity": "high",
                          "id": "warn_application_authentication_ldap_password",
                          "cond": "application_authentication_sso_ldap"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "OAuth2 Login",
                      "id": "block_oauth2",
                      "cond": "application_authentication_sso_oauth",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "Implementing OAuth2 Login / OpenID Connect from scratch is fairly complex and error-prone, and mistakes can result in security vulnerabilities. Select the option that best describes your implementation:",
                          "defaultChoice": false,
                          "choices": [
                            {"application_auth2_library": "Very secure: We're using a standard OAuth2 library, and we update it when security fixes are released."},
                            {"application_auth2_self_secure": "Secure: We implemented OAuth2 on our own, but our employees are experts and we're convinced that it is implemented securely."},
                            {"application_auth2_self": "Not sure: We implemented OAuth2 on our own, and it seemed simple at the time. I'm not sure about the security of our implementation."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "If your employees really are OAuth2 experts, you're probably fine. But note that even standard libraries have had vulnerabilities due to the intricacies of the standard. Be sure to ask your penetration testing provider to take a look at the OAuth2 implementation.",
                          "id": "tip_application_auth2_self_secure",
                          "cond": "application_auth2_self_secure"
                        },
                        {
                          "type": "tip",
                          "text": "Implementing OAuth2 on your own is extremely dangerous. Even the experts on the OAuth2 standards panel concluded that the only way to securely implement it is through a well-known and well-tested library. Some of these libraries are very easy to use (e.g., the <a href='https://developers.google.com/identity/toolkit/'>Google Identity Toolkit</a>), so replacing your custom implementation should be feasible.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "warn": "yes",
                          "name": "Homebrewed OAuth2 implementation",
                          "severity": "high",
                          "id": "warn_application_auth2_self",
                          "cond": "application_auth2_self"
                        }
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Does any part of the application employ username/password-based authentication?",
                      "defaultChoice": false,
                      "choices": [
                        {"application_custom_auth_yes": "Yes"},
                        {"application_custom_auth_no": "No, all authentication is based on single sign-on (SSO)."}
                      ],
                      "cond": "application_authentication_requires_login || application_authentication_admin_interface",
                      "id": "application_custom_auth"
                    },
                    {
                      "type": "block",
                      "text": "Username/Password Authentication",
                      "cond": "application_custom_auth_yes",
                      "id": "block_custom_auth",
                      "items": [
                        {
                          "type": "box",
                          "text": "What username/password-based logins does the application use? For example, if there's a separate administrator authentication, mention that.",
                          "id": "application_custom_auth_explain"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Does your application allow users to change their passwords?",
                          "defaultChoice": false,
                          "id": "application_custom_auth_chpasswd",
                          "choices": [
                            {"application_custom_auth_chpasswd_yes": "Yes"},
                            {"application_custom_auth_chpasswd_no": "No"}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Allowing users to change their passwords is important. A user might be recovering from a compromise, or might have accidentally typed the password elsewhere.",
                          "warn": "yes",
                          "name": "Application does not support changing the password",
                          "severity": "high",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_custom_auth_chpasswd",
                          "cond": "application_custom_auth_chpasswd_no"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Does the application enforce minimum password security requirements (e.g., a certain length, character classes, etc.)?",
                          "defaultChoice": false,
                          "id": "application_custom_auth_pwdreq",
                          "choices": [
                            {"application_custom_auth_pwdreq_yes": "Yes"},
                            {"application_custom_auth_pwdreq_no": "No"}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Please help protect users from themselves by enforcing certain minimum password requirements. It's up to you to determine the details of these requirements, but they should account for the sensitivity of the information and should conform to industry standards.",
                          "warn": "yes",
                          "name": "Application should enforce minimum password requirements",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_custom_auth_pwdreq",
                          "cond": "application_custom_auth_pwdreq_no"
                        },
                        {
                          "type": "block",
                          "text": "Password Storage",
                          "items": [
                            {
                              "type": "radiogroup",
                              "text": "How does the application store passwords?",
                              "defaultChoice": false,
                              "choices": [
                                {"application_custom_auth_storage_plain": "In plain text (unencrypted)"},
                                {"application_custom_auth_storage_reversible": "Using reversible encryption (e.g., DES, 3DES, AES, etc.)."},
                                {"application_custom_auth_storage_hashed": "Using a secure <a href='https://en.wikipedia.org/wiki/Cryptographic_hash_function'>cryptographic one-way hash function</a> (such as SHA-256) of the password, without the use of a <a href='http://en.wikipedia.org/wiki/Salt_(cryptography)'>salt</a>"},
                                {"application_custom_auth_storage_salted": "Using a secure <a href='http://en.wikipedia.org/wiki/Cryptographic_hash_function'>cryptographic one-way hash function</a> (such as SHA-256) of the <a href='http://en.wikipedia.org/wiki/Salt_(cryptography)'>salted</a> password"},
                                {"application_custom_auth_storage_pbkdf": "Using a dedicated password-based key derivation function, such as <a href='http://en.wikipedia.org/wiki/Bcrypt'>bcrypt</a>, <a href='http://en.wikipedia.org/wiki/PBKDF2'>PBKDF2</a> or <a href='http://en.wikipedia.org/wiki/Scrypt'>scrypt</a>"},
                                {"application_custom_auth_storage_other": "None of the above"}
                              ]
                            },
                            {
                              "type": "box",
                              "text": "Explain how your application stores passwords:",
                              "id": "application_custom_auth_storage_other_what",
                              "cond": "application_custom_auth_storage_other"
                            },
                            {
                              "type": "tip",
                              "text": "Passwords should be stored in such a way that the original passwords cannot be easily recovered, even if an attacker manages to get access to the storage location (e.g., through a SQL injection vulnerability). At a minimum, passwords should be secured using a cryptographic one-way hash function and a salt. We strongly recommended using password-based key derivation function like <a href='http://en.wikipedia.org/wiki/Bcrypt'>bcrypt</a> <a href='http://en.wikipedia.org/wiki/PBKDF2'>PBKDF2</a> or <a href='http://en.wikipedia.org/wiki/Scrypt'>scrypt</a> instead; they were specifically designed for this use case and make it significantly harder for attackers to crack password hashes.",
                              "warn": "yes",
                              "name": "Passwords stored insecurely",
                              "severity": "critical",
                              "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                              "id": "warn_application_custom_auth_storage_insecure",
                              "cond": "application_custom_auth_storage_reversible || application_custom_auth_storage_plain || application_custom_auth_storage_hashed"
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "Setting an Initial Password",
                          "id": "block_initial_password",
                          "items": [
                            {
                              "type": "radiogroup",
                              "text": "How do users get their initial passwords?",
                              "defaultChoice": false,
                              "choices": [
                                {"application_custom_auth_initpwd_selfset": "Users self-register and set their passwords online directly within the application."},
                                {"application_custom_auth_initpwd_email": "The initial password or a link to set the initial password is sent to users by email."},
                                {"application_custom_auth_initpwd_snail": "The initial password is provided in a (physical) letter sent to a verified address."},
                                {"application_custom_auth_initpwd_other": "None of the above."}
                              ]
                            },
                            {
                              "type": "box",
                              "text": "Explain how users get their initial passwords:",
                              "id": "application_custom_auth_initpwd_other_what",
                              "cond": "application_custom_auth_initpwd_other"
                            },
                            {
                              "type": "radiogroup",
                              "text": "When the user gets their initial password, will their account be prepopulated with any confidential information? For example, in an online payroll portal, a user can typically access previous pay statements even when the account is brand new.",
                              "defaultChoice": false,
                              "id": "application_custom_auth_initpwd_prepopulated",
                              "choices": [
                                {"application_custom_auth_initpwd_prepopulated_yes": "Yes, when users log in for the first time, confidential information will already be present."},
                                {"application_custom_auth_initpwd_prepopulated_no": "No, at the initial login, no confidential information will be available to the user."}
                              ]
                            },
                            {
                              "type": "tip",
                              "warn": "yes",
                              "text": "When users self-register for prepopulated accounts, some initial authentication of the user should be performed. Otherwise, arbitrary users could gain access to the prepopulated information. The type of authentication depends on the sensitivity of the prepopulated information. Commonly requested information — like the last four digits of the social security number, a home address, or an employee ID — is rarely secret enough to be used for authentication",
                              "name": "Self-registration to prepopulated accounts",
                              "severity": "high",
                              "why": "Explain how users are identified and authenticated when they self-register in the application:",
                              "id": "warn_application_custom_auth_initpwd_selfset",
                              "cond": "application_custom_auth_initpwd_selfset && application_custom_auth_initpwd_prepopulated_yes"
                            },
                            {
                              "type": "tip",
                              "text": "If passwords are sent by email, make sure users are required to change their initial passwords when they first log in.",
                              "id": "tip_application_custom_auth_initpwd_email",
                              "cond": "application_custom_auth_initpwd_email"
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "Account Recovery",
                          "id": "block_account_recovery",
                          "items": [
                            {
                              "type": "checkgroup",
                              "text": "Sometimes, passwords are simply forgotten — it happens to the best of us. How does your application deal with users who can no longer access their accounts?",
                              "defaultChoice": false,
                              "choices": [
                                {"application_custom_auth_recovery_questions": "The user is asked questions that were set up when the account was created."},
                                {"application_custom_auth_recovery_resetlink": "A password reset link is sent via email to the user's registered email address."},
                                {"application_custom_auth_recovery_newpwd": "A new password is sent via email to the user's registered email address."},
                                {"application_custom_auth_recovery_other": "None of the above."}
                              ]
                            },
                            {
                              "type": "box",
                              "text": "Describe your password recovery mechanism:",
                              "id": "application_custom_auth_recovery_other_what",
                              "cond": "application_custom_auth_recovery_other"
                            },
                            {
                              "type": "tip",
                              "warn": "yes",
                              "text": "Recovery questions alone should not be sufficient for resetting a password. The answers to these questions are often not as secret as they might seem; in particular, friends and family can often easily guess the answers.",
                              "name": "Recovery questions should not be sufficient to reset password",
                              "severity": "high",
                              "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                              "id": "warn_application_custom_auth_recovery_questions",
                              "cond": "application_custom_auth_recovery_questions && !(application_custom_auth_recovery_resetlink || application_custom_auth_recovery_newpwd)"
                            },
                            {
                              "type": "tip",
                              "warn": "yes",
                              "text": "Sending passwords by email is rarely a good idea. Email is generally unencrypted, so it should not be used for sensitive information. Instead, we recommend sending a token that can be used to set the actual password. Although an attacker with the token could still reset the password, the user would at least become aware of the reset when they later attempted to log in.",
                              "name": "Application sends passwords via email for account recovery",
                              "severity": "medium",
                              "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                              "id": "warn_application_custom_auth_recovery_email",
                              "cond": "application_custom_auth_recovery_newpwd"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Authentication Cookies and Sessions",
                      "id": "block_auth_cookies",
                      "cond": "application_authentication_requires_login || application_authentication_admin_interface",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "Cookies can be decorated with a special keyword, <code>HttpOnly</code>. If this keyword is set, the browser will not allow JavaScript to access the cookie. Even if the application has a cross-site scripting vulnerability, this keyword makes it much harder for an attacker to steal the session cookie.",
                          "defaultChoice": false,
                          "id": "application_auth_cookies_httponly",
                          "choices": [
                            {"application_auth_cookies_httponly_yes": "The <code>HttpOnly</code> keyword is set for all our authentication cookies."},
                            {"application_auth_cookies_httponly_no": "Our application does not make use of this defense-in-depth mechanism."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Setting the <code>HttpOnly</code> attribute is a very simple defense-in-depth mechanism. We highly recommended making use of it.",
                          "warn": "yes",
                          "name": "Cookie without HttpOnly flag",
                          "severity": "medium",
                          "id": "warn_application_auth_cookies_httponly_no",
                          "why": "If there are specific reasons why this is not possible in your case please explain below:",
                          "cond": "application_auth_cookies_httponly_no"
                        },
                        {
                          "type": "checkgroup",
                          "text": "Session IDs can be constructed in many ways. Select the methods used in your application:",
                          "defaultChoice": false,
                          "choices": [
                            {"application_auth_cookies_framework": "The web application framework we use has a built-in session ID mechanism."},
                            {"application_auth_cookies_random": "Our session IDs are randomly generated strings or numbers."},
                            {"application_auth_cookies_sig": "We store a signed token as a cookie to indicate that the user is successfully logged in."},
                            {"application_auth_cookies_other": "We use some other mechanism."}
                          ]
                        },
                        {
                          "type": "box",
                          "text": "Describe the mechanism you're using:",
                          "id": "application_auth_cookies_other_explain",
                          "cond": "application_auth_cookies_other"
                        },
                        {
                          "type": "line",
                          "text": "What's the name of the framework that generates your session IDs?",
                          "id": "application_auth_cookies_framework_which",
                          "cond": "application_auth_cookies_framework"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Do sessions automatically time out after a specified period of inactivity?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_auth_cookies_timeout_yes": "Yes"},
                            {"application_auth_cookies_timeout_no": "No"}
                          ],
                          "cond": "application_auth_cookies_sig || application_auth_cookies_random",
                          "id": "application_auth_cookies_timeout"
                        },
                        {
                          "type": "tip",
                          "text": "If you don't specify a session timeout, an attacker who has stolen a session ID once will have a permanent back door to the application. Be sure to implement a timeout — even if it's fairly long, it's still better than no timeout at all).",
                          "warn": "yes",
                          "name": "No automatic session timeout",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_auth_cookies_timeout",
                          "cond": "application_auth_cookies_timeout_no"
                        },
                        {
                          "type": "line",
                          "text": "How long is the session timeout?",
                          "id": "application_auth_cookies_timeout_length",
                          "cond": "application_auth_cookies_timeout_yes || application_auth_cookies_framework"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Does the application use a secure <a href='https://en.wikipedia.org/wiki/Pseudorandom_number_generator#Cryptographically_secure_pseudorandom_number_generators'>cryptographic pseudo random number generator</a> (PRNG) to generate session IDs? The PRNG should not allow the state of the generator to be recalculated from its output, and the entropy of the session ID should be sufficient to make brute-forcing infeasible.",
                          "defaultChoice": false,
                          "choices": [
                            {"application_auth_cookies_prng_yes": "Yes, we use a PRNG that meets these criteria."},
                            {"application_auth_cookies_prng_no": "No, we don't use a PRNG, or our PRNG doesn't meet these criteria."}
                          ],
                          "cond": "application_auth_cookies_random",
                          "id": "application_auth_cookies_prng"
                        },
                        {
                          "type": "tip",
                          "text": "If you're not using a cryptographic PRNG, an attacker can recalculate the state of the generator in order to guess subsequent session IDs and steal those users' sessions. Many programming languages already have a secure PRNG built in (e.g., Java has <code>java.security.SecureRandom</code>; C# has <code>System.Security.Cryptography.RNGCryptoServiceProvider</code>; Python has <code>os.urandom</code>), and in most cases it is as easy to use as a less secure option.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_auth_cookies_no_prng",
                          "warn": "yes",
                          "name": "Inappropriate PRNG in use",
                          "severity": "high",
                          "cond": "application_auth_cookies_prng_no"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Does your application offer a \"log out\" button or link that, when clicked, not only terminates the session (deletes cookies from the client) but also invalidates the entire session ID?",
                          "defaultChoice": false,
                          "id": "application_auth_cookies_invalidation",
                          "choices": [
                            {"application_auth_cookies_invalidation_yes": "Yes"},
                            {"application_auth_cookies_invalidation_no": "No"}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Unless sessions are invalidated on logout, an attacker who has stolen a session ID will have access to the user's data until the session expires. Make sure all logout actions invalidate the session ID.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_auth_cookies_no_invalidation",
                          "warn": "yes",
                          "name": "No logout button",
                          "severity": "medium",
                          "cond": "application_auth_cookies_invalidation_no"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Authorization",
                      "id": "block_authz",
                      "cond": "application_authentication_requires_login || application_authentication_admin_interface",
                      "items": [
                        {
                          "type": "info",
                          "text": "In most applications, certain information should only be accessible to certain users. For example, in most applications that require authentication, only the currently logged-in user should be able to change master data (such as the username, the associated email address, or the account password). When an application has data that should not be available to other users or should be restricted to certain roles, authorization must be enforced on the server side."
                        },
                        {
                          "type": "radiogroup",
                          "text": "<strong>Horizontal Access Control</strong>: Horizontal access control refers to isolation between users of the same role. For example, consider an application that allows users to access their payroll statements. The application must ensure that a user cannot access another user's statements; i.e., if the user's statement for the month of May is found at <code>statement.html?id=837<b>2</b>&month=5</code>, it shouldn't be possible to see someone else's pay stub simply by loading <code>statement.html?id=837<b>3</b>&month=5</code>.",
                          "defaultChoice": false,
                          "id": "application_authz_horizontal",
                          "choices": [
                            {"application_authz_horizontal_yes": "Our application enforces these restrictions on the server side. We have processes in place to make sure nothing slips through the cracks."},
                            {"application_authz_horizontal_no": "It's possible that we missed checks like this in a few places."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Applications must have controls in place that help protect all data from unauthorized access. We recommend that you thoroughly audit your code for vulnerabilities resulting from inadequate access control.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_authz_no_horizontal",
                          "warn": "yes",
                          "name": "Lack of horizontal access control",
                          "severity": "high",
                          "cond": "application_authz_horizontal_no"
                        },
                        {
                          "type": "radiogroup",
                          "text": "<strong>Vertical Access Control</strong>: When an application supports multiple roles, users should not be able to gain privileges or perform unauthorized actions by loading pages or features that should only be available to users in a different role. Throughout your application, have you ensured that users can perform only those actions that are appropriate for their roles?",
                          "defaultChoice": false,
                          "id": "application_authz_vertical",
                          "choices": [
                            {"application_authz_vertical_yes": "Our application enforces these restrictions on the server side. We have processes in place to make sure nothing slips through the cracks."},
                            {"application_authz_vertical_no": "It's possible that we missed checks like this in a few places."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Applications must have controls in place that protect all functionality from unauthorized access. We recommend that you thoroughly audit your code for vulnerabilities resulting from inadequate access control.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "warn": "yes",
                          "name": "Lack of vertical access control",
                          "severity": "high",
                          "id": "warn_application_authz_no_vertical",
                          "cond": "application_authz_vertical_no"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Authorization-Related Web Vulnerabilities",
                      "id": "block_authz_vulns",
                      "cond": "application_authentication_requires_login || application_authentication_admin_interface",
                      "items": [
                        {
                          "type": "block",
                          "text": "Cross Site Request Forgery",
                          "items": [
                            {
                              "type": "info",
                              "text": "<p>Applications must protect all state-changing actions against <a href='https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)'>cross-site request forgery</a> (XSRF). In this attack, a malicious user forces the victim to send a request to the application, for example by luring the user to a page under the attacker's control. Because the browser automatically attaches available authentication cookies, the request will appear to be authorized if the user is logged in to the application.</p>" +
                                      "<p>For example, consider an online banking application that allows users to transfer money to another account. The URL for transfers might look something like this:</p>" +
                                      "<p><code>https://www.example.com/bank-transfer.html?dest_account=123456&amount=99.90&submit=true</code></p>" +
                                      "<p>If an attacker manages to lure the victim to a malicious site, the site could include HTML that causes such a request to be sent:</p>" +
                                      "<p><code>&lt;img src=\"https://www.example.com/bank-transfer.html?dest_account=666&amount=99.90& submit=true\"&gt;</code></p>" +
                                      "<p>If the user is logged in to the online banking portal, the application will receive that request and check for authentication cookies — which will be present, since the request was sent from the authorized user's browser.</p>"
                            },
                            {
                              "type": "radiogroup",
                              "text": "Does your application protect all state-changing actions against XSRF?",
                              "defaultChoice": false,
                              "id": "application_authz_xsrf",
                              "choices": [
                                {"application_authz_xsrf_yes": "Yes, all state-changing actions are protected. We have a way to ensure that no actions are missed (such as enforcing XSRF-token checks in a central place)."},
                                {"application_authz_xsrf_no": "Some actions might not be protected against XSRF."}
                              ]
                            },
                            {
                              "type": "tip",
                              "text": "Web applications used to process private or confidential information should protect against XSRF. We recommend that you thoroughly audit your code for XSRF vulnerabilities, and put procedures in place so that future code is also protected.",
                              "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                              "id": "warn_application_authz_no_xsrf",
                              "warn": "yes",
                              "name": "Lack of CSRF protection",
                              "severity": "high",
                              "cond": "application_authz_xsrf_no"
                            },
                            {
                              "type": "radiogroup",
                              "text": "What strategy do you use to protect against XSRF?",
                              "defaultChoice": false,
                              "choices": [
                                {"application_authz_xsrf_token": "We protect requests that change the state with tokens that are bound to the user they were generated for, and that expire after a certain amount of time."},
                                {"application_authz_xsrf_header": "We use a custom fixed header that we add to requests."},
                                {"application_authz_xsrf_post": "The application does one of the following: verifies the referrer header; requires all state-changing actions to be POST requests; employs another mechanism to protect against XSRF."}
                              ],
                              "cond": "application_authz_xsrf_yes"
                            },
                            {
                              "type": "tip",
                              "text": "Various browser plugins (such as Flash and Java) have had security vulnerabilities that allowed an attacker to set arbitrary custom headers on cross-domain requests. We highly recommend the use of tokens instead of headers.",
                              "id": "tip_application_authz_xsrf_header",
                              "cond": "application_authz_xsrf_header"
                            },
                            {
                              "type": "tip",
                              "text": "Unfortunately, using POST requests does not protect against XSRF. Attackers can perform cross-domain POST requests by submitting a form with the appropriate <code>action</code> parameter, via JavaScript. Referrer checks are similarly ineffective because attackers can get around them through open redirects.",
                              "id": "warn_application_authz_xsrf_post",
                              "warn": "yes",
                              "name": "Inappropriate CSRF protection",
                              "severity": "high",
                              "why": "If you are using an alternative, effective method to protect against XSRF, describe it:",
                              "cond": "application_authz_xsrf_post"
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "Cross-Site Script Inclusion",
                          "id": "block_xssi",
                          "items": [
                            {
                              "type": "checkgroup",
                              "text": "<p>Many web applications use AJAX to exchange data in the background, using a syntax that can be automatically interpreted as JavaScript by the user's browser. Unfortunately, this leads to <a href='http://capec.mitre.org/data/definitions/111.html'>cross-site script inclusion</a> (XSSI) vulnerabilities: the JavaScript can be included from a different origin, and any variables set at the other origin can be read.</p>" +
                                      "<p>For example, consider a contact management application that transmits the user's contacts in a JSON file (contacts.js):</p>" +
                                      "<p><code>var contacts = {\"name\": \"John Doe\", \"address\": \"jdoe@example.com\", ... }</code></p>" +
                                      "<p>An attacker can include the following script from their own site, so that when the user visits the attacker's site while logged in to the contact management application, the attacker can read the variable <code>contacts</code> and get access to all of the victim's contact information.</p>" +
                                      "<p><code>&lt;script src=\"http://www.example.com/contacts.js\"&gt;&lt;/script&gt;</code></p>" +
                                      "<p>Do either of the following statements describe your application?</p>",
                              "defaultChoice": false,
                              "choices": [
                                {"application_authz_xssi_jsonp": "Our application makes use of <a href='http://en.wikipedia.org/wiki/JSONP'>JSONP</a>."},
                                {"application_authz_xssi_other": "Our application uses another format that sets variables or calls functions with non-public information."}
                              ]
                            },
                            {
                              "type": "radiogroup",
                              "text": "Your application may be affected by XSSI, unless you specifically protect against this kind of attack.",
                              "defaultChoice": false,
                              "choices": [
                                {"application_authz_xssi_protections_yes": "We use one of the following mechanisms to protect against this kind of attack:<ul><li>protect transmission of such data with an unguessable, unpredictable token (this token must fulfill the same requirements as those described for XSRF tokens above).</li><li>require POST requests, so the data cannot be included in &lt;script&gt tags.</li></ul>"},
                                {"application_authz_xssi_protections_no": "It's possible that part of our web application is vulnerable to XSSI."}
                              ],
                              "cond": "application_authz_xssi_jsonp || application_authz_xssi_other",
                              "id": "application_authz_xssi_protections"
                            },
                            {
                              "type": "tip",
                              "text": "Web applications that transmit private information must be protected against XSSI, to prevent attackers from stealing the private data.",
                              "why": "If you are using an alternative, effective method to protect against XSSI, describe it:",
                              "id": "warn_application_authz_xssi_no_protection",
                              "warn": "yes",
                              "name": "Lack of XSSI protection",
                              "severity": "high",
                              "cond": "application_authz_xssi_protections_no"
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "Clickjacking",
                          "id": "block_clickjacking",
                          "items": [
                            {
                              "type": "radiogroup",
                              "text": "<p>Depending on the nature of your application and the actions that can be taken in it, you may need to protect against <a href='https://www.owasp.org/index.php/Clickjacking'>clickjacking</a>.</p>" +
                                      "<p>If you don't typically need to frame web pages, your application should use the <a href='https://developer.mozilla.org/en/the_x-frame-options_response_header'>X-Frame-Options response header</a> to tell the browser not to render any page that's framed from a different origin:</p>" +
                                      "<p><code>X-Frame-Options: SAMEORIGIN</code></p>",
                              "defaultChoice": false,
                              "choices": [
                                {"application_authz_clickjacking_protected": "Our application employs protections against clickjacking (such as using the <code>X-Frame-Options</code> header)."},
                                {"application_authz_clickjacking_notprotected": "Our application does not have such protections."}
                              ]
                            },
                            {
                              "type": "tip",
                              "text": "Clickjacking is difficult to address. But in high-risk applications, clickjacking protection is essential.",
                              "why": "Explain why you consider clickjacking protection unnecessary:",
                              "id": "tip_application_authz_clickjacking_notprotected",
                              "cond": "application_authz_clickjacking_notprotected"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "Common Web Vulnerabilities",
                  "id": "block_common_vulns",
                  "items": [
                    {
                      "type": "checkgroup",
                      "text": "Certain features can result in security issues, if used incorrectly. To help us identify potential issues, select the statements that describe your application:",
                      "defaultChoice": false,
                      "choices": [
                        {"application_webvuln_db": "The application uses a database back end, or any other persistence back end that can be queried with SQL or a related language (e.g., GQL, FQL, SOQL, etc.)."},
                        {"application_webvuln_plugin": "The application requires a plugin, such as Java, Flash, Silverlight, etc."},
                        {"application_webvuln_upload": "The application has a file upload feature."},
                        {"application_webvuln_3rdpartycontent": "The application loads active content, such as scripts, applets, or style sheets, from third-party servers (i.e., any server that is not under your direct control)."},
                        {"application_webvuln_xml": "The application processes or manipulates user-provided XML."},
                        {"application_webvuln_crypto": "The application uses cryptography to encrypt data or protect its integrity."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "<p>Loading content from other sites is dangerous under certain circumstances; security issues in the other sites might also affect the security of your application. Scripts, for example, have full access to the DOM of the site on which they're included — so if one of the servers that hosts your third-party JavaScript gets compromised, the attacker also gains access to all of your users' data, simply by injecting a bit of code.</p>" +
                              "<p>Unless you trust the third party completely (not only to not do something malicious, but also to be secure enough to adequately protect their infrastructure against attackers), it's best not to load scripts or style sheets (e.g., via <code>&lt;script src=...&gt;</code> or <code>&lt;style src=...&gt;</code>) from third-party sites.</p>" +
                              "<p>Similarly (although to a lesser extent), directly embedding videos, frames, or images (including advertisements, tracking pixels, etc.) from third-party sources can be dangerous. Loading such a resource can leak information to the site it's loaded from (e.g., through the referrer). This can be a privacy issue as well as a security issue.</p>",
                      "why": "If your application loads third-party content, describe your threat model:",
                      "id": "warn_application_3rdparty_conent",
                      "warn": "yes",
                      "name": "Application includes active 3rd party content",
                      "severity": "medium",
                      "cond": "application_webvuln_3rdpartycontent"
                    },
                    {
                      "type": "tip",
                      "text": "Dealing with user-provided and untrusted XML may make your application vulnerable to attacks. For example, the expat XML parser (written in C) has been found vulnerable to buffer overflow attacks. Even if you use a secure parser (or run it in a sandbox), things that can go wrong." +
                              "<p>Various attacks rely on the attacker's ability to specify XML entities. Entities are \"codes\" (such as <code>&amp;quot;</code>) that are translated into defined strings by the parser. HTML has a predefined set of entities, but in XML, entities can be specified arbitrarily. An entity specification usually looks like this:<p>" +
                              "<code>&lt;!ENTITY ent \"Hello!\"&gt;</code><p>" +
                              "With this definition, whenever the parser comes across <code>&amp;ent;</code>, it will replace it with <code>Hello!</code>. Entities are usually defined in the document type, which can be provided in a separate file or  in the <code>&lt;!DOCTYPE&gt;</code> section at the beginning of an XML document." +
                              "Entities are used in a variety of XML-related attacks. For example, they can be used for something called the <a href='http://www.ibm.com/developerworks/xml/library/x-tipcfsx/index.html'>billion laughs attack</a>, where an entity resolves to other entities, which resolve to other entities, etc., causing high memory usage and essentially resulting in a denial-of-service attack.<p>" +
                              "Even more serious is an attack using <a href='http://www.securiteam.com/securitynews/6D0100A5PU.html'>external entities</a>. Definitions of external entities look similar to regular entity definitions, but they reference local files or URLs. Unless the XML parser has been specifically instructed not to expand external entities, a definition like <code>&lt;!ENTITY etc SYSTEM \"file:///etc/passwd\"&gt;</code> would include the /etc/passwd file where the entity &amp;etc; occurs in the XML document, leading to the disclosure of files as well as internal URLs." +
                              "It's very important to restrict entity specification in user-provided or untrusted XML. Make sure your parser is adequately configured.",
                      "warn": "yes",
                      "name": "User provided XML processed/manipulated",
                      "severity": "medium",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "id": "warn_application_webvuln_xml_entities",
                      "cond": "application_webvuln_xml"
                    },
                    {
                      "type": "block",
                      "text": "Cross-Site Scripting",
                      "id": "block_xss",
                      "items": [
                        {
                          "type": "checkgroup",
                          "text": "<a href='https://www.owasp.org/index.php/XSS'>Cross-site scripting</a> (or XSS for short) occurs when an application redisplays insufficiently sanitized user input in the context of the application's origin (as defined by the <a href='http://code.google.com/p/browsersec/wiki/Part2#Same-origin_policy'>same-origin policy</a>). If the user input contains certain kinds of scripting code, it may read or alter the DOM of the current page when redisplayed. In many cases, XSS is used to steal users' cookies or other application-related data, but it may also be used for phishing attacks, or even to deface the web page. Unfortunately, XSS is one of the most common security issues in web applications, and due to browser quirks and other factors, quite hard to protect against. Select the statements that describe your strategy:",
                          "defaultChoice": false,
                          "choices": [
                            {"application_xss_templating": "We use a templating system that automatically escapes all user input before redisplaying it."},
                            {"application_xss_chokepoint": "Our application has a central choke point where all user input is validated and escaped, depending on the context in which it will be interpreted."},
                            {"application_xss_perpage": "Some of the pages (or all of them) escape user input."},
                            {"application_xss_other": "We are using some other technique to protect against XSS."},
                            {"application_xss_sanitization": "Part of the application deals with user-provided HTML that is sanitized and re-displayed to the user."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "You didn't select a strategy for protecting against cross-site scripting.",
                          "why": "Explain why:",
                          "warn": "yes",
                          "id": "warn_application_no_xss_strategy",
                          "cond": "!application_xss_templating && !application_xss_chokepoint && !application_xss_perpage && !application_xss_other && !application_xss_sanitization"
                        },
                        {
                          "type": "tip",
                          "text": "Using a templating system to escape user input is a good way to protect against XSS. But be careful with directives that disable automatic escaping, and watch for the direct display of user input (for example, in error messages). Additionally, be aware of the context in which user input is used in templates. Not all templating systems automatically understand that different escaping may be required, depending on where in the application the user input is displayed. For example, many templating systems would not correctly escape a construct such as <code>&gt;a href=\"{{ user_input }}\"&lt;</code>, where a user could supply <code>javascript:alert(/xss/)</code> as user_input. We recommend using a context-sensitive templating system.",
                          "id": "tip_application_xss_templating",
                          "cond": "application_xss_templating"
                        },
                        {
                          "type": "tip",
                          "text": "A central choke point for validating and escaping user input is generally a good way to protect against XSS. But make sure your application identifies the context in which the user input is being used; otherwise, it might still be possible to smuggle in JavaScript through user input. You might also want to consider using a context-sensitive templating system, to address this issue automatically.",
                          "id": "tip_application_xss_chokepoint",
                          "cond": "application_xss_chokepoint"
                        },
                        {
                          "type": "tip",
                          "text": "<p>Escaping user input on each page individually is a fairly dangerous strategy: it's very easy to miss something. We recommend using a templating system that automatically escapes user input, ideally in a context-sensitive fashion. Some examples are listed below. Note that not all of these are context-sensitive, so you may still need to do manual escaping (or explicitly tag a variable in the template) when the context is something other than HTML.</p>" +
                                  "<ul><li><a href='https://www.djangoproject.com/'>Django</a> (Python)</li>" +
                                  "<li><a href='http://code.google.com/p/ctemplate/?redir=1'>Google CTemplates</a> (C++)</li>" +
                                  "<li><a href='http://code.google.com/p/jsilver/'>Jsilver</a> (Java)</li>" +
                                  "<li><a href='https://developers.google.com/closure/templates/'>Closure/Soy</a> (Javascript, Java)</li>" +
                                  "<li><a href='http://jquery.com/'>JQuery</a> (JavaScript)</li>" +
                                  "<li><a href='http://www.smarty.net/'>Smarty</a> (PHP)</li>",
                          "warn": "yes",
                          "name": "Inappropriate XSS protection",
                          "severity": "medium",
                          "id": "warn_application_xss_perpage",
                          "cond": "!application_xss_templating && !application_xss_chokepoint && application_xss_perpage"
                        },
                        {
                          "type": "box",
                          "text": "Describe your strategy for protecting against XSS vulnerabilities:",
                          "id": "application_xss_other_explanation",
                          "cond": "application_xss_other"
                        },
                        {
                          "type": "tip",
                          "text": "Unfortunately, due to error-correcting behavior and browser quirks, getting HTML sanitization right is very difficult. The sanitization code has to build an in-memory representation of the DOM, and then serialize that to a known-safe format. Some libraries do this correctly, so we highly recommended using a well-tested library.",
                          "why": "Describe how your application deals with HTML sanitization:",
                          "warn": "yes",
                          "name": "Dangerous HTML sanitization",
                          "severity": "medium",
                          "id": "warn_application_xss_sanitization",
                          "cond": "application_xss_sanitization"
                        },
                        {
                          "type": "radiogroup",
                          "text": "In addition to applying the strategies you've identified, does the application set a valid and appropriate content type and character set for each page (in the <code>Content-Type</code> HTTP header)?",
                          "defaultChoice": false,
                          "id": "application_xss_content_type",
                          "choices": [
                            {"application_xss_content_type_yes": "Yes, we take great care to set this, knowing that otherwise we might be introducing XSS vulnerabilities."},
                            {"application_xss_content_type_no": "I'm not sure all pages set an appropriate content type."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Not setting both a content type and a character set often leads to cross-site scripting vulnerabilities. For example, if the application outputs JSON but sets the content type to text/html, this might result in XSS because JavaScript/JSON escaping is different from HTML escaping. We recommend that you thoroughly audit your code for pages that don't set the content type correctly.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "warn": "yes",
                          "name": "Inappropriate content type/character set",
                          "severity": "medium",
                          "id": "warn_application_xss_content_type",
                          "cond": "application_xss_content_type_no"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Earlier, you noted that the application has a file upload feature. Does the application allow other users (or administrators) to access the files that are uploaded?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_xss_fileupload_yes": "Yes, this is a feature of our application."},
                            {"application_xss_fileupload_no": "No; uploaded files are processed but can't be downloaded again."}
                          ],
                          "cond": "application_webvuln_upload",
                          "id": "application_xss_fileupload"
                        },
                        {
                          "type": "tip",
                          "text": "Hosting and serving user-provided content is almost guaranteed to introduce XSS vulnerabilities. Because of various browser quirks, countermeasures (such as setting a <code>Content-Disposition: attachment</code> header) do not provide full protection. We recommend serving user-provided content on a domain separate from all domains that have authentication cookies. However, this approach introduces another problem, if access to the content is intended to be authenticated. You can solve this by using short-lived random tokens, or by serving each document from a separate domain. If you use the latter approach, each domain should have a unique set of authentication cookies, valid only for the one document that's served from the domain.",
                          "why": "Describe your strategy for protecting against XSS vulnerabilities introduced by serving user-provided content:",
                          "warn": "yes",
                          "name": "Potential XSS via uploaded file access",
                          "severity": "medium",
                          "id": "warn_application_xss_fileupload",
                          "cond": "application_xss_fileupload_yes"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Some XSS vulnerabilities work exclusively on the client side, in an application's scripting code. This kind of XSS is commonly referred to as <a href='https://www.owasp.org/index.php/DOM_Based_XSS'>DOM-based XSS</a>. Because server-side escaping of user input does not protect against DOM-based XSS, you need a strategy for dealing with client-side scripting code that handles user input, as well as parts of the DOM that may contain user input (such as document.location).",
                          "defaultChoice": false,
                          "id": "application_xss_dombased",
                          "choices": [
                            {"application_xss_dombased_yes": "We know about DOM-based XSS, and we take specific steps to protect against this kind of vulnerability."},
                            {"application_xss_dombased_no": "It may be possible that something slipped through the cracks and our application has DOM-based XSS vulnerabilities."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "We recommend that you thoroughly audit your code for DOM-based XSS vulnerabilities, and put procedures in place so that future code is also protected.",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "warn": "yes",
                          "name": "Lack of protection against DOM-based XSS",
                          "severity": "medium",
                          "id": "warn_application_xss_dombased",
                          "cond": "application_xss_dombased_no"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Persistence Back Ends and Querying",
                      "cond": "application_webvuln_db",
                      "id": "block_app_db",
                      "items": [
                        {
                          "type": "checkgroup",
                          "text": "<p>Because your application uses a database or a similar back end to persist data, we need to make sure it's not vulnerable to injection attacks, such as <a href='http://en.wikipedia.org/wiki/SQL_injection'>SQL injection</a>.</p>" +
                                  "<p>An application is vulnerable to SQL injection when some portion of user input is interpreted by the database as part of a query. When this occurs, an attacker may be able to read or even write data directly from or to the database.</p>",
                          "defaultChoice": false,
                          "choices": [
                            {"application_sqli_orm": "Our application uses an object-relational mapping (ORM) framework. When we need to manually construct queries or conditions, we use one of the mechanisms selected below:"},
                            {"application_sqli_prepared": "We use prepared statements and let the framework take care of correctly escaping the user input."},
                            {"application_sqli_stored": "We pass user input to the database via stored procedures."},
                            {"application_sqli_manual": "We manually escape user input whenever we need to use it in a database query."},
                            {"application_sqli_other": "We do something else."}
                          ]
                        },
                        {
                          "type": "box",
                          "text": "Describe the other mechanism you're using to protect against SQL injection:",
                          "id": "application_sqli_other_details",
                          "cond": "application_sqli_other"
                        },
                        {
                          "type": "tip",
                          "text": "Using an ORM layer is generally a good way to protect against SQL injection. However, in most ORM frameworks, it's possible to directly specify parts of the SQL query. Some ORM frameworks also have a special querying language that makes it possible to set the <code>WHERE</code> part of the statement. In these cases, you still need to be sure to guard against injection vulnerabilities.",
                          "id": "tip_application_sqli_orm",
                          "cond": "application_sqli_orm"
                        },
                        {
                          "type": "line",
                          "text": "What ORM framework are you using?",
                          "id": "application_sqli_orm_which",
                          "cond": "application_sqli_orm"
                        },
                        {
                          "type": "tip",
                          "text": "Using stored procedures is generally a good way to protect against SQL injection. But this strategy must be used consistently. Make sure neither the stored procedures themselves nor the calls of the stored procedures are vulnerable to injection attacks.",
                          "id": "tip_application_sqli_stored",
                          "cond": "application_sqli_stored"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Do you take special steps (policies, code reviews, audits, etc.) to ensure that prepared statements are used consistently, and that string concatenation is never used to construct database queries?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_sqli_prepared_consistent_yes": "Yes, we have all or most of these measures in place, and we're very confident that there are no SQL injection vulnerabilities in our code."},
                            {"application_sqli_prepared_consistent_no": "We try to make our developers use prepared statements, but it may be possible for some string concatenation to slip through."}
                          ],
                          "cond": "application_sqli_prepared && !application_sqli_manual",
                          "id": "application_sqli_prepared_consistent"
                        },
                        {
                          "type": "tip",
                          "text": "<p>Manually escaping SQL (or related) queries is error-prone and very difficult to do consistently. Here are a couple of examples:</p>" +
                                  "<ul><li>PHP provides the function <code>mysql_escape_string</code> for escaping user input that will be used in a database query. Unfortunately, that function does not take into account the character set of the connection, so it may still be possible to smuggle in user input that will be interpreted as part of the SQL query. Applications should use <code>mysql_real_escape_string</code> instead.</li>" +
                                  "<li>In SQL, numbers do not need to be surrounded with quotation marks when used in a statement. For example, <code>SELECT username WHERE id=123</code> is perfectly valid. But if user-provided input that will be used as a number is not confirmed to be actually numeric, the resulting code will be vulnerable to SQL injection (even if the input is escaped).</li></ul>" +
                                  "<p>We highly recommend using something like prepared statements, or using an ORM layer consistently throughout the application. Make sure you have procedures in place to enforce your approach (such as static tests when code is checked into the repository).</p>",
                          "warn": "yes",
                          "name": "Inadequate SQL injection protection",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_sqli_manual",
                          "cond": "application_sqli_prepared_consistent_no || application_sqli_manual"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Browser Plugins",
                      "cond": "application_webvuln_plugin",
                      "id": "block_plugins",
                      "items": [
                        {
                          "type": "checkgroup",
                          "text": "You mentioned that your application requires certain browser plugins to work correctly. Which of the following plugins are required?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_plugin_java": "Java"},
                            {"application_plugin_flash": "Flash"},
                            {"application_plugin_silverlight": "Silverlight"},
                            {"application_plugin_other": "Other"}
                          ]
                        },
                        {
                          "type": "line",
                          "text": "What other plugins are required by your application?",
                          "id": "application_plugin_other_which",
                          "cond": "application_plugin_other"
                        },
                        {
                          "type": "box",
                          "text": "Explain what the plugin is used for, what technology it uses (e.g., ActiveX, NPAPI, Chrome plugin, etc.), how it is usually deployed to your users, and what privileges it requires:",
                          "id": "application_plugin_other_desc",
                          "cond": "application_plugin_other"
                        },
                        {
                          "type": "tip",
                          "text": "Enabling Java in the browser exposes users to a variety of security issues. We strongly discourage requiring Java.",
                          "warn": "yes",
                          "name": "Java plugin required by application",
                          "severity": "medium",
                          "why": "Is Java absolutely necessary for your application to function correctly? Are there any workarounds?",
                          "id": "warn_application_plugin_java",
                          "cond": "application_plugin_java"
                        },
                        {
                          "type": "tip",
                          "text": "In most cases, custom plugins are considered a security risk. Plugins can operate outside of the usual constraints (such as a same-origin policy, sandboxing, etc.) and can introduce security vulnerabilities that affect the entire browser. It's also often difficult to deploy and centrally manage them. We strongly discourage using custom plugins.",
                          "warn": "yes",
                          "name": "Custom plugin required by application",
                          "severity": "high",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below:",
                          "id": "warn_application_plugin_other",
                          "cond": "application_plugin_other"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "File Uploads",
                      "cond": "application_webvuln_upload",
                      "id": "block_uploads",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "You mentioned previously that your application allows users to upload files. Where does the application store those files?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_upload_storage_fs": "On the file system"},
                            {"application_upload_storage_db": "In a database"},
                            {"application_upload_storage_other": "Somewhere else"}
                          ]
                        },
                        {
                          "type": "line",
                          "text": "Explain where the uploaded files are stored:",
                          "id": "application_upload_storage_other_expl",
                          "cond": "application_upload_storage_other"
                        },
                        {
                          "type": "tip",
                          "text": "Storing uploaded files on the file system can be dangerous. Here are a few issues that can occur:<p>" +
                                  "<ul><li><b>Path traversal</b>: The names of uploaded files must be carefully sanitized to prevent attackers from uploading files with paths in the name, such as <code>../../../../some_existing_file.html</code>. Files like these can end up in the wrong directory.</li>" +
                                  "<li><b>Null bytes</b>: The names of uploaded files must be examined for null bytes, which can cause file names to be truncated (e.g., a file called <code>evilfile.exe[0x00].gif</code> might become <code>evilfile.exe</code> when stored on disk).</li>" +
                                  "<li><b>Interpretation</b>: Files on the file system are much more likely to end up being interpreted. For example, if an attacker manages to store an uploaded file somewhere underneath the web root and names it <code>evilfile.php</code>, it might be executed as PHP code by the web server.</li></ul>" +
                                  "<p>To prevent issues like these, store user-uploaded content in a database instead. If your application stores files on the file system, be sure to implement careful handling, validation, and sanitization of uploaded files.",
                          "warn": "yes",
                          "name": "Dangerous way of storing uploaded files",
                          "severity": "medium",
                          "id": "warn_application_upload_fs",
                          "cond": "application_upload_storage_fs"
                        },
                        {
                          "type": "line",
                          "text": "In most cases, file type restrictions should be in place for uploads. What types of files does your application white-list?",
                          "id": "application_upload_storage_types"
                        },
                        {
                          "type": "checkgroup",
                          "text": "How does the application enforce these file type restrictions?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_upload_type_extension": "We verify the file type by checking the file extension on the server side."},
                            {"application_upload_type_contenttype": "We look at the content type that is sent by the user."},
                            {"application_upload_type_reencoding": "We decode and re-encode the file, storing only the result."},
                            {"application_upload_type_other": "We employ another method to verify the file type."}
                          ]
                        },
                        {
                          "type": "box",
                          "text": "Explain how you verify the file type and enforce the whitelist:",
                          "id": "application_upload_type_other_expl",
                          "cond": "application_upload_type_other"
                        },
                        {
                          "type": "tip",
                          "text": "Some web servers are configured by default to allow double file extensions. For example, if a user uploads a file called <code>malicious.php.gif</code>, it might actually be executed as PHP code upon retrieval. Because you store uploaded files on the file system, this issue may affect your application. Make sure your web server uses only the last extension (i.e., the part after the right-most dot in the file name) when determining how to process the file.",
                          "warn": "yes",
                          "name": "Inadequate method of file type verification",
                          "severity": "medium",
                          "id": "warn_application_upload_doubleextension",
                          "cond": "application_upload_type_extension && application_upload_storage_fs"
                        },
                        {
                          "type": "tip",
                          "text": "Re-encoding files uploaded by users is usually a very good approach. However, note that because the decoding and re-encoding works on untrusted user input (and because parsing is difficult and error-prone), it's best to perform these operations in a sandbox. That way, even if an attacker successfully exploits a vulnerability in the parser, the effects would be constrained to the sandboxed environment. Various sandboxing APIs are available, such as the <a href='http://sourceforge.net/projects/libseccomp/'>Seccomp library</a> for Linux." +
                                  "<p>You could also run the decoder/encoder on an isolated virtual machine that's regularly reset to a predefined state. Note, however, that a successful attacker would still be able to observe all incoming and outgoing files, unless the reset happens after each individual file operation." +
                                  "<p>Even with a sandboxed encoder, some attacker-provided content may survive the re-encoding. For example, in images, the EXIF metadata may be left intact. If this occurs and the content type is incorrectly set (or browser content-sniffing behavior kicks in), cross-site scripting vulnerabilities can result.",
                          "warn": "yes",
                          "name": "Inadequate method of file type verification",
                          "severity": "medium",
                          "why": "Describe the steps you're taking to protect against vulnerabilities in the decoding and parsing code:",
                          "id": "warn_application_upload_reencoding",
                          "cond": "application_upload_type_reencoding"
                        },
                        {
                          "type": "tip",
                          "text": "Unfortunately, verifying the content type of uploaded files is generally not sufficient for enforcing a whitelist. Because the content type is a field in the HTTP request sent by the user, it can be arbitrarily set by an attacker (for example, by using an interception proxy). At a minimum, the application should also verify the extension at the very end of the file name and check it against the whitelist.",
                          "warn": "yes",
                          "name": "Inadequate method of file type verification",
                          "severity": "high",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_upload_contenttypeonly",
                          "cond": "application_upload_type_contenttype && !application_upload_type_reencoding && !application_upload_type_extension"
                        }
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Use of Cryptography",
                      "cond": "application_webvuln_crypto",
                      "id": "block_app_crypto",
                      "items": [
                        {
                          "type": "info",
                          "text": "You previously mentioned that your application uses cryptography to ensure the confidentiality and/or integrity of information. That's great! But we want to make sure you're using cryptography correctly." +
                                  "<p>Note: when using cryptography, make sure algorithms are used in the right context and within appropriate constraints. For example, encrypting a session ID does not prevent an attacker from manipulating it. Similarly, a signature does not protect a message's confidentiality."
                        },
                        {
                          "type": "box",
                          "text": "Describe your use of cryptography (what information is encrypted/signed, how, why, what algorithms are used, etc.). Be as specific and precise as possible:",
                          "id": "application_webvuln_crypto_details"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "Testing, QA, and Monitoring",
                  "id": "block_qa",
                  "items": [
                    {
                      "type": "info",
                      "text": "<p>Security testing can be part of standard application tests. Here are some examples:</p>" +
                              "<ul><li><b>Simple unit tests:</b> Unit tests are typically used to confirm that the basic building blocks of the application work as expected. Unit tests are easy to repeat — they can run whenever new code is checked into the repository, to confirm that the code still behaves as expected. Unit tests can also check for security features. For example, they can be used to confirm that requests fail without XSRF tokens; that authentication is required to access user data; or that unexpected HTML tags can't get through input filters or escaping routines.</li>" +
                              "<ul><li><b>Release testing:</b> Before a new version of a product is released, human testers typically go through the application, try the new features, and make sure previous features still work correctly (regression testing). Security testing should be included in this process as well. For example, release testing is a great time to verify that user A cannot access the data of user B.</li>" +
                              "<ul><li><b>Monitoring:</b> Once the application is deployed, the focus usually shifts from testing to monitoring. Watch out for unexpected spikes in error rates, sandbox violations, and other flaky or inexplicable behavior (including intermittent test failures) — and before you dismiss an anomaly, check with your security team. Crashes and flakiness can indicate a race condition or a memory corruption bug.</li></ul>" +
                              "<p>The next few questions assess the testing and monitoring of your application.</p>"
                    },
                    {
                      "type": "radiogroup",
                      "text": "Are you using unit tests or similar methods?",
                      "defaultChoice": false,
                      "id": "application_testing_unit",
                      "choices": [
                        {"application_testing_unit_yes": "Yes"},
                        {"application_testing_unit_no": "No"}
                      ]
                    },
                    {
                      "type": "block",
                      "text": "Unit Testing",
                      "cond": "application_testing_unit_yes",
                      "id": "block_unit_testing",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "How would you describe the code coverage of your unit tests?",
                          "defaultChoice": false,
                          "choices": [
                            {"application_testing_unit_coverage_large": "<b>Robust:</b> The vast majority of our code is tested through unit tests; code coverage is at least &gt;80%."},
                            {"application_testing_unit_coverage_med": "<b>Weak:</b> We have some unit testing, but much of the code is not tested."},
                            {"application_testing_unit_coverage_small": "<b>Nonexistent:</b> We have no (or almost no) unit tests."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Unit tests have become quasi-standard for testing the functionality of software at a low level. Although this questionnaire focuses on security, the functional correctness of the application is also important. Particularly for web applications, where it is difficult (often impossible) to fall back to a previous version, functional bugs can cause problems with both integrity and availability. Consider implementing unit tests.",
                          "warn": "yes",
                          "name": "No unit tests",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_testing_unit_coverage",
                          "cond": "application_testing_unit_coverage_med || application_testing_unit_coverage_small"
                        },
                        {
                          "type": "radiogroup",
                          "text": "Do you have special unit tests in place for testing the security of your code? For example, unit tests can be used to do the following:<p><ul>" +
                                  "<li>Verify that XSRF tokens are required for all state-changing actions</li>" +
                                  "<li>Confirm that user input is correctly escaped and/or sanitized</li>" +
                                  "<li>Check that the application enforces access control (e.g., user A doesn't have access to user B's data)</li>",
                          "defaultChoice": false,
                          "choices": [
                            {"application_testing_unit_security_yes": "Yes"},
                            {"application_testing_unit_security_no": "No"}
                          ],
                          "cond": "application_testing_unit_coverage_med || application_testing_unit_coverage_large",
                          "id": "application_testing_unit_security"
                        },
                        {
                          "type": "tip",
                          "text": "Scalable security depends on engineers doing their part — and common-sense, low-overhead unit tests are one of the most cost-efficient defenses available. Unit tests can help validate security parameters and avoid regressions that reintroduce security bugs. We strongly recommend including security checks in your unit tests.",
                          "warn": "yes",
                          "name": "No unit tests for security functions",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_application_testing_unit_security",
                          "cond": "application_testing_unit_security_no"
                        }
                      ]
                    },
                    {
                      "type": "radiogroup",
                      "text": "Do your engineers and your QA team look for potential security issues during release testing, and have they been trained to do so?",
                      "defaultChoice": false,
                      "id": "application_testing_qa_security",
                      "choices": [
                        {"application_testing_qa_security_yes": "Yes, our QA process explicitly includes testing for security issues that might have been introduced in the new version."},
                        {"application_testing_qa_security_no": "This is an area where we have some room for improvement."}
                      ]
                    },
                    {
                      "type": "tip",
                      "text": "Your engineering and QA teams are in the best position to understand how all parts of the application work, what has changed since the previous iteration, and how the changes might introduce security vulnerabilities. Release testing is typically done under considerable time pressure, but it's the last chance to catch security vulnerabilities internally. When your teams are already focused on testing, adding a few security tests won't increase the effort by much.<p>" +
                              "Engineers and testers who have been trained to look for security issues can make all the difference between a secure product and a serious vulnerability.",
                      "warn": "yes",
                      "name": "No security quality assurance",
                      "severity": "medium",
                      "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                      "id": "warn_application_testing_qa_security",
                      "cond": "application_testing_qa_security_no"
                    },
                    {
                      "type": "block",
                      "text": "Post-Launch Monitoring",
                      "id": "block_monitoring",
                      "items": [
                        {
                          "type": "radiogroup",
                          "text": "How would you describe your post-launch monitoring?",
                          "defaultChoice": false,
                          "choices": [
                            {"warn_application_monitoring_robust": "<b>Robust</b>: We have procedures in place to log and monitor for unexpected crashes, exceptions, and other error conditions. If something looks suspicious, a security-conscious engineer evaluates it."},
                            {"warn_application_monitoring_weak": "<b>Weak</b>: If something goes terribly wrong, such as massive spikes in crash rates or other large-scale anomalies, we will probably notice. But our monitoring is fairly coarse, and there is room for improvement."},
                            {"warn_application_monitoring_none": "<b>Nonexistent</b>: At the moment, we are not doing any kind of post-release monitoring that looks for signs of exploitation or increases in crashes/exceptions."}
                          ]
                        },
                        {
                          "type": "tip",
                          "text": "Thank you for putting effort into post-launch monitoring. Exceptions often indicate an underlying security problem, and close monitoring goes a long way toward quickly identifying and subsequently fixing vulnerabilities.",
                          "id": "tip_warn_application_monitoring",
                          "cond": "warn_application_monitoring_robust"
                        },
                        {
                          "type": "tip",
                          "text": "Exceptions and crashes often indicate an underlying security problem. Monitoring the deployed application can go a long way toward quickly identifying and subsequently fixing vulnerabilities. In carefully designed software products, exceptions should be a fairly rare occurrence; it therefore usually does not introduce significant overhead to monitor for them.",
                          "warn": "yes",
                          "name": "Inadequate monitoring for crashes/exceptions",
                          "severity": "medium",
                          "why": "If you have compensating controls in place or feel that this issue does not constitute a risk in your specific circumstances, please explain below. If you're working to address this issue, include an estimate of when it will be resolved:",
                          "id": "warn_warn_application_monitoring",
                          "cond": "warn_application_monitoring_weak || warn_application_monitoring_none"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "block",
                  "text": "Additional Notes",
                  "id": "block_notes",
                  "items": [
                    {
                      "type": "box",
                      "text": "Provide any additional information about the security of your application:",
                      "id": "application_other"
                    }
                  ]
                }
              ]
            },
            {
              "type": "block",
              "text": "Security Contacts",
              "id": "block_security_contact",
              "items": [
                {
                  "type": "line",
                  "text": "List the email addresses of people we should contact about any security issues in the application:",
                  "id": "security_contacts"
                }
              ]
            },
            {
              "type": "block",
              "text": "Feedback",
              "id": "feedback_block",
              "items": [
                {
                  "type": "box",
                  "text": "<b>Congratulations!</b> You've made it to the end of this questionnaire. If you can spare another minute, please let us know how we can improve it. Your feedback is highly appreciated.",
                  "id": "feedback"
                }
              ]
            }
          ]
        },
        {
          "type": "block",
          "text": "18: Feedback",
          "id": "feedback_block",
          "items": [
            {
              "type": "box",
              "maxlength": "[MAXLENGTH_BOX_ITEM]",
              "text": "If you did not answer some questions or had difficulty answering any, explain why.  If you can spare another minute, please let us know how we can improve it. Your feedback is highly appreciated.",
              "id": "feedback"
            }
          ]
        },
        {
          "type": "info",
          "text": "<b>Congratulations!</b> You have made it to the end of this questionnaire. You can now 'Submit' to submit it for review. An e-mail will be sent to you and reviewers after you submit. You may also export answers and keep it for your own records or <a id=\"_app_contact_email\" href=\"[TEAM_CONTACT_EMAIL_HREF]?CC=YourSecurityChampion@[ORGANIZATION_NAME].com&Subject=Completed Architecture Review for <Application Name>\"> email the JSON output file</a>."
        }
      ]
    }
  ]
}
